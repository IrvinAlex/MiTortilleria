"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7924],{7924:(Oe,j,M)=>{M.r(j),M.d(j,{MetodoEntregaEventosPageModule:()=>be});var C=M(177),I=M(9417),l=M(5933),k=M(8265),f=M(467),e=M(4438),R=M(7517),D=M(2723),w=M(1876),S=M(8461);const b=o=>[o,"MXN","symbol-narrow","1.2-2","en-US"];function T(o,c){if(1&o&&(e.j41(0,"div",12)(1,"span"),e.EFF(2),e.k0s(),e.j41(3,"span"),e.EFF(4),e.nI1(5,"currency"),e.k0s()()),2&o){const a=c.$implicit;e.R7$(2),e.Lme("",(null==a.producto?null:a.producto.nombre)||""," x",a.cantidad,""),e.R7$(2),e.SpI("",e.iJd(5,3,e.eq3(9,b,a.subtotal))," MXN")}}function $(o,c){if(1&o&&(e.j41(0,"div",12)(1,"span",21),e.EFF(2,"Subtotal: "),e.k0s(),e.j41(3,"span",21),e.EFF(4),e.nI1(5,"currency"),e.k0s()()),2&o){const a=e.XpG();e.R7$(4),e.SpI("",e.iJd(5,1,e.eq3(7,b,null==a.cart?null:a.cart.total))," MXN")}}function N(o,c){if(1&o&&(e.j41(0,"div",12)(1,"span",22),e.EFF(2,"Descuento: "),e.k0s(),e.j41(3,"span",22),e.EFF(4),e.nI1(5,"number"),e.k0s()()),2&o){const a=e.XpG();e.R7$(4),e.SpI("-",e.i5U(5,1,a.porcentaje,"1.0-0"),"%")}}function G(o,c){if(1&o&&(e.j41(0,"div",12)(1,"span",23),e.EFF(2,"Subtotal con descuento:"),e.k0s(),e.j41(3,"span",23),e.EFF(4),e.nI1(5,"currency"),e.k0s()()),2&o){const a=e.XpG();e.R7$(4),e.SpI("",e.iJd(5,1,e.eq3(7,b,(null==a.cart?null:a.cart.total)-(null==a.cart?null:a.cart.total)*(a.porcentaje/100)))," MXN")}}function A(o,c){if(1&o&&(e.j41(0,"div",12)(1,"span"),e.EFF(2,"Subtotal:"),e.k0s(),e.j41(3,"span"),e.EFF(4),e.nI1(5,"currency"),e.k0s()()),2&o){const a=e.XpG();e.R7$(4),e.SpI("",e.iJd(5,1,e.eq3(7,b,null==a.cart?null:a.cart.total))," MXN")}}function Y(o,c){1&o&&(e.j41(0,"div",24),e.nrm(1,"ion-icon",25),e.j41(2,"span",26),e.EFF(3,"\xa1Tienes env\xedo gratis por eventos!"),e.k0s()())}function L(o,c){if(1&o&&(e.j41(0,"div",27),e.nrm(1,"ion-icon",28),e.j41(2,"span",29),e.EFF(3),e.k0s()()),2&o){const a=e.XpG();e.R7$(3),e.Lme(" Agrega ",a.getRemainingWeightForFreeDelivery(),"kg m\xe1s para env\xedo gratis (m\xednimo ",a.MINIMUM_WEIGHT_FOR_FREE_DELIVERY,"kg) ")}}function z(o,c){if(1&o&&(e.j41(0,"div",12)(1,"span"),e.EFF(2,"Costo de env\xedo:"),e.k0s(),e.j41(3,"span"),e.EFF(4),e.nI1(5,"currency"),e.k0s()()),2&o){const a=e.XpG();e.R7$(4),e.SpI("",e.iJd(5,1,e.eq3(7,b,a.DELIVERY_FEE_EVENTOS))," MXN")}}function H(o,c){1&o&&(e.j41(0,"div",30),e.nrm(1,"div",31),e.k0s())}function W(o,c){1&o&&e.nrm(0,"ion-icon",35)}function X(o,c){if(1&o){const a=e.RV6();e.j41(0,"div",32)(1,"ion-button",33),e.bIt("click",function(){e.eBV(a);const n=e.XpG();return e.Njj(n.confirmPayment())}),e.DNE(2,W,1,0,"ion-icon",34),e.EFF(3),e.k0s()()}if(2&o){const a=e.XpG();e.R7$(),e.AVh("animated",a.confirming),e.Y8G("disabled",a.confirming||a.paymentConfirmed),e.R7$(),e.Y8G("ngIf",a.paymentConfirmed),e.R7$(),e.SpI(" ",a.paymentConfirmed?"Pedido Confirmado":"Confirmar Pago"," ")}}let V=(()=>{var o;class c{constructor(){this.selectedPayment=null,this.confirming=!1,this.paymentConfirmed=!1,this.utilsSvc=(0,e.WQX)(D.T),this.firebaseSvc=(0,e.WQX)(R.f),this.emailSvc=(0,e.WQX)(w._),this.discountAmount=0,this.porcentaje=0,this.distanciaKm=0,this.transportFee=0,this.MINIMUM_WEIGHT_FOR_FREE_DELIVERY=60,this.DELIVERY_FEE_EVENTOS=50,this.totalWeight=0}ngOnInit(){this.getCartDetails(),this.applyStoredCoupon(),this.calculateTotalWeight()}calculateTotalWeight(){this.totalWeight=0,this.cart&&this.cart.detalle_carrito&&(this.totalWeight=this.cart.detalle_carrito.reduce((t,n)=>t+(n.cantidad||0),0))}isEligibleForFreeDelivery(){return this.totalWeight>=this.MINIMUM_WEIGHT_FOR_FREE_DELIVERY}getRemainingWeightForFreeDelivery(){return Math.max(0,this.MINIMUM_WEIGHT_FOR_FREE_DELIVERY-this.totalWeight)}getDeliveryFee(){return this.isEligibleForFreeDelivery()?0:this.DELIVERY_FEE_EVENTOS}getTotalAmount(){return this.cart?this.cart.total-this.discountAmount+this.getDeliveryFee():0}sendOrderConfirmationEmail(t,n){var i=this;return(0,f.A)(function*(){try{const r=i.utilsSvc.getFromLocalStorage("user"),s={orderId:t,customerEmail:r.email,customerName:r.name||r.email,fecha:new Date,estatus:"Pedido confirmado",tipo_pago:n,items:i.cart.detalle_carrito,subtotal:i.cart.total,discountAmount:i.cart.total*(i.porcentaje/100),discountPercent:i.porcentaje,transportFee:i.transportFee,total:i.cart.total-i.cart.total*(i.porcentaje/100)+i.transportFee};yield i.emailSvc.sendOrderConfirmationEmail(s),console.log("Email de confirmaci\xf3n enviado exitosamente")}catch(r){console.error("Error al enviar email de confirmaci\xf3n:",r)}})()}renderPayPalButton(){var i,t=this;document.getElementById("paypal-button-container")?window.paypal.Buttons({createOrder:(i,r)=>{const s=this.getTotalAmount();return r.order.create({purchase_units:[{amount:{value:s.toFixed(2)},shipping_address:{country_code:"MX"}}],shipping_preference:"SET_PROVIDED_ADDRESS"})},onApprove:(i=(0,f.A)(function*(r,s){return s.order.capture().then(function(){var d=(0,f.A)(function*(m){console.log("Pago completado:",m);const p=yield t.utilsSvc.loading();yield p.present(),t.confirming=!0,setTimeout(()=>{t.confirming=!1,t.paymentConfirmed=!0},3e3),setTimeout((0,f.A)(function*(){const g=document.querySelector(".confirm-button");g&&g.classList.add("complete");const h=t.utilsSvc.getFromLocalStorage("user").uid,_=t.dir()[0],x=t.getTotalAmount(),v={estatus:"Pedido confirmado",fecha:new Date,fecha_entrega:t.cart.fecha_entrega,pago_confirmado:!0,tipo_pago:"Tarjeta",tipo_entrega:"Eventos",total:x,uid_cliente:h,geopoint_entrega:{latitude:_.geopoint.latitude,longitude:_.geopoint.longitude}},y=t.cart.detalle_carrito.map(E=>({cantidad:E.cantidad,subtotal:E.subtotal,uid_producto:E.uid_producto,uid_opcion:E.uid_opcion}));t.utilsSvc.setElementInLocalstorage("pedido",v),t.utilsSvc.setElementInLocalstorage("detalle_pedido",y);const u=t.cart.id;for(let E of t.cart.detalle_carrito)yield t.firebaseSvc.deleteDocumet(`users/${h}/carrito_eventos/${u}/detalle_carrito/${E.id}`);const P=yield t.firebaseSvc.addDocument("pedidos",v);for(let E of t.cart.detalle_carrito)yield t.firebaseSvc.addDocument(`pedidos/${P.id}/detalle_pedido`,{cantidad:E.cantidad,subtotal:E.subtotal,uid_producto:E.uid_producto,uid_opcion:E.uid_opcion});yield t.sendOrderConfirmationEmail(P.id,"Tarjeta"),yield t.firebaseSvc.updateDocumet(`users/${h}/carrito_eventos/${u}`,{total:0}),t.cart.detalle_carrito=[],t.cart.total=0,t.utilsSvc.setElementInLocalstorage("carrito_eventos",[t.cart]),localStorage.removeItem("selectedMethod"),p.dismiss(),t.utilsSvc.presentToast({message:"Pedido confirmado",duration:2500,color:"primary",position:"bottom",icon:"alert-circle-outline"}),t.paymentConfirmed=!1,t.utilsSvc.dismissModal(!0),t.utilsSvc.routerLink("/main/confirmacion-pago")}),3e3)});return function(m){return d.apply(this,arguments)}}())}),function(s,d){return i.apply(this,arguments)}),onError:i=>{console.error("Error en el pago:",i),alert("Hubo un problema con el pago. Por favor, int\xe9ntalo de nuevo.")}}).render("#paypal-button-container"):console.error("Contenedor #paypal-button-container no encontrado.")}onPaymentChange(t){var n=this;return(0,f.A)(function*(){if(n.selectedPayment=t,"paypal"===t){const i=yield n.utilsSvc.loading();yield i.present(),setTimeout(()=>{n.renderPayPalButton(),i.dismiss()},1500)}})()}confirmPayment(){var t=this;return(0,f.A)(function*(){const n=yield t.utilsSvc.loading();yield n.present(),t.confirming=!0,setTimeout(()=>{t.confirming=!1,t.paymentConfirmed=!0},3e3),setTimeout((0,f.A)(function*(){const i=document.querySelector(".confirm-button");i&&i.classList.add("complete");const r=t.utilsSvc.getFromLocalStorage("user").uid,s=t.dir()[0],d=t.getTotalAmount(),m={estatus:"Pedido confirmado",fecha:new Date,fecha_entrega:t.cart.fecha_entrega,pago_confirmado:!1,tipo_pago:"Efectivo",tipo_entrega:"Eventos",total:d,uid_cliente:r,geopoint_entrega:{latitude:s.geopoint.latitude,longitude:s.geopoint.longitude}},p=t.cart.detalle_carrito.map(_=>({cantidad:_.cantidad,subtotal:_.subtotal,uid_producto:_.uid_producto,uid_opcion:_.uid_opcion}));t.utilsSvc.setElementInLocalstorage("pedido",m),t.utilsSvc.setElementInLocalstorage("detalle_pedido",p);const g=t.cart.id;for(let _ of t.cart.detalle_carrito)yield t.firebaseSvc.deleteDocumet(`users/${r}/carrito_eventos/${g}/detalle_carrito/${_.id}`);const h=yield t.firebaseSvc.addDocument("pedidos",m);for(let _ of t.cart.detalle_carrito)yield t.firebaseSvc.addDocument(`pedidos/${h.id}/detalle_pedido`,{cantidad:_.cantidad,subtotal:_.subtotal,uid_producto:_.uid_producto,uid_opcion:_.uid_opcion});yield t.sendOrderConfirmationEmail(h.id,"Efectivo"),yield t.firebaseSvc.updateDocumet(`users/${r}/carrito_eventos/${g}`,{total:0}),t.cart.detalle_carrito=[],t.cart.total=0,t.utilsSvc.setElementInLocalstorage("carrito_eventos",[t.cart]),localStorage.removeItem("selectedMethod"),n.dismiss(),t.utilsSvc.presentToast({message:"Pedido confirmado",duration:2500,color:"primary",position:"bottom",icon:"alert-circle-outline"}),t.paymentConfirmed=!1,t.utilsSvc.dismissModal(!0),t.utilsSvc.routerLink("/main/confirmacion-pago")}),3e3)})()}getCartDetails(){var t=this;return(0,f.A)(function*(){const n=yield t.utilsSvc.loading();yield n.present(),t.cart=t.utilsSvc.getFromLocalStorage("carrito_eventos")[0];for(let i of t.cart.detalle_carrito){const r=yield t.firebaseSvc.getDocument(`productos/${i.uid_producto}`),s=yield t.firebaseSvc.getDocument(`productos/${i.uid_producto}/opciones/${i.uid_opcion}`);i.producto=r||{},i.opcion=s||{}}n.dismiss()})()}applyStoredCoupon(){if(this.cart=this.utilsSvc.getFromLocalStorage("carrito_eventos")[0],this.cart){const t=this.utilsSvc.getFromLocalStorage("appliedCoupon");t&&(this.discountAmount=this.cart.total*t.porcentaje/100,this.porcentaje=t.porcentaje,this.cart.total-=this.discountAmount)}}calcularDistancia(t,n,i,r){const d=(i-t)*Math.PI/180,m=(r-n)*Math.PI/180,p=Math.sin(d/2)*Math.sin(d/2)+Math.cos(t*Math.PI/180)*Math.cos(i*Math.PI/180)*Math.sin(m/2)*Math.sin(m/2);return 2*Math.atan2(Math.sqrt(p),Math.sqrt(1-p))*6371}dir(){return this.utilsSvc.getFromLocalStorage("direccion")||{}}}return(o=c).\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.VBU({type:o,selectors:[["app-entrega-domicilio-eventos"]],decls:56,vars:36,consts:[["title","Pago",3,"isModal"],[3,"fullscreen"],[1,"payment-card"],[1,"title"],[3,"ionChange"],["button","",1,"option-card",3,"click"],["name","cash-outline","slot","start",1,"option-icon"],["slot","end","value","efectivo"],["name","card-outline","slot","start",1,"option-icon"],["slot","end","value","tarjeta"],[1,"summary-card"],[1,"summary-title"],[1,"summary-item"],["class","summary-item",4,"ngFor","ngForOf"],[1,"divider"],["class","summary-item",4,"ngIf"],["class","free-shipping-message",4,"ngIf"],["class","delivery-fee-message",4,"ngIf"],[1,"summary-item","total-item"],["class","confirm-button-container-paypal",4,"ngIf"],["class","confirm-button-container",4,"ngIf"],[1,"original-price"],[1,"descuento"],[1,"discounted-price"],[1,"free-shipping-message"],["name","gift-outline","color","success"],[1,"success-text"],[1,"delivery-fee-message"],["name","information-circle-outline","color","warning"],[1,"warning-text"],[1,"confirm-button-container-paypal"],["id","paypal-button-container"],[1,"confirm-button-container"],["expand","block","mode","ios",3,"click","disabled"],["name","checkmark-outline","slot","start",4,"ngIf"],["name","checkmark-outline","slot","start"]],template:function(t,n){1&t&&(e.nrm(0,"app-header",0),e.j41(1,"ion-content",1)(2,"ion-card",2)(3,"ion-card-header")(4,"h2",3),e.EFF(5,"M\xe9todo de Pago"),e.k0s()(),e.j41(6,"ion-card-content")(7,"ion-radio-group",4),e.bIt("ionChange",function(r){return n.onPaymentChange(r.detail.value)}),e.j41(8,"ion-card",5),e.bIt("click",function(){return n.onPaymentChange("efectivo")}),e.j41(9,"ion-item"),e.nrm(10,"ion-icon",6),e.j41(11,"ion-label"),e.EFF(12,"Efectivo en domicilio"),e.k0s(),e.nrm(13,"ion-radio",7),e.k0s()(),e.j41(14,"ion-card",5),e.bIt("click",function(){return n.onPaymentChange("paypal")}),e.j41(15,"ion-item"),e.nrm(16,"ion-icon",8),e.j41(17,"ion-label"),e.EFF(18,"Tarjeta"),e.k0s(),e.nrm(19,"ion-radio",9),e.k0s()()()()(),e.j41(20,"ion-card",10)(21,"ion-card-header")(22,"h3",11),e.EFF(23,"Resumen de compra"),e.k0s()(),e.j41(24,"ion-card-content")(25,"div",12)(26,"span"),e.EFF(27),e.k0s(),e.j41(28,"span"),e.EFF(29),e.nI1(30,"currency"),e.k0s()(),e.DNE(31,T,6,11,"div",13),e.nrm(32,"div",14),e.DNE(33,$,6,9,"div",15)(34,N,6,4,"div",15)(35,G,6,9,"div",15)(36,A,6,9,"div",15),e.j41(37,"div",12)(38,"span"),e.EFF(39,"Peso total:"),e.k0s(),e.j41(40,"span"),e.EFF(41),e.k0s()(),e.DNE(42,Y,4,0,"div",16)(43,L,4,2,"div",17)(44,z,6,9,"div",15),e.nrm(45,"div",14),e.j41(46,"div",18)(47,"span")(48,"strong"),e.EFF(49,"Total a pagar:"),e.k0s()(),e.j41(50,"span")(51,"strong"),e.EFF(52),e.nI1(53,"currency"),e.k0s()()()()(),e.DNE(54,H,2,0,"div",19)(55,X,4,5,"div",20),e.k0s()),2&t&&(e.Y8G("isModal",!0),e.R7$(),e.Y8G("fullscreen",!0),e.R7$(7),e.AVh("selected","efectivo"===n.selectedPayment),e.R7$(6),e.AVh("selected","paypal"===n.selectedPayment),e.R7$(13),e.SpI("Productos (",(null==n.cart||null==n.cart.detalle_carrito?null:n.cart.detalle_carrito.length)||0,")"),e.R7$(2),e.SpI("",e.iJd(30,20,e.eq3(32,b,null==n.cart?null:n.cart.total))," MXN"),e.R7$(2),e.Y8G("ngForOf",null==n.cart?null:n.cart.detalle_carrito),e.R7$(2),e.Y8G("ngIf",n.discountAmount>0),e.R7$(),e.Y8G("ngIf",n.discountAmount>0),e.R7$(),e.Y8G("ngIf",n.discountAmount>0),e.R7$(),e.Y8G("ngIf",0===n.discountAmount),e.R7$(5),e.SpI("",n.totalWeight,"kg"),e.R7$(),e.Y8G("ngIf",n.isEligibleForFreeDelivery()),e.R7$(),e.Y8G("ngIf",!n.isEligibleForFreeDelivery()),e.R7$(),e.Y8G("ngIf",!n.isEligibleForFreeDelivery()),e.R7$(8),e.SpI("",e.iJd(53,26,e.eq3(34,b,n.getTotalAmount()))," MXN"),e.R7$(2),e.Y8G("ngIf","tarjeta"===n.selectedPayment),e.R7$(),e.Y8G("ngIf","efectivo"===n.selectedPayment))},dependencies:[C.Sq,C.bT,l.Jm,l.b_,l.I9,l.ME,l.W9,l.iq,l.uz,l.he,l.KO,l.f0,l.uR,l.Je,S.l,C.QX,C.oe],styles:['@charset "UTF-8";.payment-card[_ngcontent-%COMP%], .summary-card[_ngcontent-%COMP%]{margin:16px;border-radius:16px;box-shadow:0 4px 8px #0000001a}.title[_ngcontent-%COMP%], .summary-title[_ngcontent-%COMP%]{font-size:1.2rem;font-weight:700;text-align:center;color:var(--ion-color-primary)}.option-card[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:16px;transition:transform .2s ease,background-color .3s ease}.option-card.selected[_ngcontent-%COMP%]{transform:scale(1.05);background-color:var(--ion-color-primary-tint)}.option-icon[_ngcontent-%COMP%]{font-size:2rem;color:var(--ion-color-primary);margin-right:8px}.summary-card[_ngcontent-%COMP%]{background-color:#f8f9fa;color:#343a40}.summary-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:12px 0;font-size:1rem}.divider[_ngcontent-%COMP%]{border-bottom:1px solid #dee2e6;margin:8px 0}.confirm-button-container[_ngcontent-%COMP%], .confirm-button-container-paypal[_ngcontent-%COMP%]{margin:16px}.confirm-button[_ngcontent-%COMP%]{--background: var(--ion-color-primary);color:#fff;font-weight:700;border-radius:24px;text-align:center;position:relative;overflow:hidden;transition:background-color .3s ease-in-out}.complete[_ngcontent-%COMP%]{--background: var(--ion-color-primary);color:#fff;font-weight:700;border-radius:24px;text-align:center;position:relative;overflow:hidden}.confirm-button.animated[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;height:100%;width:0%;background:linear-gradient(to right,var(--ion-color-primary),var(--ion-color-secondary),var(--ion-color-tertiary));z-index:1;animation:_ngcontent-%COMP%_slideIn 3s forwards}.confirm-button.animated[_ngcontent-%COMP%]{color:transparent}.confirm-button.animated[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#fff}.confirm-button.complete[_ngcontent-%COMP%]{--background: var(--ion-color-primary)}@keyframes _ngcontent-%COMP%_slideIn{0%{width:0%}50%{width:100%}to{width:0%}}.total-summary[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start}.total-summary[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin:4px 0}.discounted-price[_ngcontent-%COMP%]{color:green;font-weight:700}.original-price[_ngcontent-%COMP%]{color:gray;text-decoration:line-through;font-size:17px}.descuento[_ngcontent-%COMP%]{font-weight:700;font-size:17px}.free-shipping-message[_ngcontent-%COMP%], .motivational-message[_ngcontent-%COMP%]{display:flex;align-items:center;padding:8px 12px;margin:8px 0;border-radius:8px;font-size:.9rem}.free-shipping-message[_ngcontent-%COMP%]{background-color:#28a7451a;border:1px solid rgba(40,167,69,.3)}.motivational-message[_ngcontent-%COMP%]{background-color:#007bff1a;border:1px solid rgba(0,123,255,.3)}.success-text[_ngcontent-%COMP%]{color:var(--ion-color-success);font-weight:500;margin-left:8px}.info-text[_ngcontent-%COMP%]{color:var(--ion-color-primary);font-weight:500;margin-left:8px}.total-item[_ngcontent-%COMP%]{font-size:1.1rem;border-top:2px solid var(--ion-color-primary);padding-top:12px;margin-top:8px}']}),c})();const F=o=>[o,"MXN","symbol-narrow","1.2-2","en-US"];function U(o,c){if(1&o&&(e.j41(0,"div",12)(1,"span"),e.EFF(2),e.k0s(),e.j41(3,"span"),e.EFF(4),e.nI1(5,"currency"),e.k0s()()),2&o){const a=c.$implicit;e.R7$(2),e.Lme("",(null==a.producto?null:a.producto.nombre)||""," x",a.cantidad,""),e.R7$(2),e.SpI("",e.iJd(5,3,e.eq3(9,F,a.subtotal))," MXN")}}function B(o,c){if(1&o&&(e.j41(0,"div",12)(1,"span",20),e.EFF(2,"Total: "),e.k0s(),e.j41(3,"span",20),e.EFF(4),e.nI1(5,"currency"),e.k0s()()),2&o){const a=e.XpG();e.R7$(4),e.SpI("",e.iJd(5,1,e.eq3(7,F,null==a.cart?null:a.cart.total))," MXN")}}function J(o,c){if(1&o&&(e.j41(0,"div",12)(1,"span",21),e.EFF(2,"Descuento: "),e.k0s(),e.j41(3,"span",21),e.EFF(4),e.nI1(5,"number"),e.k0s()()),2&o){const a=e.XpG();e.R7$(4),e.SpI("-",e.i5U(5,1,a.porcentaje,"1.0-0"),"%")}}function q(o,c){if(1&o&&(e.j41(0,"div",12)(1,"span",22),e.EFF(2,"Total con descuento:"),e.k0s(),e.j41(3,"span",22),e.EFF(4),e.nI1(5,"currency"),e.k0s()()),2&o){const a=e.XpG();e.R7$(4),e.SpI("",e.iJd(5,1,e.eq3(7,F,(null==a.cart?null:a.cart.total)-(null==a.cart?null:a.cart.total)*(a.porcentaje/100)))," MXN")}}function Q(o,c){if(1&o&&(e.j41(0,"div",12)(1,"span"),e.EFF(2,"Pagas"),e.k0s(),e.j41(3,"span"),e.EFF(4),e.nI1(5,"currency"),e.k0s()()),2&o){const a=e.XpG();e.R7$(4),e.SpI("",e.iJd(5,1,e.eq3(7,F,null==a.cart?null:a.cart.total))," MXN")}}function K(o,c){1&o&&(e.j41(0,"div",23),e.nrm(1,"ion-icon",24),e.j41(2,"span",25),e.EFF(3,"\xa1Calificas para promoci\xf3n de eventos!"),e.k0s()())}function Z(o,c){if(1&o&&(e.j41(0,"div",26),e.nrm(1,"ion-icon",27),e.j41(2,"span",28),e.EFF(3),e.k0s()()),2&o){const a=e.XpG();e.R7$(3),e.Lme(" Agrega ",a.getRemainingWeightForFreeDelivery(),"kg m\xe1s para promoci\xf3n de eventos (m\xednimo ",a.MINIMUM_WEIGHT_FOR_FREE_DELIVERY,"kg) ")}}function ee(o,c){1&o&&(e.j41(0,"div",29),e.nrm(1,"div",30),e.k0s())}function te(o,c){1&o&&e.nrm(0,"ion-icon",34)}function ne(o,c){if(1&o){const a=e.RV6();e.j41(0,"div",31)(1,"ion-button",32),e.bIt("click",function(){e.eBV(a);const n=e.XpG();return e.Njj(n.confirmPayment())}),e.DNE(2,te,1,0,"ion-icon",33),e.EFF(3),e.k0s()()}if(2&o){const a=e.XpG();e.R7$(),e.AVh("animated",a.confirming),e.Y8G("disabled",a.confirming||a.paymentConfirmed),e.R7$(),e.Y8G("ngIf",a.paymentConfirmed),e.R7$(),e.SpI(" ",a.paymentConfirmed?"Pedido Confirmado":"Confirmar Pago"," ")}}let oe=(()=>{var o;class c{constructor(){this.selectedPayment=null,this.confirming=!1,this.paymentConfirmed=!1,this.utilsSvc=(0,e.WQX)(D.T),this.firebaseSvc=(0,e.WQX)(R.f),this.emailSvc=(0,e.WQX)(w._),this.discountAmount=0,this.porcentaje=0,this.MINIMUM_WEIGHT_FOR_FREE_DELIVERY=60,this.totalWeight=0}ngOnInit(){this.getCartDetails()}calculateTotalWeight(){this.totalWeight=0,this.cart&&this.cart.detalle_carrito&&(this.totalWeight=this.cart.detalle_carrito.reduce((t,n)=>t+(n.cantidad||0),0))}isEligibleForFreeDelivery(){return this.totalWeight>=this.MINIMUM_WEIGHT_FOR_FREE_DELIVERY}getRemainingWeightForFreeDelivery(){return Math.max(0,this.MINIMUM_WEIGHT_FOR_FREE_DELIVERY-this.totalWeight)}sendOrderConfirmationEmail(t,n){var i=this;return(0,f.A)(function*(){try{const r=i.utilsSvc.getFromLocalStorage("user"),s={orderId:t,customerEmail:r.email,customerName:r.name||r.email,fecha:new Date,fechaRecoleccion:new Date(i.cart.fecha_entrega),estatus:"Pedido confirmado",tipo_pago:n,metodo_entrega:"negocio",es_recoleccion_negocio:!0,items:i.cart.detalle_carrito,subtotal:i.cart.total,discountAmount:i.cart.total*(i.porcentaje/100),discountPercent:i.porcentaje,transportFee:0,total:i.cart.total-i.cart.total*(i.porcentaje/100)};yield i.emailSvc.sendPickupScheduleEmail(s),console.log("Email de confirmaci\xf3n de recolecci\xf3n enviado exitosamente")}catch(r){console.error("Error al enviar email de confirmaci\xf3n:",r)}})()}renderPayPalButton(){var i,t=this;document.getElementById("paypal-button-container")?window.paypal.Buttons({createOrder:(i,r)=>r.order.create({purchase_units:[{amount:{value:this.cart.total-this.cart.total*(this.porcentaje/100)},shipping_address:{country_code:"MX"}}],shipping_preference:"SET_PROVIDED_ADDRESS"}),onApprove:(i=(0,f.A)(function*(r,s){return s.order.capture().then(function(){var d=(0,f.A)(function*(m){console.log("Pago completado:",m);const p=yield t.utilsSvc.loading();yield p.present(),t.confirming=!0,setTimeout(()=>{t.confirming=!1,t.paymentConfirmed=!0},3e3),setTimeout((0,f.A)(function*(){const g=document.querySelector(".confirm-button");g&&g.classList.add("complete");const h=t.utilsSvc.getFromLocalStorage("user").uid,_={estatus:"Pedido confirmado",fecha:new Date,fecha_entrega:t.cart.fecha_entrega,hora_recoleccion:t.cart.fecha_entrega,metodo_entrega:"negocio",es_recoleccion_negocio:!0,pago_confirmado:!0,tipo_pago:"Tarjeta",total:t.cart.total-t.cart.total*(t.porcentaje/100),uid_cliente:h},x=t.cart.detalle_carrito.map(u=>({cantidad:u.cantidad,subtotal:u.subtotal,uid_producto:u.uid_producto,uid_opcion:u.uid_opcion}));t.utilsSvc.setElementInLocalstorage("pedido",_),t.utilsSvc.setElementInLocalstorage("detalle_pedido",x);const v=t.cart.id;for(let u of t.cart.detalle_carrito)yield t.firebaseSvc.deleteDocumet(`users/${h}/carrito_eventos/${v}/detalle_carrito/${u.id}`);const y=yield t.firebaseSvc.addDocument("pedidos",_);for(let u of t.cart.detalle_carrito)yield t.firebaseSvc.addDocument(`pedidos/${y.id}/detalle_pedido`,{cantidad:u.cantidad,subtotal:u.subtotal,uid_producto:u.uid_producto,uid_opcion:u.uid_opcion});yield t.sendOrderConfirmationEmail(y.id,"Tarjeta"),yield t.firebaseSvc.updateDocumet(`users/${h}/carrito_eventos/${v}`,{total:0}),t.cart.detalle_carrito=[],t.cart.total=0,t.utilsSvc.setElementInLocalstorage("carrito_eventos",[t.cart]),localStorage.removeItem("selectedMethod"),p.dismiss(),t.utilsSvc.presentToast({message:"Pedido confirmado",duration:2500,color:"primary",position:"bottom",icon:"alert-circle-outline"}),t.paymentConfirmed=!1,t.utilsSvc.dismissModal(!0),t.utilsSvc.routerLink("/main/confirmacion-pago")}),3e3)});return function(m){return d.apply(this,arguments)}}())}),function(s,d){return i.apply(this,arguments)}),onError:i=>{console.error("Error en el pago:",i),alert("Hubo un problema con el pago. Por favor, int\xe9ntalo de nuevo.")}}).render("#paypal-button-container"):console.error("Contenedor #paypal-button-container no encontrado.")}onPaymentChange(t){var n=this;return(0,f.A)(function*(){if(n.selectedPayment=t,"paypal"===t){const i=yield n.utilsSvc.loading();yield i.present(),setTimeout(()=>{n.renderPayPalButton(),i.dismiss()},1500)}})()}confirmPayment(){var t=this;return(0,f.A)(function*(){const n=yield t.utilsSvc.loading();yield n.present(),t.confirming=!0,setTimeout(()=>{t.confirming=!1,t.paymentConfirmed=!0},3e3),setTimeout((0,f.A)(function*(){const i=document.querySelector(".confirm-button");i&&i.classList.add("complete");const r=t.utilsSvc.getFromLocalStorage("user").uid,s={estatus:"Pedido confirmado",fecha:new Date,fecha_entrega:t.cart.fecha_entrega,hora_recoleccion:t.cart.fecha_entrega,metodo_entrega:"negocio",es_recoleccion_negocio:!0,pago_confirmado:!1,tipo_pago:"Efectivo",total:t.cart.total-t.cart.total*(t.porcentaje/100),uid_cliente:r},d=t.cart.detalle_carrito.map(g=>({cantidad:g.cantidad,subtotal:g.subtotal,uid_producto:g.uid_producto,uid_opcion:g.uid_opcion}));t.utilsSvc.setElementInLocalstorage("pedido",s),t.utilsSvc.setElementInLocalstorage("detalle_pedido",d);const m=t.cart.id;for(let g of t.cart.detalle_carrito)yield t.firebaseSvc.deleteDocumet(`users/${r}/carrito_eventos/${m}/detalle_carrito/${g.id}`);const p=yield t.firebaseSvc.addDocument("pedidos",s);for(let g of t.cart.detalle_carrito)yield t.firebaseSvc.addDocument(`pedidos/${p.id}/detalle_pedido`,{cantidad:g.cantidad,subtotal:g.subtotal,uid_producto:g.uid_producto,uid_opcion:g.uid_opcion});yield t.sendOrderConfirmationEmail(p.id,"Efectivo"),yield t.firebaseSvc.updateDocumet(`users/${r}/carrito_eventos/${m}`,{total:0}),t.cart.detalle_carrito=[],t.cart.total=0,t.utilsSvc.setElementInLocalstorage("carrito_eventos",[t.cart]),localStorage.removeItem("selectedMethod"),n.dismiss(),t.utilsSvc.presentToast({message:"Pedido confirmado",duration:2500,color:"primary",position:"bottom",icon:"alert-circle-outline"}),t.paymentConfirmed=!1,t.utilsSvc.dismissModal(!0),t.utilsSvc.routerLink("/main/confirmacion-pago")}),3e3)})()}getCartDetails(){var t=this;return(0,f.A)(function*(){const n=yield t.utilsSvc.loading();yield n.present(),t.cart=t.utilsSvc.getFromLocalStorage("carrito_eventos")[0];for(let i of t.cart.detalle_carrito){const r=yield t.firebaseSvc.getDocument(`productos/${i.uid_producto}`),s=yield t.firebaseSvc.getDocument(`productos/${i.uid_producto}/opciones/${i.uid_opcion}`);i.producto=r||{},i.opcion=s||{}}n.dismiss(),t.calculateTotalWeight()})()}applyStoredCoupon(){if(this.cart=this.utilsSvc.getFromLocalStorage("carrito_eventos")[0],this.cart){const t=this.utilsSvc.getFromLocalStorage("appliedCoupon");t&&(this.discountAmount=this.cart.total*t.porcentaje/100,this.porcentaje=t.porcentaje,this.cart.total-=this.discountAmount),this.calculateTotalWeight()}}}return(o=c).\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.VBU({type:o,selectors:[["app-entrega-negocio-eventos"]],decls:46,vars:26,consts:[["title","Pago",3,"isModal"],[3,"fullscreen"],[1,"payment-card"],[1,"title"],[3,"ionChange"],["button","",1,"option-card",3,"click"],["name","cash-outline","slot","start",1,"option-icon"],["slot","end","value","efectivo"],["name","card-outline","slot","start",1,"option-icon"],["slot","end","value","tarjeta"],[1,"summary-card"],[1,"summary-title"],[1,"summary-item"],["class","summary-item",4,"ngFor","ngForOf"],[1,"divider"],["class","summary-item",4,"ngIf"],["class","free-shipping-message",4,"ngIf"],["class","delivery-fee-message",4,"ngIf"],["class","confirm-button-container-paypal",4,"ngIf"],["class","confirm-button-container",4,"ngIf"],[1,"original-price"],[1,"descuento"],[1,"discounted-price"],[1,"free-shipping-message"],["name","gift-outline","color","success"],[1,"success-text"],[1,"delivery-fee-message"],["name","information-circle-outline","color","warning"],[1,"warning-text"],[1,"confirm-button-container-paypal"],["id","paypal-button-container"],[1,"confirm-button-container"],["expand","block","mode","ios",3,"click","disabled"],["name","checkmark-outline","slot","start",4,"ngIf"],["name","checkmark-outline","slot","start"]],template:function(t,n){1&t&&(e.nrm(0,"app-header",0),e.j41(1,"ion-content",1)(2,"ion-card",2)(3,"ion-card-header")(4,"h2",3),e.EFF(5,"M\xe9todo de Pago"),e.k0s()(),e.j41(6,"ion-card-content")(7,"ion-radio-group",4),e.bIt("ionChange",function(r){return n.onPaymentChange(r.detail.value)}),e.j41(8,"ion-card",5),e.bIt("click",function(){return n.onPaymentChange("efectivo")}),e.j41(9,"ion-item"),e.nrm(10,"ion-icon",6),e.j41(11,"ion-label"),e.EFF(12,"Efectivo en Negocio"),e.k0s(),e.nrm(13,"ion-radio",7),e.k0s()(),e.j41(14,"ion-card",5),e.bIt("click",function(){return n.onPaymentChange("paypal")}),e.j41(15,"ion-item"),e.nrm(16,"ion-icon",8),e.j41(17,"ion-label"),e.EFF(18,"Tarjeta"),e.k0s(),e.nrm(19,"ion-radio",9),e.k0s()()()()(),e.j41(20,"ion-card",10)(21,"ion-card-header")(22,"h3",11),e.EFF(23,"Resumen de compra"),e.k0s()(),e.j41(24,"ion-card-content")(25,"div",12)(26,"span"),e.EFF(27),e.k0s(),e.j41(28,"span"),e.EFF(29),e.nI1(30,"currency"),e.k0s()(),e.DNE(31,U,6,11,"div",13),e.nrm(32,"div",14),e.DNE(33,B,6,9,"div",15)(34,J,6,4,"div",15)(35,q,6,9,"div",15)(36,Q,6,9,"div",15),e.j41(37,"div",12)(38,"span"),e.EFF(39,"Peso total:"),e.k0s(),e.j41(40,"span"),e.EFF(41),e.k0s()(),e.DNE(42,K,4,0,"div",16)(43,Z,4,2,"div",17),e.k0s()(),e.DNE(44,ee,2,0,"div",18)(45,ne,4,5,"div",19),e.k0s()),2&t&&(e.Y8G("isModal",!0),e.R7$(),e.Y8G("fullscreen",!0),e.R7$(7),e.AVh("selected","efectivo"===n.selectedPayment),e.R7$(6),e.AVh("selected","paypal"===n.selectedPayment),e.R7$(13),e.SpI("Productos (",(null==n.cart||null==n.cart.detalle_carrito?null:n.cart.detalle_carrito.length)||0,")"),e.R7$(2),e.SpI("",e.iJd(30,18,e.eq3(24,F,null==n.cart?null:n.cart.total))," MXN"),e.R7$(2),e.Y8G("ngForOf",null==n.cart?null:n.cart.detalle_carrito),e.R7$(2),e.Y8G("ngIf",n.discountAmount>0),e.R7$(),e.Y8G("ngIf",n.discountAmount>0),e.R7$(),e.Y8G("ngIf",n.discountAmount>0),e.R7$(),e.Y8G("ngIf",0===n.discountAmount),e.R7$(5),e.SpI("",n.totalWeight,"kg"),e.R7$(),e.Y8G("ngIf",n.isEligibleForFreeDelivery()),e.R7$(),e.Y8G("ngIf",!n.isEligibleForFreeDelivery()),e.R7$(),e.Y8G("ngIf","tarjeta"===n.selectedPayment),e.R7$(),e.Y8G("ngIf","efectivo"===n.selectedPayment))},dependencies:[C.Sq,C.bT,l.Jm,l.b_,l.I9,l.ME,l.W9,l.iq,l.uz,l.he,l.KO,l.f0,l.uR,l.Je,S.l,C.QX,C.oe],styles:['@charset "UTF-8";.payment-card[_ngcontent-%COMP%], .summary-card[_ngcontent-%COMP%]{margin:16px;border-radius:16px;box-shadow:0 4px 8px #0000001a}.title[_ngcontent-%COMP%], .summary-title[_ngcontent-%COMP%]{font-size:1.2rem;font-weight:700;text-align:center;color:var(--ion-color-primary)}.option-card[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:16px;transition:transform .2s ease,background-color .3s ease}.option-card.selected[_ngcontent-%COMP%]{transform:scale(1.05);background-color:var(--ion-color-primary-tint)}.option-icon[_ngcontent-%COMP%]{font-size:2rem;color:var(--ion-color-primary);margin-right:8px}.summary-card[_ngcontent-%COMP%]{background-color:#f8f9fa;color:#343a40}.summary-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:12px 0;font-size:1rem}.divider[_ngcontent-%COMP%]{border-bottom:1px solid #dee2e6;margin:8px 0}.confirm-button-container[_ngcontent-%COMP%], .confirm-button-container-paypal[_ngcontent-%COMP%]{margin:16px}.confirm-button[_ngcontent-%COMP%]{--background: var(--ion-color-primary);color:#fff;font-weight:700;border-radius:24px;text-align:center;position:relative;overflow:hidden;transition:background-color .3s ease-in-out}.complete[_ngcontent-%COMP%]{--background: var(--ion-color-primary);color:#fff;font-weight:700;border-radius:24px;text-align:center;position:relative;overflow:hidden}.confirm-button.animated[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;height:100%;width:0%;background:linear-gradient(to right,var(--ion-color-primary),var(--ion-color-secondary),var(--ion-color-tertiary));z-index:1;animation:_ngcontent-%COMP%_slideIn 3s forwards}.confirm-button.animated[_ngcontent-%COMP%]{color:transparent}.confirm-button.animated[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#fff}.confirm-button.complete[_ngcontent-%COMP%]{--background: var(--ion-color-primary)}@keyframes _ngcontent-%COMP%_slideIn{0%{width:0%}50%{width:100%}to{width:0%}}.total-summary[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start}.total-summary[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin:4px 0}.discounted-price[_ngcontent-%COMP%]{color:green;font-weight:700}.original-price[_ngcontent-%COMP%]{color:gray;text-decoration:line-through;font-size:17px}.descuento[_ngcontent-%COMP%]{font-weight:700;font-size:17px}']}),c})();var ie=M(9365);const O=o=>[o,"MXN","symbol-narrow","1.2-2","en-US"];function ae(o,c){1&o&&(e.j41(0,"div",64),e.nrm(1,"ion-icon",65),e.k0s())}function re(o,c){1&o&&(e.j41(0,"div",64),e.nrm(1,"ion-icon",65),e.k0s())}function ce(o,c){1&o&&(e.j41(0,"span",77),e.EFF(1,"\xa1Env\xedo gratis!"),e.k0s())}function se(o,c){1&o&&(e.j41(0,"span",78),e.EFF(1,"Compra m\xednima para env\xedo gratis"),e.k0s())}function le(o,c){1&o&&(e.j41(0,"p"),e.EFF(1," Tu pedido califica para env\xedo gratuito a domicilio "),e.k0s())}function de(o,c){if(1&o&&(e.j41(0,"p"),e.EFF(1," Necesitas "),e.j41(2,"strong"),e.EFF(3),e.k0s(),e.EFF(4),e.k0s()),2&o){const a=e.XpG(2);e.R7$(3),e.SpI("",a.getRemainingWeightForFreeDelivery(),"kg m\xe1s"),e.R7$(),e.SpI(" para env\xedo gratis (m\xednimo ",a.MINIMUM_WEIGHT_FOR_FREE_DELIVERY,"kg) ")}}function ge(o,c){if(1&o&&(e.j41(0,"p",79),e.nrm(1,"ion-icon",20),e.EFF(2),e.nI1(3,"currency"),e.k0s()),2&o){const a=e.XpG(2);e.R7$(2),e.SpI(" Costo de env\xedo: ",e.iJd(3,1,e.eq3(7,O,a.DELIVERY_FEE))," MXN ")}}function me(o,c){if(1&o&&(e.j41(0,"div",66)(1,"div",67)(2,"div",68),e.nrm(3,"ion-icon",52),e.j41(4,"span"),e.EFF(5),e.k0s()(),e.j41(6,"div",69)(7,"div",70),e.nrm(8,"ion-icon",71),e.DNE(9,ce,2,0,"span",72)(10,se,2,0,"span",73),e.k0s(),e.j41(11,"div",74),e.DNE(12,le,2,0,"p",75)(13,de,5,2,"p",75)(14,ge,4,9,"p",76),e.k0s()()()()),2&o){const a=e.XpG();e.R7$(5),e.SpI("Peso actual: ",a.totalWeight,"kg"),e.R7$(),e.AVh("eligible",a.isEligibleForFreeDelivery())("not-eligible",!a.isEligibleForFreeDelivery()),e.R7$(2),e.Y8G("name",a.isEligibleForFreeDelivery()?"checkmark-circle":"information-circle"),e.R7$(),e.Y8G("ngIf",a.isEligibleForFreeDelivery()),e.R7$(),e.Y8G("ngIf",!a.isEligibleForFreeDelivery()),e.R7$(2),e.Y8G("ngIf",a.isEligibleForFreeDelivery()),e.R7$(),e.Y8G("ngIf",!a.isEligibleForFreeDelivery()),e.R7$(),e.Y8G("ngIf",!a.isEligibleForFreeDelivery())}}function pe(o,c){if(1&o&&(e.j41(0,"ion-select-option",80),e.EFF(1),e.k0s()),2&o){const a=c.$implicit;e.Y8G("value",a.value)("disabled",!a.enabled),e.R7$(),e.SpI(" ",a.label," ")}}function ue(o,c){1&o&&(e.qex(0),e.EFF(1," M\xednimo 2 horas de anticipaci\xf3n (9:00 AM - 8:00 PM) "),e.bVm())}function fe(o,c){1&o&&e.EFF(0," Horario: 9:00 AM - 8:00 PM ")}function _e(o,c){if(1&o&&(e.j41(0,"div",81)(1,"div",82),e.nrm(2,"ion-icon",31),e.j41(3,"span"),e.EFF(4),e.k0s()()()),2&o){const a=e.XpG();e.R7$(4),e.JRh(a.getFormattedDateTime())}}function he(o,c){if(1&o&&(e.j41(0,"div",48)(1,"span",83),e.nrm(2,"ion-icon",84),e.EFF(3),e.k0s(),e.j41(4,"span",85),e.EFF(5),e.nI1(6,"currency"),e.k0s()()),2&o){const a=e.XpG();e.R7$(3),e.SpI(" Descuento (",a.porcentaje,"%) "),e.R7$(2),e.SpI("-",e.iJd(6,2,e.eq3(8,O,a.discountAmount))," MXN")}}function ve(o,c){if(1&o&&(e.j41(0,"div",48)(1,"span",86),e.nrm(2,"ion-icon",87),e.EFF(3," Costo de env\xedo "),e.k0s(),e.j41(4,"span",88),e.EFF(5),e.nI1(6,"currency"),e.k0s()()),2&o){const a=e.XpG();e.R7$(5),e.SpI("",e.iJd(6,1,e.eq3(7,O,a.deliveryFee))," MXN")}}function Me(o,c){if(1&o&&(e.j41(0,"div",89),e.nrm(1,"ion-icon",90),e.j41(2,"span"),e.EFF(3),e.nI1(4,"currency"),e.k0s()()),2&o){const a=e.XpG();e.R7$(3),e.SpI("\xa1Ahorras ",e.iJd(4,1,e.eq3(7,O,a.discountAmount))," MXN!")}}function Ee(o,c){if(1&o&&(e.j41(0,"div",91),e.nrm(1,"ion-icon",71),e.j41(2,"span"),e.EFF(3),e.k0s()()),2&o){const a=e.XpG();e.R7$(),e.Y8G("name","negocio"===a.selectedMethod?"storefront-outline":"bicycle-outline"),e.R7$(2),e.JRh("negocio"===a.selectedMethod?"Recoger en tienda":"Entrega a domicilio")}}const Ce=[{path:"",component:(()=>{var o;class c{constructor(t,n,i){this.router=t,this.utilsSvc=n,this.firebaseSvc=i,this.selectedMethod="",this.discountAmount=0,this.porcentaje=0,this.minDate="",this.maxDate="",this.fechaRecoleccion="",this.horaRecoleccion="",this.horaEntrada="09:00",this.horaSalida="20:00",this.horaMinimaInput="09:00",this.horaOpciones=[],this.MINIMUM_WEIGHT_FOR_FREE_DELIVERY=60,this.DELIVERY_FEE=50,this.totalWeight=0,this.deliveryFee=0,this.showMinimumOrderMessage=!1}ngOnInit(){this.setDateLimits(),this.setDefaultDate(),this.getCartDetails(),this.getHorarioTrabajo().then(()=>{this.generarOpcionesHora()})}getHorarioTrabajo(){var t=this;return(0,f.A)(function*(){try{const n=yield t.firebaseSvc.getDocument("horario/waeYL5UAeC3YyZ8BW3KT");n&&(t.horaEntrada=n.hora_entrada||"09:00",t.horaSalida=n.hora_salida||"20:00")}catch{t.horaEntrada="09:00",t.horaSalida="20:00"}})()}setDateLimits(){const t=new Date;t.setHours(0,0,0,0),this.minDate=t.toISOString().slice(0,10);const n=new Date;n.setMonth(t.getMonth()+1),n.setHours(23,59,59,999),this.maxDate=n.toISOString().slice(0,10)}setDefaultDate(){const t=new Date;t.setHours(0,0,0,0),this.fechaRecoleccion=t.toISOString().slice(0,10),this.horaRecoleccion=""}onDateOrTimeChange(){if(this.updateHoraMinimaInput(),this.generarOpcionesHora(),this.fechaRecoleccion&&this.horaRecoleccion&&!this.isHoraDentroHorario(this.horaRecoleccion))return this.utilsSvc.presentToast({message:`La hora debe estar entre ${this.horaMinimaInput} y ${this.horaSalida}`,duration:2500,color:"warning",position:"bottom",icon:"time-outline"}),void(this.horaRecoleccion="")}generarOpcionesHora(){let t=[];if(!this.horaEntrada||!this.horaSalida)return void(this.horaOpciones=[]);const[n,i]=this.horaEntrada.split(":").map(Number),[r,s]=this.horaSalida.split(":").map(Number);let d=new Date,m=null;this.fechaRecoleccion&&(m=new Date(this.fechaRecoleccion));let p=m&&m.getFullYear()===d.getFullYear()&&m.getMonth()===d.getMonth()&&m.getDate()+1===d.getDate();if(p&&60*d.getHours()+d.getMinutes()>=60*r+s)return this.horaOpciones=[],void this.utilsSvc.presentToast({message:"El horario de hoy ya termin\xf3. Por favor selecciona otro d\xeda.",duration:3500,color:"danger",position:"top",icon:"time-outline"});let g=n,h=i;if(p){const v=d.getHours(),y=d.getMinutes();let u=15*Math.ceil(y/15),P=v;60===u&&(P++,u=0),P<n||P===n&&u<i?(g=n,h=i):(g=P,h=u)}let _=60*g+h,x=60*r+s;for(let v=60*n+i;v<=x;v+=15){if(p&&v<_)continue;const u=v%60,P=`${Math.floor(v/60).toString().padStart(2,"0")}:${u.toString().padStart(2,"0")}`,E=this.formatHoraAMPM(P);t.push({value:P,label:E,enabled:!0})}this.horaOpciones=t,this.horaRecoleccion&&!t.find(v=>v.value===this.horaRecoleccion)&&(this.horaRecoleccion="")}updateHoraMinimaInput(){if(!this.fechaRecoleccion)return void(this.horaMinimaInput=this.horaEntrada);const t=new Date,n=new Date(this.fechaRecoleccion);if(n.getFullYear()===t.getFullYear()&&n.getMonth()===t.getMonth()&&n.getDate()===t.getDate()){const i=t.getHours(),r=t.getMinutes(),[s,d]=this.horaEntrada.split(":").map(Number);let m=Math.max(s,i),p=m===i?r:d;(i<s||i===s&&r<d)&&(m=s,p=d),this.horaMinimaInput=`${m.toString().padStart(2,"0")}:${p.toString().padStart(2,"0")}`}else this.horaMinimaInput=this.horaEntrada}isHoraDentroHorario(t){if(!t)return!1;const[n,i]=t.split(":").map(Number),[r,s]=this.horaEntrada.split(":").map(Number),[d,m]=this.horaSalida.split(":").map(Number),p=60*n+i;return p>=60*r+s&&p<=60*d+m}onMethodChange(t){this.selectedMethod=t,this.updateDeliveryFee(),this.showMinimumOrderMessage="domicilio"===t&&this.totalWeight<this.MINIMUM_WEIGHT_FOR_FREE_DELIVERY}calculateTotalWeight(){this.totalWeight=0,this.cart&&this.cart.detalle_carrito&&(this.totalWeight=this.cart.detalle_carrito.reduce((t,n)=>t+(n.cantidad||0),0))}updateDeliveryFee(){this.deliveryFee="domicilio"===this.selectedMethod&&this.totalWeight<this.MINIMUM_WEIGHT_FOR_FREE_DELIVERY?this.DELIVERY_FEE:0}getRemainingWeightForFreeDelivery(){return Math.max(0,this.MINIMUM_WEIGHT_FOR_FREE_DELIVERY-this.totalWeight)}isEligibleForFreeDelivery(){return this.totalWeight>=this.MINIMUM_WEIGHT_FOR_FREE_DELIVERY}continue(){var t=this;return(0,f.A)(function*(){if(t.selectedMethod&&t.fechaRecoleccion&&t.horaRecoleccion){if(!t.isValidDate())return void t.utilsSvc.presentToast({message:"Por favor selecciona una fecha v\xe1lida (desde hoy hasta 1 mes)",duration:3e3,color:"warning",position:"top"});if(!t.isHoraDentroHorario(t.horaRecoleccion))return void t.utilsSvc.presentToast({message:"Horario de atenci\xf3n: Lunes a Domingo de 9:00 AM a 8:00 PM",duration:4e3,color:"warning",position:"top"});const n=t.combineDateTime();t.utilsSvc.saveInLocalStorage("selectedMethod",t.selectedMethod),t.cart.fecha_entrega=n,t.utilsSvc.saveInLocalStorage("carrito_eventos",[t.cart]),"negocio"===t.selectedMethod?(yield t.savePickupInfoToFirebase(n),(yield t.utilsSvc.presentModal({component:oe,componentProps:{}}))&&t.utilsSvc.dismissModal(!0)):"domicilio"===t.selectedMethod&&(yield t.utilsSvc.presentModal({component:ie.H,componentProps:{}}))&&(yield t.utilsSvc.presentModal({component:V,componentProps:{}}))&&t.utilsSvc.dismissModal(!0)}})()}savePickupInfoToFirebase(t){var n=this;return(0,f.A)(function*(){try{const i=n.utilsSvc.getFromLocalStorage("user").uid,r=n.cart.id;yield n.firebaseSvc.updateDocumet(`users/${i}/carrito_eventos/${r}`,{metodo_entrega:"negocio",fecha_entrega:t,hora_recoleccion:t,es_recoleccion_negocio:!0,updated_at:new Date}),console.log("Informaci\xf3n de recolecci\xf3n guardada en Firebase")}catch(i){console.error("Error al guardar informaci\xf3n de recolecci\xf3n:",i)}})()}isValidDate(){if(!this.fechaRecoleccion)return!1;const t=new Date(this.fechaRecoleccion),n=new Date;n.setHours(0,0,0,0);const i=new Date;return i.setMonth(n.getMonth()+1),i.setHours(23,59,59,999),t>=n&&t<=i}isValidTime(){if(!this.horaRecoleccion||!this.fechaRecoleccion)return!1;const t=new Date(this.fechaRecoleccion),[n,i]=this.horaRecoleccion.split(":").map(Number),r=new Date,s=new Date(t);if(s.setHours(n,i,0,0),t.toDateString()===r.toDateString()){const d=new Date(r);return d.setHours(d.getHours()+2),s>=d&&s>r}return!0}isWithinBusinessHours(){if(!this.horaRecoleccion)return!1;const[t,n]=this.horaRecoleccion.split(":").map(Number);return t>=9&&t<20}combineDateTime(){return this.fechaRecoleccion&&this.horaRecoleccion?`${this.fechaRecoleccion}T${this.horaRecoleccion}:00`:""}getFormattedDateTime(){if(!this.fechaRecoleccion||!this.horaRecoleccion)return"";const t=this.combineDateTime();return new Date(t).toLocaleDateString("es-ES",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}getCartDetails(){this.cart=this.utilsSvc.getFromLocalStorage("carrito_eventos")[0],this.calculateTotalWeight()}applyStoredCoupon(){if(this.cart){const t=this.utilsSvc.getFromLocalStorage("appliedCoupon");t&&(this.discountAmount=this.cart.total*t.porcentaje/100,this.porcentaje=t.porcentaje),this.calculateTotalWeight()}}getTotalAmount(){if(!this.cart)return 0;let t=this.cart.total;return this.discountAmount>0&&(t-=this.discountAmount),t+=this.deliveryFee,t}formatHoraAMPM(t){if(!t)return"";const[n,i]=t.split(":").map(Number),r=n>=12?"PM":"AM";return`${n%12||12}:${i.toString().padStart(2,"0")} ${r}`}}return(o=c).\u0275fac=function(t){return new(t||o)(e.rXU(k.Ix),e.rXU(D.T),e.rXU(R.f))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-metodo-entrega-eventos"]],decls:126,vars:42,consts:[["futureDate",""],["title","M\xe9todo de entrega",3,"showMenu"],[3,"fullscreen"],[1,"container"],[1,"hero-section"],["name","fast-food-outline",1,"hero-icon"],[1,"hero-title"],[1,"hero-subtitle"],[1,"content-grid"],[1,"delivery-section"],[1,"delivery-options"],[1,"delivery-option",3,"click"],[1,"option-header"],[1,"option-icon-wrapper"],["name","storefront",1,"option-main-icon"],["class","option-badge",4,"ngIf"],[1,"option-content"],[1,"option-features"],[1,"feature"],["name","time-outline"],["name","cash-outline"],["name","bicycle",1,"option-main-icon"],["name","location-outline"],["class","delivery-info",4,"ngIf"],[1,"date-section"],[1,"date-card"],[1,"date-header"],["name","calendar-outline",1,"date-icon"],[1,"datetime-container"],[1,"datetime-field"],[1,"datetime-label"],["name","calendar-outline"],[1,"input-icon-wrapper"],["type","date","placeholder","Selecciona la fecha",1,"custom-datetime",3,"ngModelChange","ionChange","ngModel","min","max"],["name","calendar-outline",1,"input-suffix-icon"],[1,"datetime-hint"],["name","information-circle-outline"],["placeholder","Selecciona la hora","interface","popover",1,"custom-datetime",3,"ngModelChange","ionChange","ngModel"],[3,"value","disabled",4,"ngFor","ngForOf"],["name","time-outline",1,"input-suffix-icon"],[4,"ngIf","ngIfElse"],["class","selected-datetime",4,"ngIf"],[1,"summary-section"],[1,"summary-card"],[1,"summary-header"],["name","receipt-outline",1,"summary-icon"],[1,"summary-content"],[1,"order-details"],[1,"detail-row"],[1,"detail-label"],["name","bag-outline"],[1,"detail-value"],["name","cube-outline"],["class","detail-row",4,"ngIf"],[1,"summary-divider"],[1,"total-section"],[1,"total-row"],[1,"total-label"],[1,"total-amount"],["class","savings",4,"ngIf"],[1,"footer-content"],["class","selected-method",4,"ngIf"],["expand","block","size","large",1,"continue-button",3,"click","disabled"],["name","arrow-forward-outline","slot","end"],[1,"option-badge"],["name","checkmark-circle"],[1,"delivery-info"],[1,"weight-info"],[1,"current-weight"],[1,"minimum-order-message"],[1,"message-header"],[3,"name"],["class","success-text",4,"ngIf"],["class","warning-text",4,"ngIf"],[1,"message-content"],[4,"ngIf"],["class","delivery-fee-info",4,"ngIf"],[1,"success-text"],[1,"warning-text"],[1,"delivery-fee-info"],[3,"value","disabled"],[1,"selected-datetime"],[1,"datetime-preview"],[1,"detail-label","discount-label"],["name","pricetag-outline"],[1,"detail-value","discount-value"],[1,"detail-label","delivery-fee-label"],["name","bicycle-outline"],[1,"detail-value","delivery-fee-value"],[1,"savings"],["name","happy-outline"],[1,"selected-method"]],template:function(t,n){if(1&t){const i=e.RV6();e.nrm(0,"app-header",1),e.j41(1,"ion-content",2)(2,"div",3)(3,"div",4),e.nrm(4,"ion-icon",5),e.j41(5,"h1",6),e.EFF(6,"\xbfC\xf3mo quieres recibir tu pedido?"),e.k0s(),e.j41(7,"p",7),e.EFF(8,"Elige la opci\xf3n que mejor se adapte a ti"),e.k0s()(),e.j41(9,"div",8)(10,"div",9)(11,"div",10)(12,"div",11),e.bIt("click",function(){return e.eBV(i),e.Njj(n.onMethodChange("negocio"))}),e.j41(13,"div",12)(14,"div",13),e.nrm(15,"ion-icon",14),e.k0s(),e.DNE(16,ae,2,0,"div",15),e.k0s(),e.j41(17,"div",16)(18,"h3"),e.EFF(19,"Recoger en tienda"),e.k0s(),e.j41(20,"p"),e.EFF(21,"Retira tu pedido directamente en nuestro local"),e.k0s(),e.j41(22,"div",17)(23,"div",18),e.nrm(24,"ion-icon",19),e.j41(25,"span"),e.EFF(26,"15-20 min"),e.k0s()(),e.j41(27,"div",18),e.nrm(28,"ion-icon",20),e.j41(29,"span"),e.EFF(30,"Sin costo"),e.k0s()()()()(),e.j41(31,"div",11),e.bIt("click",function(){return e.eBV(i),e.Njj(n.onMethodChange("domicilio"))}),e.j41(32,"div",12)(33,"div",13),e.nrm(34,"ion-icon",21),e.k0s(),e.DNE(35,re,2,0,"div",15),e.k0s(),e.j41(36,"div",16)(37,"h3"),e.EFF(38,"Entrega a domicilio"),e.k0s(),e.j41(39,"p"),e.EFF(40,"Recibe tu pedido en la comodidad de tu hogar"),e.k0s(),e.j41(41,"div",17)(42,"div",18),e.nrm(43,"ion-icon",19),e.j41(44,"span"),e.EFF(45,"30-45 min"),e.k0s()(),e.j41(46,"div",18),e.nrm(47,"ion-icon",22),e.j41(48,"span"),e.EFF(49,"A tu puerta"),e.k0s()()(),e.DNE(50,me,15,11,"div",23),e.k0s()()(),e.j41(51,"div",24)(52,"div",25)(53,"div",26),e.nrm(54,"ion-icon",27),e.j41(55,"h3"),e.EFF(56,"Fecha y hora de entrega"),e.k0s()(),e.j41(57,"div",28)(58,"div",29)(59,"label",30),e.nrm(60,"ion-icon",31),e.EFF(61," Fecha "),e.k0s(),e.j41(62,"div",32)(63,"ion-input",33),e.mxI("ngModelChange",function(s){return e.eBV(i),e.DH7(n.fechaRecoleccion,s)||(n.fechaRecoleccion=s),e.Njj(s)}),e.bIt("ionChange",function(){return e.eBV(i),e.Njj(n.onDateOrTimeChange())}),e.k0s(),e.nrm(64,"ion-icon",34),e.k0s(),e.j41(65,"small",35),e.nrm(66,"ion-icon",36),e.EFF(67," Disponible desde hoy hasta 1 mes "),e.k0s()(),e.j41(68,"div",29)(69,"label",30),e.nrm(70,"ion-icon",19),e.EFF(71," Hora "),e.k0s(),e.j41(72,"div",32)(73,"ion-select",37),e.mxI("ngModelChange",function(s){return e.eBV(i),e.DH7(n.horaRecoleccion,s)||(n.horaRecoleccion=s),e.Njj(s)}),e.bIt("ionChange",function(){return e.eBV(i),e.Njj(n.onDateOrTimeChange())}),e.DNE(74,pe,2,3,"ion-select-option",38),e.k0s(),e.nrm(75,"ion-icon",39),e.k0s(),e.j41(76,"small",35),e.nrm(77,"ion-icon",36),e.DNE(78,ue,2,0,"ng-container",40)(79,fe,1,0,"ng-template",null,0,e.C5r),e.k0s()()(),e.DNE(81,_e,5,1,"div",41),e.k0s()()(),e.j41(82,"div",42)(83,"div",43)(84,"div",44),e.nrm(85,"ion-icon",45),e.j41(86,"h3"),e.EFF(87,"Resumen del pedido"),e.k0s()(),e.j41(88,"div",46)(89,"div",47)(90,"div",48)(91,"span",49),e.nrm(92,"ion-icon",50),e.EFF(93," Productos "),e.k0s(),e.j41(94,"span",51),e.EFF(95),e.k0s()(),e.j41(96,"div",48)(97,"span",49),e.nrm(98,"ion-icon",52),e.EFF(99," Peso total "),e.k0s(),e.j41(100,"span",51),e.EFF(101),e.k0s()(),e.j41(102,"div",48)(103,"span",49),e.EFF(104,"Subtotal"),e.k0s(),e.j41(105,"span",51),e.EFF(106),e.nI1(107,"currency"),e.k0s()(),e.DNE(108,he,7,10,"div",53)(109,ve,7,9,"div",53),e.k0s(),e.nrm(110,"div",54),e.j41(111,"div",55)(112,"div",56)(113,"span",57),e.EFF(114,"Total a pagar"),e.k0s(),e.j41(115,"span",58),e.EFF(116),e.nI1(117,"currency"),e.k0s()(),e.DNE(118,Me,5,9,"div",59),e.k0s()()()()()()(),e.j41(119,"ion-footer")(120,"ion-toolbar")(121,"div",60),e.DNE(122,Ee,4,2,"div",61),e.j41(123,"ion-button",62),e.bIt("click",function(){return e.eBV(i),e.Njj(n.continue())}),e.nrm(124,"ion-icon",63),e.EFF(125," Continuar con el pedido "),e.k0s()()()()}if(2&t){const i=e.sdS(80);e.Y8G("showMenu",!0),e.R7$(),e.Y8G("fullscreen",!0),e.R7$(11),e.AVh("selected","negocio"===n.selectedMethod),e.R7$(4),e.Y8G("ngIf","negocio"===n.selectedMethod),e.R7$(15),e.AVh("selected","domicilio"===n.selectedMethod),e.R7$(4),e.Y8G("ngIf","domicilio"===n.selectedMethod),e.R7$(15),e.Y8G("ngIf","domicilio"===n.selectedMethod),e.R7$(13),e.R50("ngModel",n.fechaRecoleccion),e.Y8G("min",n.minDate)("max",n.maxDate),e.R7$(10),e.R50("ngModel",n.horaRecoleccion),e.R7$(),e.Y8G("ngForOf",n.horaOpciones),e.R7$(4),e.Y8G("ngIf",n.fechaRecoleccion===n.minDate)("ngIfElse",i),e.R7$(3),e.Y8G("ngIf",n.fechaRecoleccion&&n.horaRecoleccion),e.R7$(14),e.SpI("",(null==n.cart||null==n.cart.detalle_carrito?null:n.cart.detalle_carrito.length)||0," items"),e.R7$(6),e.SpI("",n.totalWeight,"kg"),e.R7$(5),e.SpI("",e.iJd(107,26,e.eq3(38,O,null==n.cart?null:n.cart.total))," MXN"),e.R7$(2),e.Y8G("ngIf",n.discountAmount>0),e.R7$(),e.Y8G("ngIf",n.deliveryFee>0),e.R7$(7),e.SpI("",e.iJd(117,32,e.eq3(40,O,n.getTotalAmount()))," MXN"),e.R7$(2),e.Y8G("ngIf",n.discountAmount>0),e.R7$(4),e.Y8G("ngIf",n.selectedMethod),e.R7$(),e.Y8G("disabled",!n.selectedMethod||!n.fechaRecoleccion||!n.horaRecoleccion)}},dependencies:[C.Sq,C.bT,I.BC,I.vS,l.Jm,l.W9,l.M0,l.iq,l.$w,l.Nm,l.Ip,l.ai,l.Je,l.Gw,S.l,C.oe],styles:['ion-content[_ngcontent-%COMP%]{--background: linear-gradient(135deg, #a3a3a3 0%, #e2e2e2 100%);--padding-start: 0;--padding-end: 0}.container[_ngcontent-%COMP%]{min-height:100vh;padding:0 16px 100px}.hero-section[_ngcontent-%COMP%]{text-align:center;padding:40px 20px;color:#fff}.hero-section[_ngcontent-%COMP%]   .hero-icon[_ngcontent-%COMP%]{font-size:4rem;margin-bottom:16px;opacity:.9}.hero-section[_ngcontent-%COMP%]   .hero-title[_ngcontent-%COMP%]{font-size:1.8rem;font-weight:700;margin:0 0 8px;text-shadow:0 2px 4px rgba(0,0,0,.3)}.hero-section[_ngcontent-%COMP%]   .hero-subtitle[_ngcontent-%COMP%]{font-size:1rem;opacity:.9;margin:0;font-weight:400}.content-grid[_ngcontent-%COMP%]{display:grid;gap:24px;max-width:1200px;margin:0 auto}@media (min-width: 768px){.content-grid[_ngcontent-%COMP%]{grid-template-columns:2fr 1fr;gap:32px}}.delivery-section[_ngcontent-%COMP%]   .delivery-options[_ngcontent-%COMP%]{display:grid;gap:20px;margin-bottom:24px}@media (min-width: 480px){.delivery-section[_ngcontent-%COMP%]   .delivery-options[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr;gap:16px}}@media (min-width: 768px){.delivery-section[_ngcontent-%COMP%]   .delivery-options[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:20px}}.delivery-option[_ngcontent-%COMP%]{background:#fff;border-radius:20px;padding:24px;cursor:pointer;transition:all .3s cubic-bezier(.4,0,.2,1);border:3px solid transparent;box-shadow:0 8px 32px #0000001a;position:relative;overflow:hidden}.delivery-option[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background:linear-gradient(135deg,#667eea0d,#764ba20d);opacity:0;transition:opacity .3s ease}.delivery-option[_ngcontent-%COMP%]:hover{transform:translateY(-4px);box-shadow:0 16px 48px #00000026}.delivery-option[_ngcontent-%COMP%]:hover:before{opacity:1}.delivery-option[_ngcontent-%COMP%]:hover   .option-main-icon[_ngcontent-%COMP%]{transform:scale(1.1)}.delivery-option.selected[_ngcontent-%COMP%]{border-color:var(--ion-color-primary);transform:translateY(-2px);box-shadow:0 12px 40px rgba(var(--ion-color-primary-rgb),.3)}.delivery-option.selected[_ngcontent-%COMP%]:before{opacity:1;background:linear-gradient(135deg,rgba(var(--ion-color-primary-rgb),.1),rgba(var(--ion-color-secondary-rgb),.1))}.delivery-option.selected[_ngcontent-%COMP%]   .option-main-icon[_ngcontent-%COMP%]{color:var(--ion-color-primary);transform:scale(1.05)}.delivery-option.selected[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:var(--ion-color-primary)}.option-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;position:relative;z-index:1}.option-icon-wrapper[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:50%;background:linear-gradient(135deg,#f8f9fa,#e9ecef);display:flex;align-items:center;justify-content:center;box-shadow:0 4px 12px #0000001a}.option-main-icon[_ngcontent-%COMP%]{font-size:1.8rem;color:var(--ion-color-medium);transition:all .3s ease}.option-badge[_ngcontent-%COMP%]{width:32px;height:32px;background:var(--ion-color-success);border-radius:50%;display:flex;align-items:center;justify-content:center}.option-badge[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#fff;font-size:1.2rem}.option-content[_ngcontent-%COMP%]{position:relative;z-index:1}.option-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.3rem;font-weight:700;margin:0 0 8px;color:var(--ion-color-dark);transition:color .3s ease}.option-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--ion-color-medium);font-size:.95rem;margin:0 0 16px;line-height:1.4}.option-features[_ngcontent-%COMP%]{display:flex;gap:16px}.option-features[_ngcontent-%COMP%]   .feature[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;font-size:.85rem;color:var(--ion-color-medium)}.option-features[_ngcontent-%COMP%]   .feature[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1rem;color:var(--ion-color-primary)}.date-section[_ngcontent-%COMP%]{margin-top:24px}.date-card[_ngcontent-%COMP%]{background:#fff;border-radius:20px;padding:24px;box-shadow:0 8px 32px #0000001a}.date-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin-bottom:20px}.date-header[_ngcontent-%COMP%]   .date-icon[_ngcontent-%COMP%]{font-size:1.5rem;color:var(--ion-color-primary)}.date-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.2rem;font-weight:600;color:var(--ion-color-dark)}.datetime-container[_ngcontent-%COMP%]{display:grid;gap:20px}@media (min-width: 480px){.datetime-container[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr;gap:16px}}.datetime-field[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.datetime-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:.9rem;font-weight:600;color:var(--ion-color-medium)}.datetime-label[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1rem;color:var(--ion-color-primary)}.datetime-label[_ngcontent-%COMP%]   ion-icon[name=calendar-outline][_ngcontent-%COMP%]{color:var(--ion-color-primary)!important}.custom-datetime[_ngcontent-%COMP%]{width:100%;--background: var(--ion-color-light);--color: var(--ion-color-primary);--border-radius: 12px;--padding: 16px;--box-shadow: 0px 4px 8px rgba(0, 0, 0, .1);border:2px solid #f0f0f0;transition:border-color .3s ease}.custom-datetime[_ngcontent-%COMP%]:focus-within{border-color:var(--ion-color-primary)}.datetime-hint[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;font-size:.8rem;color:var(--ion-color-medium);margin-top:4px}.datetime-hint[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:.9rem;color:var(--ion-color-primary)}.selected-datetime[_ngcontent-%COMP%]{margin-top:20px;padding:16px;background:linear-gradient(135deg,rgba(var(--ion-color-primary-rgb),.1),rgba(var(--ion-color-secondary-rgb),.05));border-radius:12px;border:2px solid rgba(var(--ion-color-primary-rgb),.2)}.datetime-preview[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;font-weight:600;color:var(--ion-color-primary)}.datetime-preview[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1.2rem}.datetime-preview[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.95rem;text-transform:capitalize}@media (max-width: 767px){.summary-section[_ngcontent-%COMP%]{order:-1}}.summary-card[_ngcontent-%COMP%]{background:#fff;border-radius:20px;overflow:hidden;box-shadow:0 8px 32px #0000001a;position:sticky;top:20px}.summary-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--ion-color-primary) 0%,var(--ion-color-secondary) 100%);color:#fff;padding:20px 24px;display:flex;align-items:center;gap:12px}.summary-header[_ngcontent-%COMP%]   .summary-icon[_ngcontent-%COMP%]{font-size:1.5rem}.summary-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.2rem;font-weight:600}.summary-content[_ngcontent-%COMP%]{padding:24px}.order-details[_ngcontent-%COMP%]{margin-bottom:20px}.detail-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:12px 0;border-bottom:1px solid #f0f0f0}.detail-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.detail-row[_ngcontent-%COMP%]   .detail-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;color:var(--ion-color-medium);font-size:.95rem}.detail-row[_ngcontent-%COMP%]   .detail-label[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1rem;color:var(--ion-color-primary)}.detail-row[_ngcontent-%COMP%]   .detail-label.discount-label[_ngcontent-%COMP%]{color:var(--ion-color-warning);font-weight:600}.detail-row[_ngcontent-%COMP%]   .detail-value[_ngcontent-%COMP%]{font-weight:600;color:var(--ion-color-dark)}.detail-row[_ngcontent-%COMP%]   .detail-value.discount-value[_ngcontent-%COMP%]{color:var(--ion-color-warning)}.summary-divider[_ngcontent-%COMP%]{height:2px;background:linear-gradient(to right,transparent,var(--ion-color-primary),transparent);margin:16px 0;border-radius:2px}.total-section[_ngcontent-%COMP%]   .total-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:16px 0}.total-section[_ngcontent-%COMP%]   .total-row[_ngcontent-%COMP%]   .total-label[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:600;color:var(--ion-color-dark)}.total-section[_ngcontent-%COMP%]   .total-row[_ngcontent-%COMP%]   .total-amount[_ngcontent-%COMP%]{font-size:1.4rem;font-weight:700;color:var(--ion-color-primary)}.total-section[_ngcontent-%COMP%]   .savings[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:12px 16px;background:linear-gradient(135deg,rgba(var(--ion-color-success-rgb),.1),rgba(var(--ion-color-success-rgb),.05));border-radius:12px;margin-top:12px}.total-section[_ngcontent-%COMP%]   .savings[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:var(--ion-color-success);font-size:1.2rem}.total-section[_ngcontent-%COMP%]   .savings[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--ion-color-success);font-weight:600;font-size:.9rem}ion-footer[_ngcontent-%COMP%]{background:#fff;border-top:1px solid #f0f0f0}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background: transparent;--padding-start: 16px;--padding-end: 16px;--padding-top: 16px;--padding-bottom: 16px}.footer-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.selected-method[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:8px 16px;background:rgba(var(--ion-color-primary-rgb),.1);border-radius:8px;font-size:.9rem;color:var(--ion-color-primary);font-weight:600}.selected-method[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1rem}.continue-button[_ngcontent-%COMP%]{--border-radius: 16px;--padding-start: 24px;--padding-end: 24px;height:56px;font-size:1.1rem;font-weight:600;background:linear-gradient(135deg,var(--ion-color-primary) 0%,var(--ion-color-secondary) 100%);box-shadow:0 4px 16px rgba(var(--ion-color-primary-rgb),.4);transition:all .3s ease}.continue-button[_ngcontent-%COMP%]:not([disabled]):hover{transform:translateY(-2px);box-shadow:0 8px 24px rgba(var(--ion-color-primary-rgb),.5)}.continue-button[disabled][_ngcontent-%COMP%]{opacity:.5;background:var(--ion-color-medium);box-shadow:none}.continue-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1.2rem}@keyframes _ngcontent-%COMP%_slideInUp{0%{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}.delivery-option[_ngcontent-%COMP%], .date-card[_ngcontent-%COMP%], .summary-card[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideInUp .6s ease-out}.delivery-option[_ngcontent-%COMP%]:nth-child(1){animation-delay:.1s}.delivery-option[_ngcontent-%COMP%]:nth-child(2){animation-delay:.2s}.date-card[_ngcontent-%COMP%]{animation-delay:.3s}.summary-card[_ngcontent-%COMP%]{animation-delay:.4s}@media (max-width: 480px){.container[_ngcontent-%COMP%]{padding:0 12px 100px}.hero-section[_ngcontent-%COMP%]{padding:30px 16px}.hero-section[_ngcontent-%COMP%]   .hero-title[_ngcontent-%COMP%]{font-size:1.5rem}.hero-section[_ngcontent-%COMP%]   .hero-icon[_ngcontent-%COMP%]{font-size:3rem}.delivery-option[_ngcontent-%COMP%], .date-card[_ngcontent-%COMP%]{padding:20px}.option-features[_ngcontent-%COMP%]{flex-direction:column;gap:8px}.summary-content[_ngcontent-%COMP%]{padding:20px}}.delivery-info[_ngcontent-%COMP%]{margin-top:16px;padding-top:16px;border-top:1px solid #e0e0e0}.weight-info[_ngcontent-%COMP%]   .current-weight[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-bottom:12px;font-size:.9rem;color:var(--ion-color-medium);font-weight:500}.weight-info[_ngcontent-%COMP%]   .current-weight[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1rem;color:var(--ion-color-primary)}.minimum-order-message[_ngcontent-%COMP%]{padding:16px;border-radius:12px;border:2px solid;transition:all .3s ease}.minimum-order-message.eligible[_ngcontent-%COMP%]{background:linear-gradient(135deg,rgba(var(--ion-color-success-rgb),.1),rgba(var(--ion-color-success-rgb),.05));border-color:var(--ion-color-success)}.minimum-order-message.eligible[_ngcontent-%COMP%]   .message-header[_ngcontent-%COMP%]{color:var(--ion-color-success)}.minimum-order-message.not-eligible[_ngcontent-%COMP%]{background:linear-gradient(135deg,rgba(var(--ion-color-warning-rgb),.1),rgba(var(--ion-color-warning-rgb),.05));border-color:var(--ion-color-warning)}.minimum-order-message.not-eligible[_ngcontent-%COMP%]   .message-header[_ngcontent-%COMP%]{color:var(--ion-color-warning)}.minimum-order-message[_ngcontent-%COMP%]   .message-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-bottom:8px;font-weight:600;font-size:.9rem}.minimum-order-message[_ngcontent-%COMP%]   .message-header[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1.1rem}.minimum-order-message[_ngcontent-%COMP%]   .message-header[_ngcontent-%COMP%]   .success-text[_ngcontent-%COMP%]{color:var(--ion-color-success)}.minimum-order-message[_ngcontent-%COMP%]   .message-header[_ngcontent-%COMP%]   .warning-text[_ngcontent-%COMP%]{color:var(--ion-color-warning)}.minimum-order-message[_ngcontent-%COMP%]   .message-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 8px;font-size:.85rem;line-height:1.4;color:var(--ion-color-medium)}.minimum-order-message[_ngcontent-%COMP%]   .message-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:last-child{margin-bottom:0}.minimum-order-message[_ngcontent-%COMP%]   .message-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:var(--ion-color-dark);font-weight:600}.minimum-order-message[_ngcontent-%COMP%]   .message-content[_ngcontent-%COMP%]   p.delivery-fee-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;margin-top:8px;padding-top:8px;border-top:1px solid rgba(var(--ion-color-warning-rgb),.2);color:var(--ion-color-warning);font-weight:500}.minimum-order-message[_ngcontent-%COMP%]   .message-content[_ngcontent-%COMP%]   p.delivery-fee-info[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1rem}.detail-row[_ngcontent-%COMP%]   .delivery-fee-label[_ngcontent-%COMP%]{color:var(--ion-color-warning);font-weight:500}.detail-row[_ngcontent-%COMP%]   .delivery-fee-label[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:var(--ion-color-warning)}.detail-row[_ngcontent-%COMP%]   .delivery-fee-value[_ngcontent-%COMP%]{color:var(--ion-color-warning);font-weight:600}@media (max-width: 480px){.delivery-info[_ngcontent-%COMP%]{margin-top:12px;padding-top:12px}.minimum-order-message[_ngcontent-%COMP%]{padding:12px}.minimum-order-message[_ngcontent-%COMP%]   .message-header[_ngcontent-%COMP%]{font-size:.85rem}.minimum-order-message[_ngcontent-%COMP%]   .message-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.8rem}.current-weight[_ngcontent-%COMP%]{font-size:.85rem!important}}ion-item.date-time-item[_ngcontent-%COMP%], ion-item[_ngcontent-%COMP%]:has(ion-input[type=date]), ion-item[_ngcontent-%COMP%]:has(ion-select){background:linear-gradient(90deg,#f8fafc 0%,var(--ion-color-primary-tint) 100%);border-radius:14px;margin-bottom:18px;box-shadow:0 4px 16px #28a74517;border:1.5px solid var(--ion-color-primary-tint);position:relative;transition:box-shadow .2s,border-color .2s}ion-item.date-time-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%], ion-item[_ngcontent-%COMP%]:has(ion-input[type=date])   ion-label[_ngcontent-%COMP%], ion-item[_ngcontent-%COMP%]:has(ion-select)   ion-label[_ngcontent-%COMP%]{font-weight:700;color:var(--ion-color-primary);font-size:1.08rem;letter-spacing:.5px;margin-bottom:4px;display:flex;align-items:center;gap:6px}ion-item.date-time-item[_ngcontent-%COMP%]   ion-input[type=date][_ngcontent-%COMP%], ion-item[_ngcontent-%COMP%]:has(ion-input[type=date])   ion-input[type=date][_ngcontent-%COMP%], ion-item[_ngcontent-%COMP%]:has(ion-select)   ion-input[type=date][_ngcontent-%COMP%]{border:2px solid var(--ion-color-primary-tint);border-radius:8px;padding:12px 16px;font-size:1.15rem;background:#fff;color:var(--ion-color-dark);font-weight:600;box-shadow:0 2px 8px #28a74512;transition:border-color .2s,box-shadow .2s,background .2s;outline:none;margin-top:6px}ion-item.date-time-item[_ngcontent-%COMP%]   ion-input[type=date][_ngcontent-%COMP%]:focus, ion-item[_ngcontent-%COMP%]:has(ion-input[type=date])   ion-input[type=date][_ngcontent-%COMP%]:focus, ion-item[_ngcontent-%COMP%]:has(ion-select)   ion-input[type=date][_ngcontent-%COMP%]:focus{border-color:var(--ion-color-primary);background:linear-gradient(90deg,#e9f5e1,#fff);box-shadow:0 0 0 3px #28a74526;animation:inputFocusPulse .3s}ion-item.date-time-item[_ngcontent-%COMP%]   ion-input[type=date][_ngcontent-%COMP%]:hover, ion-item[_ngcontent-%COMP%]:has(ion-input[type=date])   ion-input[type=date][_ngcontent-%COMP%]:hover, ion-item[_ngcontent-%COMP%]:has(ion-select)   ion-input[type=date][_ngcontent-%COMP%]:hover{border-color:var(--ion-color-primary-shade);background:#f4fff4}ion-item.date-time-item[_ngcontent-%COMP%]   ion-input[type=date][_ngcontent-%COMP%]::placeholder, ion-item[_ngcontent-%COMP%]:has(ion-input[type=date])   ion-input[type=date][_ngcontent-%COMP%]::placeholder, ion-item[_ngcontent-%COMP%]:has(ion-select)   ion-input[type=date][_ngcontent-%COMP%]::placeholder{color:var(--ion-color-medium);font-weight:400;opacity:.8}ion-item.date-time-item[_ngcontent-%COMP%]   ion-select[_ngcontent-%COMP%], ion-item[_ngcontent-%COMP%]:has(ion-input[type=date])   ion-select[_ngcontent-%COMP%], ion-item[_ngcontent-%COMP%]:has(ion-select)   ion-select[_ngcontent-%COMP%]{border:2px solid var(--ion-color-primary-tint);border-radius:8px;padding:12px 16px;font-size:1.15rem;background:#fff;color:var(--ion-color-dark);font-weight:600;box-shadow:0 2px 8px #28a74512;transition:border-color .2s,box-shadow .2s,background .2s;outline:none;margin-top:6px}ion-item.date-time-item[_ngcontent-%COMP%]   ion-select[_ngcontent-%COMP%]:focus, ion-item[_ngcontent-%COMP%]:has(ion-input[type=date])   ion-select[_ngcontent-%COMP%]:focus, ion-item[_ngcontent-%COMP%]:has(ion-select)   ion-select[_ngcontent-%COMP%]:focus{border-color:var(--ion-color-primary);background:linear-gradient(90deg,#e9f5e1,#fff);box-shadow:0 0 0 3px #28a74526;animation:inputFocusPulse .3s}ion-item.date-time-item[_ngcontent-%COMP%]   ion-select[_ngcontent-%COMP%]:hover, ion-item[_ngcontent-%COMP%]:has(ion-input[type=date])   ion-select[_ngcontent-%COMP%]:hover, ion-item[_ngcontent-%COMP%]:has(ion-select)   ion-select[_ngcontent-%COMP%]:hover{border-color:var(--ion-color-primary-shade);background:#f4fff4}ion-item.date-time-item[_ngcontent-%COMP%]   ion-select[_ngcontent-%COMP%]::placeholder, ion-item[_ngcontent-%COMP%]:has(ion-input[type=date])   ion-select[_ngcontent-%COMP%]::placeholder, ion-item[_ngcontent-%COMP%]:has(ion-select)   ion-select[_ngcontent-%COMP%]::placeholder{color:var(--ion-color-medium);font-weight:400;opacity:.8}ion-item.date-time-item[_ngcontent-%COMP%]   ion-select-option[disabled][_ngcontent-%COMP%], ion-item[_ngcontent-%COMP%]:has(ion-input[type=date])   ion-select-option[disabled][_ngcontent-%COMP%], ion-item[_ngcontent-%COMP%]:has(ion-select)   ion-select-option[disabled][_ngcontent-%COMP%]{color:var(--ion-color-medium);background:#f5f5f5;opacity:.7;cursor:not-allowed}.input-icon-wrapper[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center}.input-icon-wrapper[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%], .input-icon-wrapper[_ngcontent-%COMP%]   ion-select[_ngcontent-%COMP%]{flex:1 1 auto}.input-suffix-icon[_ngcontent-%COMP%]{position:absolute;right:12px;font-size:1.3rem;color:var(--ion-color-primary);pointer-events:none;opacity:.8;z-index:2}']}),c})()}];let ye=(()=>{var o;class c{}return(o=c).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[k.iI.forChild(Ce),k.iI]}),c})();var Pe=M(7383);let be=(()=>{var o;class c{}return(o=c).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[C.MD,I.YN,l.bv,ye,Pe.G]}),c})()}}]);