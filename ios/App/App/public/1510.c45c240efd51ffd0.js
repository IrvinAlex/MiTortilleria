"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1510],{1510:(dr,$e,w)=>{w.r($e),w.d($e,{HorarioPageModule:()=>Bi});var u=w(177),F=w(9417),_=w(5933),Ae=w(8265),$=w(467),s=w(4438),pe=w(7852),mt=w(1362),ge=w(8041),R=w(1076);class V{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}V.UNAUTHENTICATED=new V(null),V.GOOGLE_CREDENTIALS=new V("google-credentials-uid"),V.FIRST_PARTY=new V("first-party-uid"),V.MOCK_USER=new V("mock-user");let D="10.14.0";const A=new ge.Vy("@firebase/firestore");function ft(n){if("string"==typeof n)return n;try{return JSON.stringify(n)}catch{return n}}function v(n="Unexpected state"){const e=`FIRESTORE (${D}) INTERNAL ASSERTION FAILED: `+n;throw function P(n,...e){if(A.logLevel<=ge.$b.ERROR){const t=e.map(ft);A.error(`Firestore (${D}): ${n}`,...t)}}(e),new Error(e)}function q(n,e){n||v()}const f="invalid-argument",X="failed-precondition";class m extends R.g{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class an{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class fr{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(V.UNAUTHENTICATED))}shutdown(){}}class gr{constructor(e){this.auth=null,e.onInit(t=>{this.auth=t})}getToken(){return this.auth?this.auth.getToken().then(e=>e?(q("string"==typeof e.accessToken),new an(e.accessToken,new V(this.auth.getUid()))):null):Promise.resolve(null)}invalidateToken(){}start(e,t){}shutdown(){}}class _r{constructor(e,t,r){this.t=e,this.i=t,this.o=r,this.type="FirstParty",this.user=V.FIRST_PARTY,this.u=new Map}l(){return this.o?this.o():null}get headers(){this.u.set("X-Goog-AuthUser",this.t);const e=this.l();return e&&this.u.set("Authorization",e),this.i&&this.u.set("X-Goog-Iam-Authorization-Token",this.i),this.u}}class yr{constructor(e,t,r){this.t=e,this.i=t,this.o=r}getToken(){return Promise.resolve(new _r(this.t,this.i,this.o))}start(e,t){e.enqueueRetryable(()=>t(V.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class vr{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class wr{constructor(e){this.h=e,this.appCheck=null,e.onInit(t=>{this.appCheck=t})}getToken(){return this.appCheck?this.appCheck.getToken().then(e=>e?(q("string"==typeof e.token),new vr(e.token)):null):Promise.resolve(null)}invalidateToken(){}start(e,t){}shutdown(){}}class Pe{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Pe("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof Pe&&e.projectId===this.projectId&&e.database===this.database}}class Ie{constructor(e,t,r){void 0===t?t=0:t>e.length&&v(),void 0===r?r=e.length-t:r>e.length-t&&v(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return 0===Ie.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ie?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const o=e.get(i),a=t.get(i);if(o<a)return-1;if(o>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class b extends Ie{construct(e,t,r){return new b(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new m(f,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new b(t)}static emptyPath(){return new b([])}}const Er=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class H extends Ie{construct(e,t,r){return new H(e,t,r)}static isValidIdentifier(e){return Er.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),H.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new H(["__name__"])}static fromServerFormat(e){const t=[];let r="",i=0;const o=()=>{if(0===r.length)throw new m(f,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let a=!1;for(;i<e.length;){const l=e[i];if("\\"===l){if(i+1===e.length)throw new m(f,"Path has trailing escape character: "+e);const c=e[i+1];if("\\"!==c&&"."!==c&&"`"!==c)throw new m(f,"Path has invalid escape sequence: "+e);r+=c,i+=2}else"`"===l?(a=!a,i++):"."!==l||a?(r+=l,i++):(o(),i++)}if(o(),a)throw new m(f,"Unterminated ` in path: "+e);return new H(t)}static emptyPath(){return new H([])}}class k{constructor(e){this.path=e}static fromPath(e){return new k(b.fromString(e))}static fromName(e){return new k(b.fromString(e).popFirst(5))}static empty(){return new k(b.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===b.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return b.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new k(new b(e.slice()))}}function He(n){if(void 0===n)return"undefined";if(null===n)return"null";if("string"==typeof n)return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if("number"==typeof n||"boolean"==typeof n)return""+n;if("object"==typeof n){if(n instanceof Array)return"an array";{const e=(r=n).constructor?r.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var r;return"function"==typeof n?"a function":v()}function Be(n){return 0===n&&1/n==-1/0}var mn,y;function O(n,e){return n<e?-1:n>e?1:0}function pn(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}(y=mn||(mn={}))[y.OK=0]="OK",y[y.CANCELLED=1]="CANCELLED",y[y.UNKNOWN=2]="UNKNOWN",y[y.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",y[y.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",y[y.NOT_FOUND=5]="NOT_FOUND",y[y.ALREADY_EXISTS=6]="ALREADY_EXISTS",y[y.PERMISSION_DENIED=7]="PERMISSION_DENIED",y[y.UNAUTHENTICATED=16]="UNAUTHENTICATED",y[y.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",y[y.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",y[y.ABORTED=10]="ABORTED",y[y.OUT_OF_RANGE=11]="OUT_OF_RANGE",y[y.UNIMPLEMENTED=12]="UNIMPLEMENTED",y[y.INTERNAL=13]="INTERNAL",y[y.UNAVAILABLE=14]="UNAVAILABLE",y[y.DATA_LOSS=15]="DATA_LOSS";class Fr extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class J{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new Fr("Invalid base64 string: "+o):o}}(e);return new J(t)}static fromUint8Array(e){const t=function(i){let o="";for(let a=0;a<i.length;++a)o+=String.fromCharCode(i[a]);return o}(e);return new J(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return O(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}J.EMPTY_BYTE_STRING=new J("");const Cr=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ie(n){if(q(!!n),"string"==typeof n){let e=0;const t=Cr.exec(n);if(q(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:M(n.seconds),nanos:M(n.nanos)}}function M(n){return"number"==typeof n?n:"string"==typeof n?Number(n):0}function Re(n){return"string"==typeof n?J.fromBase64String(n):J.fromUint8Array(n)}class U{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new m(f,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new m(f,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new m(f,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new m(f,"Timestamp seconds out of range: "+e)}static now(){return U.fromMillis(Date.now())}static fromDate(e){return U.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new U(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?O(this.nanoseconds,e.nanoseconds):O(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}function Ve(n){const e=ie(n.mapValue.fields.__local_write_time__.timestampValue);return new U(e.seconds,e.nanos)}const Ge={fields:{__type__:{stringValue:"__max__"}}};function oe(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?function Et(n){var e,t;return"server_timestamp"===(null===(t=((null===(e=null==n?void 0:n.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}(n)?4:"__max__"===(((n.mapValue||{}).fields||{}).__type__||{}).stringValue?9007199254740991:"__vector__"===(null===(i=((null===(r=null==(t=n)?void 0:t.mapValue)||void 0===r?void 0:r.fields)||{}).__type__)||void 0===i?void 0:i.stringValue)?10:11:v();var t,r,i}function ye(n,e){if(n===e)return!0;const t=oe(n);if(t!==oe(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Ve(n).isEqual(Ve(e));case 3:return function(i,o){if("string"==typeof i.timestampValue&&"string"==typeof o.timestampValue&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;const a=ie(i.timestampValue),l=ie(o.timestampValue);return a.seconds===l.seconds&&a.nanos===l.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return o=e,Re(n.bytesValue).isEqual(Re(o.bytesValue));case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,o){return M(i.geoPointValue.latitude)===M(o.geoPointValue.latitude)&&M(i.geoPointValue.longitude)===M(o.geoPointValue.longitude)}(n,e);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return M(i.integerValue)===M(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){const a=M(i.doubleValue),l=M(o.doubleValue);return a===l?Be(a)===Be(l):isNaN(a)&&isNaN(l)}return!1}(n,e);case 9:return function Tt(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}(n.arrayValue.values||[],e.arrayValue.values||[],ye);case 10:case 11:return function(i,o){const a=i.mapValue.fields||{},l=o.mapValue.fields||{};if(pn(a)!==pn(l))return!1;for(const c in a)if(a.hasOwnProperty(c)&&(void 0===l[c]||!ye(a[c],l[c])))return!1;return!0}(n,e);default:return v()}var o}function Fe(n,e){return void 0!==(n.values||[]).find(t=>ye(t,e))}function ze(n,e){if(n===e)return 0;const t=oe(n),r=oe(e);if(t!==r)return O(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return O(n.booleanValue,e.booleanValue);case 2:return function(o,a){const l=M(o.integerValue||o.doubleValue),c=M(a.integerValue||a.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(n,e);case 3:return _n(n.timestampValue,e.timestampValue);case 4:return _n(Ve(n),Ve(e));case 5:return O(n.stringValue,e.stringValue);case 6:return function(o,a){const l=Re(o),c=Re(a);return l.compareTo(c)}(n.bytesValue,e.bytesValue);case 7:return function(o,a){const l=o.split("/"),c=a.split("/");for(let d=0;d<l.length&&d<c.length;d++){const h=O(l[d],c[d]);if(0!==h)return h}return O(l.length,c.length)}(n.referenceValue,e.referenceValue);case 8:return function(o,a){const l=O(M(o.latitude),M(a.latitude));return 0!==l?l:O(M(o.longitude),M(a.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return yn(n.arrayValue,e.arrayValue);case 10:return function(o,a){var l,c,d,h;const T=null===(l=(o.fields||{}).value)||void 0===l?void 0:l.arrayValue,I=null===(c=(a.fields||{}).value)||void 0===c?void 0:c.arrayValue,N=O((null===(d=null==T?void 0:T.values)||void 0===d?void 0:d.length)||0,(null===(h=null==I?void 0:I.values)||void 0===h?void 0:h.length)||0);return 0!==N?N:yn(T,I)}(n.mapValue,e.mapValue);case 11:return function(o,a){if(o===Ge&&a===Ge)return 0;if(o===Ge)return 1;if(a===Ge)return-1;const l=o.fields||{},c=Object.keys(l),d=a.fields||{},h=Object.keys(d);c.sort(),h.sort();for(let p=0;p<c.length&&p<h.length;++p){const g=O(c[p],h[p]);if(0!==g)return g;const T=ze(l[c[p]],d[h[p]]);if(0!==T)return T}return O(c.length,h.length)}(n.mapValue,e.mapValue);default:throw v()}}function _n(n,e){if("string"==typeof n&&"string"==typeof e&&n.length===e.length)return O(n,e);const t=ie(n),r=ie(e),i=O(t.seconds,r.seconds);return 0!==i?i:O(t.nanos,r.nanos)}function yn(n,e){const t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){const o=ze(t[i],r[i]);if(o)return o}return O(t.length,r.length)}function Qe(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function vn(n){return!!n&&"arrayValue"in n}class An{}class B extends An{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,r):new kr(e,t,r):"array-contains"===t?new Dr(e,r):"in"===t?new Or(e,r):"not-in"===t?new xr(e,r):"array-contains-any"===t?new Nr(e,r):new B(e,t,r)}static createKeyFieldInFilter(e,t,r){return"in"===t?new Mr(e,r):new Sr(e,r)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(ze(t,this.value)):null!==t&&oe(this.value)===oe(t)&&this.matchesComparison(ze(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return v()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class kr extends B{constructor(e,t,r){super(e,t,r),this.key=k.fromName(r.referenceValue)}matches(e){const t=k.comparator(e.key,this.key);return this.matchesComparison(t)}}class Mr extends B{constructor(e,t){super(e,"in",t),this.keys=In(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class Sr extends B{constructor(e,t){super(e,"not-in",t),this.keys=In(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function In(n,e){var t;return((null===(t=e.arrayValue)||void 0===t?void 0:t.values)||[]).map(r=>k.fromName(r.referenceValue))}class Dr extends B{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return vn(t)&&Fe(t.arrayValue,this.value)}}class Or extends B{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Fe(this.value.arrayValue,t)}}class xr extends B{constructor(e,t){super(e,"not-in",t)}matches(e){if(Fe(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!Fe(this.value.arrayValue,t)}}class Nr extends B{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!vn(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Fe(this.value.arrayValue,r))}}class L{constructor(e,t,r,i,o){this.key=e,this.value=t,this.color=null!=r?r:L.RED,this.left=null!=i?i:L.EMPTY,this.right=null!=o?o:L.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,o){return new L(null!=e?e:this.key,null!=t?t:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const o=r(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,t,r),null):0===o?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return L.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===t(e,i.key)){if(i.right.isEmpty())return L.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,L.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,L.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw v();const e=this.left.check();if(e!==this.right.check())throw v();return e+(this.isRed()?0:1)}}L.EMPTY=null,L.RED=!0,L.BLACK=!1,L.EMPTY=new class{constructor(){this.size=0}get key(){throw v()}get value(){throw v()}get color(){throw v()}get left(){throw v()}get right(){throw v()}copy(e,t,r,i,o){return this}insert(e,t,r){return new L(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class le{constructor(e,t=null,r=[],i=[],o=null,a="F",l=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=o,this.limitType=a,this.startAt=l,this.endAt=c,this.S=null,this.N=null,this.O=null}}function kn(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Be(e)?"-0":e}}class Br{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Vt(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Gr(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function Ft(n,e){return function Ct(n,e){const t=(i=n,new b(["projects",i.projectId,"databases",i.database])).child("documents");var i;return void 0===e?t:t.child(e)}(n,e).canonicalString()}function Mt(n){return new Br(n,!0)}const Se=new Map;class Gn{constructor(e){var t,r;if(void 0===e.host){if(void 0!==e.ssl)throw new m(f,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new m(f,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(o,a,l,c){if(!0===a&&!0===c)throw new m(f,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")})(0,e.experimentalForceLongPolling,0,e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!(this.experimentalForceLongPolling||void 0!==e.experimentalAutoDetectLongPolling&&!e.experimentalAutoDetectLongPolling),this.experimentalLongPollingOptions=function dn(n){const e={};return void 0!==n.timeoutSeconds&&(e.timeoutSeconds=n.timeoutSeconds),e}(null!==(r=e.experimentalLongPollingOptions)&&void 0!==r?r:{}),function(o){if(void 0!==o.timeoutSeconds){if(isNaN(o.timeoutSeconds))throw new m(f,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new m(f,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new m(f,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.experimentalLongPollingOptions.timeoutSeconds===e.experimentalLongPollingOptions.timeoutSeconds&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class ee{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Gn({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new m(X,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new m(X,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Gn(e),void 0!==e.credentials&&(this._authCredentials=function(r){if(!r)return new fr;switch(r.type){case"firstParty":return new yr(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new m(f,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){var e=this;return(0,$.A)(function*(){"notTerminated"===e._terminateTask?yield e._terminate():e._terminateTask="notTerminated"})()}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=Se.get(t);r&&(function C(n,...e){if(A.logLevel<=ge.$b.DEBUG){const t=e.map(ft);A.debug(`Firestore (${D}): ${n}`,...t)}}("ComponentProvider","Removing Datastore"),Se.delete(t),r.terminate())}(this),Promise.resolve()}}class z{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new z(this.firestore,e,this._query)}}class x{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new K(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new x(this.firestore,e,this._key)}}class K extends z{constructor(e,t,r){super(e,t,new le(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new x(this.firestore,null,new k(e))}withConverter(e){return new K(this.firestore,e,this._path)}}class we{constructor(e){this._byteString=e}static fromBase64String(e){try{return new we(J.fromBase64String(e))}catch(t){throw new m(f,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new we(J.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class ce{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new m(f,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new H(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Oe{constructor(e){this._methodName=e}}class Nt{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new m(f,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new m(f,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return O(this._lat,e._lat)||O(this._long,e._long)}}class nt{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0}(this._values,e._values)}}const oi=/^__.*__$/;function Yn(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw v()}}class rt{constructor(e,t,r,i,o,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,void 0===o&&this.tt(),this.fieldTransforms=o||[],this.fieldMask=a||[]}get path(){return this.settings.path}get et(){return this.settings.et}rt(e){return new rt(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}nt(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.rt({path:r,it:!1});return i.st(e),i}ot(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.rt({path:r,it:!1});return i.tt(),i}ut(e){return this.rt({path:void 0,it:!0})}_t(e){return ot(e,this.settings.methodName,this.settings.ct||!1,this.path,this.settings.lt)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}tt(){if(this.path)for(let e=0;e<this.path.length;e++)this.st(this.path.get(e))}st(e){if(0===e.length)throw this._t("Document fields must not be empty");if(Yn(this.et)&&oi.test(e))throw this._t('Document fields cannot begin and end with "__"')}}class ai{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Mt(e)}ht(e,t,r,i=!1){return new rt({et:e,methodName:t,lt:r,path:H.emptyPath(),it:!1,ct:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function de(n,e){if(Jn(n=(0,R.Ku)(n)))return function Bt(n,e,t){if(!Jn(t)||"object"!=typeof(i=t)||null===i||Object.getPrototypeOf(i)!==Object.prototype&&null!==Object.getPrototypeOf(i)){const r=He(t);throw e._t("an object"===r?n+" a custom object":n+" "+r)}var i}("Unsupported field value:",e,n),function Xn(n,e){const t={};return function(i){for(const o in i)if(Object.prototype.hasOwnProperty.call(i,o))return!1;return!0}(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):function be(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}(n,(r,i)=>{const o=de(i,e.nt(r));null!=o&&(t[r]=o)}),{mapValue:{fields:t}}}(n,e);if(n instanceof Oe)return function(r,i){if(!Yn(i.et))throw i._t(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i._t(`${r._methodName}() is not currently supported inside arrays`);const o=r._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(n,e),null;if(void 0===n&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.it&&4!==e.et)throw e._t("Nested arrays are not supported");return function(r,i){const o=[];let a=0;for(const l of r){let c=de(l,i.ut(a));null==c&&(c={nullValue:"NULL_VALUE"}),o.push(c),a++}return{arrayValue:{values:o}}}(n,e)}return function(r,i){if(null===(r=(0,R.Ku)(r)))return{nullValue:"NULL_VALUE"};if("number"==typeof r)return function Mn(n,e){return"number"==typeof(r=e)&&Number.isInteger(r)&&!Be(r)&&r<=Number.MAX_SAFE_INTEGER&&r>=Number.MIN_SAFE_INTEGER?function(r){return{integerValue:""+r}}(e):kn(n,e);var r}(i.serializer,r);if("boolean"==typeof r)return{booleanValue:r};if("string"==typeof r)return{stringValue:r};if(r instanceof Date){const o=U.fromDate(r);return{timestampValue:Vt(i.serializer,o)}}if(r instanceof U){const o=new U(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Vt(i.serializer,o)}}if(r instanceof Nt)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof we)return{bytesValue:Gr(i.serializer,r._byteString)};if(r instanceof x){const o=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(o))throw i._t(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:Ft(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof nt)return l=i,{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:r.toArray().map(c=>{if("number"!=typeof c)throw l._t("VectorValues must only contain numeric values.");return kn(l.serializer,c)})}}}}};var l;throw i._t(`Unsupported field value: ${He(r)}`)}(n,e)}function Jn(n){return!("object"!=typeof n||null===n||n instanceof Array||n instanceof Date||n instanceof U||n instanceof Nt||n instanceof we||n instanceof x||n instanceof Oe||n instanceof nt)}const li=new RegExp("[~\\*/\\[\\]]");function ot(n,e,t,r,i){const o=r&&!r.isEmpty(),a=void 0!==i;let l=`Function ${e}() called with invalid data`;t&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(o||a)&&(c+=" (found",o&&(c+=` in field ${r}`),a&&(c+=` in document ${i}`),c+=")"),new m(f,l+n+c)}function Qt(n,e){return"string"==typeof e?function Gt(n,e,t){if(e.search(li)>=0)throw ot(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new ce(...e.split("."))._internalPath}catch{throw ot(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}(n,e):e instanceof ce?e._internalPath:e._delegate._internalPath}class Yt{}class Le extends Yt{}class je extends Le{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new je(e,t,r)}_apply(e){const t=this._parse(e);return function ir(n,e){const t=function(i,o){for(const a of i)for(const l of a.getFlattenedFilters())if(o.indexOf(l.op)>=0)return l.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==t)throw new m(f,t===e.op?`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`:`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}(e._query,t),new z(e.firestore,e.converter,function It(n,e){const t=n.filters.concat([e]);return new le(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}(e._query,t))}_parse(e){const t=function ue(n){const e=n._freezeSettings(),t=Mt(n._databaseId);return new ai(n._databaseId,!!e.ignoreUndefinedProperties,t)}(e.firestore);return function(o,a,l,c,d,h,p){let g;if(d.isKeyField()){if("array-contains"===h||"array-contains-any"===h)throw new m(f,`Invalid Query. You can't perform '${h}' queries on documentId().`);if("in"===h||"not-in"===h){rr(p,h);const T=[];for(const I of p)T.push(nr(c,o,I));g={arrayValue:{values:T}}}else g=nr(c,o,p)}else"in"!==h&&"not-in"!==h&&"array-contains-any"!==h||rr(p,h),g=function Wn(n,e,t,r=!1){return de(t,n.ht(r?4:3,e))}(l,"where",p,"in"===h||"not-in"===h);return B.create(d,h,g)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value)}}function ui(n,e,t){const r=e,i=Qt("where",n);return je._create(i,r,t)}function nr(n,e,t){if("string"==typeof(t=(0,R.Ku)(t))){if(""===t)throw new m(f,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!function Vn(n){return null!==n.collectionGroup}(e)&&-1!==t.indexOf("/"))throw new m(f,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(b.fromString(t));if(!k.isDocumentKey(r))throw new m(f,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Qe(n,new k(r))}if(t instanceof x)return Qe(n,t._key);throw new m(f,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${He(t)}.`)}function rr(n,e){if(!Array.isArray(n)||0===n.length)throw new m(f,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}D=`${pe.SDK_VERSION}_lite`,(0,pe._registerComponent)(new mt.uA("firestore/lite",(e,{instanceIdentifier:t,options:r})=>{const i=e.getProvider("app").getImmediate(),o=new ee(new gr(e.getProvider("auth-internal")),new wr(e.getProvider("app-check-internal")),function(l,c){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new m(f,'"projectId" not provided in firebase.initializeApp.');return new Pe(l.options.projectId,c)}(i,t),i);return r&&o._setSettings(r),o},"PUBLIC").setMultipleInstances(!0)),(0,pe.registerVersion)("firestore-lite","4.7.3",""),(0,pe.registerVersion)("firestore-lite","4.7.3","esm2017");var sr=w(8663),ar=w(2723),vi=w(2784),lr=w(3236),wi=w(1985),Ti=w(9470);function cr(n=0,e=lr.E){return n<0&&(n=0),function Ai(n=0,e,t=lr.b){let r=-1;return null!=e&&((0,Ti.m)(e)?t=e:r=e),new wi.c(i=>{let o=function Ei(n){return n instanceof Date&&!isNaN(n)}(n)?+n-t.now():n;o<0&&(o=0);let a=0;return t.schedule(function(){i.closed||(i.next(a++),0<=r?this.schedule(void 0,r):i.complete())},o)})}(n,n,e)}var ur=w(8461);const Pi=["sliderButton"];function Ii(n,e){if(1&n){const t=s.RV6();s.j41(0,"div",33)(1,"div",34),s.nrm(2,"ion-icon",35),s.j41(3,"h2"),s.EFF(4,"Asignaci\xf3n autom\xe1tica en:"),s.k0s(),s.j41(5,"div",36),s.EFF(6),s.k0s(),s.j41(7,"div",37)(8,"p")(9,"strong"),s.EFF(10,"Se asignar\xe1:"),s.k0s(),s.EFF(11),s.k0s(),s.j41(12,"p")(13,"strong"),s.EFF(14,"Tiempo:"),s.k0s(),s.EFF(15),s.k0s()(),s.nrm(16,"ion-progress-bar",38),s.j41(17,"p",39),s.EFF(18," Se asignar\xe1 autom\xe1ticamente seg\xfan la demanda actual "),s.k0s()(),s.j41(19,"ion-button",40),s.bIt("click",function(){s.eBV(t);const i=s.XpG();return s.Njj(i.cancelCountdown())}),s.nrm(20,"ion-icon",41),s.EFF(21," CANCELAR ASIGNACI\xd3N "),s.k0s()()}if(2&n){const t=s.XpG();s.R7$(),s.HbH("countdown-"+(null==t.currentDemandLevel?null:t.currentDemandLevel.level)),s.R7$(5),s.JRh(t.countdown),s.R7$(5),s.SpI(" ",t.getDemandDescription(),""),s.R7$(4),s.SpI(" ",t.estimatedTime,""),s.R7$(),s.Y8G("value",t.getProgressPercentage()/100)("color",null==t.currentDemandLevel?null:t.currentDemandLevel.color)}}function bi(n,e){if(1&n){const t=s.RV6();s.j41(0,"ion-button",42),s.bIt("click",function(){s.eBV(t);const i=s.XpG();return s.Njj(i.restartCountdown())}),s.nrm(1,"ion-icon",43),s.EFF(2," REINICIAR ASIGNACI\xd3N AUTOM\xc1TICA "),s.k0s()}}function Ri(n,e){1&n&&(s.j41(0,"ion-button",44),s.nrm(1,"ion-spinner",45),s.EFF(2," Asignando... "),s.k0s())}function Vi(n,e){if(1&n){const t=s.RV6();s.j41(0,"div",46)(1,"ion-label"),s.EFF(2,"Desliza para asignar manualmente"),s.k0s(),s.j41(3,"ion-range",47),s.mxI("ngModelChange",function(i){s.eBV(t);const o=s.XpG();return s.DH7(o.sliderValue,i)||(o.sliderValue=i),s.Njj(i)}),s.bIt("ionChange",function(){s.eBV(t);const i=s.XpG();return s.Njj(i.onSliderChange())}),s.nrm(4,"ion-icon",48)(5,"ion-icon",49),s.k0s()()}if(2&n){const t=s.XpG();s.R7$(3),s.R50("ngModel",t.sliderValue)}}function Fi(n,e){1&n&&(s.j41(0,"div",50),s.nrm(1,"ion-icon",51),s.j41(2,"p"),s.EFF(3,"Pedido en espera de recolecci\xf3n"),s.k0s()())}let Ci=(()=>{var n;class e{constructor(){this.fechaHoraRecoleccion="",this.fechaMinima="",this.currentTime=new Date,this.estimatedTime="1-3 min",this.autoAssignedTime="",this.countdown=5,this.isCountdownActive=!1,this.isAssigned=!1,this.firebaseSvc=(0,s.WQX)(sr.f),this.utilSvc=(0,s.WQX)(ar.T),this.demandLevels={baja:{level:"baja",minTime:1,maxTime:3,color:"success",description:"\xa1S\xfaper r\xe1pido!"},normal:{level:"normal",minTime:2,maxTime:4,color:"success",description:"Entrega express"},moderada:{level:"moderada",minTime:3,maxTime:5,color:"primary",description:"Preparando tu pedido"},media:{level:"media",minTime:4,maxTime:6,color:"primary",description:"Flujo activo"},alta:{level:"alta",minTime:6,maxTime:8,color:"warning",description:"Hora pico"},mediaalta:{level:"mediaalta",minTime:8,maxTime:10,color:"warning",description:"Muy ocupados"},irregular:{level:"irregular",minTime:10,maxTime:15,color:"danger",description:"Demanda impredecible"}},this.sliderValue=0,this.showAnimation=!1}ngOnInit(){this.setFechaMinima(),this.fechaHoraRecoleccion||(this.fechaHoraRecoleccion=""),this.initializeTimeSystem(),this.startAutoAssignment()}ngOnDestroy(){this.timeSubscription&&this.timeSubscription.unsubscribe(),this.countdownSubscription&&this.countdownSubscription.unsubscribe()}setFechaMinima(){this.fechaMinima=(new Date).toISOString()}initializeTimeSystem(){this.timeSubscription=cr(6e4).subscribe(()=>{this.currentTime=new Date,this.updateDemandLevel(),this.updateAutoAssignedTime()}),this.updateDemandLevel(),this.updateAutoAssignedTime()}updateDemandLevel(){const o=this.currentTime.getHours()+this.currentTime.getMinutes()/60;let a;a=o>=6&&o<7?"media":o>=7&&o<8.5?"alta":o>=8.5&&o<10.5?"moderada":o>=10.5&&o<11.5?"normal":o>=11.5&&o<14?"mediaalta":o>=14&&o<16.5?"baja":o>=16.5&&o<17.5?"moderada":o>=17.5&&o<19?"alta":o>=19&&o<20?"irregular":"baja",this.currentDemandLevel=this.demandLevels[a],this.estimatedTime=`${this.currentDemandLevel.minTime}-${this.currentDemandLevel.maxTime} min`}updateAutoAssignedTime(){if(this.currentDemandLevel){const i=new Date((new Date).getTime()+6e4*this.currentDemandLevel.maxTime),o=i.getHours(),a=i.getMinutes(),l=o>=12?"p.m.":"a.m.";this.autoAssignedTime=`${o%12||12}:${a.toString().padStart(2,"0")} ${l}`}}getDemandMessage(){const r=this.currentTime.getHours();return r>=6&&r<7?"Primeros pedidos \u{1f305}":r>=7&&r<8.5?"Hora pico: Desayuno \u{1f373}":r>=8.5&&r<10.5?"Flujo constante \u26a1":r>=10.5&&r<11.5?"Flujo estable \u{1f4c8}":r>=11.5&&r<14?"Hora pico: Comida \u{1f37d}\ufe0f":r>=14&&r<16.5?"Flujo tranquilo \u{1f60c}":r>=16.5&&r<17.5?"Preparativos vespertinos \u{1f306}":r>=17.5&&r<19?"Hora pico: Cena \u{1f319}":r>=19&&r<20?"Pedidos urgentes \u26a0\ufe0f":"Fuera de horario \u{1f512}"}isPeakHour(){return this.currentDemandLevel&&("alta"===this.currentDemandLevel.level||"mediaalta"===this.currentDemandLevel.level||"irregular"===this.currentDemandLevel.level)}formatCurrentTime(){const r=this.currentTime.getHours(),o=r>=12?"p.m.":"a.m.";return`${r%12||12}:${this.currentTime.getMinutes().toString().padStart(2,"0")} ${o}`}hasValidAssignedTime(){return!(!(this.fechaHoraRecoleccion&&this.fechaHoraRecoleccion.length>0)||isNaN(new Date(this.fechaHoraRecoleccion).getTime()))}formatAssignedTime(){if(this.fechaHoraRecoleccion&&this.fechaHoraRecoleccion.length>0)try{const r=new Date(this.fechaHoraRecoleccion);if(isNaN(r.getTime()))return this.autoAssignedTime||"No asignada";const i=r.getHours(),o=r.getMinutes(),a=i>=12?"p.m.":"a.m.";return`${i%12||12}:${o.toString().padStart(2,"0")} ${a}`}catch{return this.autoAssignedTime||"No asignada"}return this.autoAssignedTime||"Calculando..."}getDemandDescription(){var r;return(null===(r=this.currentDemandLevel)||void 0===r?void 0:r.description)||"Calculando..."}onDateTimeChange(){console.log("Fecha/hora cambiada:",this.fechaHoraRecoleccion),console.log("Hora asignada v\xe1lida:",this.hasValidAssignedTime()),console.log("Hora formateada:",this.formatAssignedTime())}startAutoAssignment(){this.isCountdownActive=!0,this.countdown=5,this.countdownSubscription=cr(1e3).subscribe(()=>{this.isCountdownActive&&this.countdown>0?this.countdown--:this.isCountdownActive&&0===this.countdown&&this.performAutoAssignment()})}performAutoAssignment(){var r=this;return(0,$.A)(function*(){r.isCountdownActive=!1;const o=r.currentDemandLevel.maxTime,a=new Date((new Date).getTime()+6e4*o);r.fechaHoraRecoleccion=a.toISOString(),yield r.executeAssignment()})()}executeAssignment(){var r=this;return(0,$.A)(function*(){const i=yield r.utilSvc.loading();yield i.present(),r.isAssigned=!0,r.showAnimation=!0;let o=`pedidos/${r.pedido.id}`;const a=new Date(r.fechaHoraRecoleccion),l=vi.Dc.fromDate(a);r.firebaseSvc.updateDocumet(o,{estatus:"En espera de recolecci\xf3n",fecha_recoger:l}).then(function(){var c=(0,$.A)(function*(d){setTimeout(()=>{r.showAnimation=!1,r.isAssigned=!1,r.pedido.estatus="En espera de recolecci\xf3n",r.utilSvc.dismissModal({success:!0})},3e3)});return function(d){return c.apply(this,arguments)}}()).catch(c=>{r.utilSvc.presentToast({message:c.message,duration:2500,color:"primary",position:"middle",icon:"alert-circle-outline"}),r.isAssigned=!1,r.showAnimation=!1}).finally(()=>{i.dismiss()})})()}restartCountdown(){this.isCountdownActive=!0,this.countdown=5,this.startAutoAssignment()}cancelCountdown(){this.isCountdownActive=!1,this.countdown=5,this.countdownSubscription&&this.countdownSubscription.unsubscribe()}getProgressPercentage(){return(5-this.countdown)/5*100}validarFechaHora(){return!(!this.fechaHoraRecoleccion||new Date(this.fechaHoraRecoleccion)<new Date)}onSliderChange(){var r=this;return(0,$.A)(function*(){if(100===r.sliderValue)if(r.fechaHoraRecoleccion){if(!r.validarFechaHora())return r.sliderValue=0,void r.utilSvc.presentToast({message:"No se puede seleccionar una fecha y hora anterior a la actual",duration:3e3,color:"danger",position:"bottom",icon:"alert-circle-outline"});yield r.executeAssignment()}else r.sliderValue=0,r.utilSvc.presentToast({message:"Por favor, selecciona una fecha y hora",duration:2500,color:"danger",position:"bottom",icon:"refresh-circle-outline"})})()}}return(n=e).\u0275fac=function(r){return new(r||n)},n.\u0275cmp=s.VBU({type:n,selectors:[["app-assign-horary"]],viewQuery:function(r,i){if(1&r&&s.GBs(Pi,5),2&r){let o;s.mGM(o=s.lsd())&&(i.sliderButton=o.first)}},inputs:{pedido:"pedido"},decls:87,vars:33,consts:[["title","Detalles del pedido",3,"isModal","showNombre","showLogo"],[1,"status-bar"],[1,"status-info"],[3,"name","color"],[1,"demand-info"],[1,"demand-subtitle"],[1,"time-info"],["name","time","color","medium"],[1,"current-time"],[1,"demand-info-card"],[1,"demand-display"],[1,"demand-icon"],[1,"demand-text"],["display-format","YYYY-MM-DD HH:mm","picker-format","YYYY-MM-DD HH:mm","placeholder","Selecciona fecha y hora",3,"ngModelChange","ionChange","ngModel","min"],[1,"time-assignment-card"],[1,"time-row"],[1,"time-label"],[1,"time-value","success"],[1,"time-value","primary"],[1,"auto-assignment-section"],["class","countdown-container",4,"ngIf"],["expand","block","color","tertiary","class","restart-button",3,"click",4,"ngIf"],["expand","block","color","medium","disabled","true","class","assigning-button",4,"ngIf"],[1,"system-info-card"],["name","information-circle","color","primary"],[1,"info-text"],[1,"status-info-card"],["lines","none"],["slot","end"],["slot","end",3,"color"],["slot","end","color","primary"],["class","assign-slider-container",4,"ngIf"],["class","success-animation",4,"ngIf"],[1,"countdown-container"],[1,"countdown-display"],["name","timer",1,"countdown-icon"],[1,"countdown-number"],[1,"auto-assignment-info"],[1,"countdown-progress",3,"value","color"],[1,"countdown-text"],["expand","block","color","danger",1,"cancel-button",3,"click"],["name","close","slot","start"],["expand","block","color","tertiary",1,"restart-button",3,"click"],["name","calendar","slot","start"],["expand","block","color","medium","disabled","true",1,"assigning-button"],["name","crescent","slot","start"],[1,"assign-slider-container"],["min","0","max","100","step","1","pin","false","color","primary",1,"assign-slider",3,"ngModelChange","ionChange","ngModel"],["slot","start","name","arrow-forward","color","primary"],["slot","end","name","checkmark-circle","color","primary"],[1,"success-animation"],["name","checkmark-circle","color","primary"]],template:function(r,i){1&r&&(s.nrm(0,"app-header",0),s.j41(1,"ion-content")(2,"ion-card")(3,"ion-card-content",1)(4,"div",2),s.nrm(5,"ion-icon",3),s.j41(6,"div",4)(7,"span"),s.EFF(8),s.k0s(),s.j41(9,"div",5),s.EFF(10),s.k0s()()(),s.j41(11,"div",6),s.nrm(12,"ion-icon",7),s.j41(13,"span",8),s.EFF(14),s.k0s()()()(),s.j41(15,"ion-card",9)(16,"ion-card-content")(17,"div",10)(18,"div",11),s.nrm(19,"ion-icon",3),s.k0s(),s.j41(20,"div",12)(21,"h3"),s.EFF(22),s.k0s(),s.j41(23,"p"),s.EFF(24,"Tiempo estimado: "),s.j41(25,"strong"),s.EFF(26),s.k0s()()()()()(),s.j41(27,"ion-card")(28,"ion-card-header")(29,"ion-card-title"),s.EFF(30,"Asignar Horario de Recolecci\xf3n"),s.k0s()(),s.j41(31,"ion-card-content")(32,"ion-item")(33,"ion-label"),s.EFF(34,"Fecha y Hora de Recolecci\xf3n"),s.k0s(),s.j41(35,"ion-datetime",13),s.mxI("ngModelChange",function(a){return s.DH7(i.fechaHoraRecoleccion,a)||(i.fechaHoraRecoleccion=a),a}),s.bIt("ionChange",function(){return i.onDateTimeChange()}),s.k0s()(),s.j41(36,"ion-card",14)(37,"ion-card-content")(38,"div",15)(39,"span",16),s.EFF(40,"Tiempo estimado"),s.k0s(),s.j41(41,"span",17),s.EFF(42),s.k0s()(),s.j41(43,"div",15)(44,"span",16),s.EFF(45,"Hora asignada"),s.k0s(),s.j41(46,"span",18),s.EFF(47),s.k0s()()()(),s.j41(48,"div",19),s.DNE(49,Ii,22,7,"div",20)(50,bi,3,0,"ion-button",21)(51,Ri,3,0,"ion-button",22),s.k0s(),s.j41(52,"ion-card",23)(53,"ion-card-header")(54,"ion-card-subtitle"),s.nrm(55,"ion-icon",24),s.EFF(56," Sistema Inteligente de Asignaci\xf3n "),s.k0s()(),s.j41(57,"ion-card-content")(58,"p",25),s.EFF(59," El sistema ajusta autom\xe1ticamente los tiempos seg\xfan la demanda actual. "),s.k0s()()(),s.j41(60,"ion-card",26)(61,"ion-card-header")(62,"ion-card-subtitle"),s.EFF(63,"Estado Actual del Sistema"),s.k0s()(),s.j41(64,"ion-card-content")(65,"ion-item",27)(66,"ion-label"),s.EFF(67,"Hora actual:"),s.k0s(),s.j41(68,"ion-note",28),s.EFF(69),s.k0s()(),s.j41(70,"ion-item",27)(71,"ion-label"),s.EFF(72,"Nivel de demanda:"),s.k0s(),s.j41(73,"ion-note",29),s.EFF(74),s.k0s()(),s.j41(75,"ion-item",27)(76,"ion-label"),s.EFF(77,"Tiempo estimado actual:"),s.k0s(),s.j41(78,"ion-note",29),s.EFF(79),s.k0s()(),s.j41(80,"ion-item",27)(81,"ion-label"),s.EFF(82,"Hora asignada:"),s.k0s(),s.j41(83,"ion-note",30),s.EFF(84),s.k0s()()()(),s.DNE(85,Vi,6,1,"div",31)(86,Fi,4,0,"div",32),s.k0s()()()),2&r&&(s.Y8G("isModal",!0)("showNombre",!1)("showLogo",!1),s.R7$(2),s.HbH(i.isPeakHour()?"peak-hour-card":"normal-hour-card"),s.R7$(3),s.Y8G("name","irregular"===(null==i.currentDemandLevel?null:i.currentDemandLevel.level)?"warning":"alta"===(null==i.currentDemandLevel?null:i.currentDemandLevel.level)||"mediaalta"===(null==i.currentDemandLevel?null:i.currentDemandLevel.level)?"flame":"checkmark-circle")("color",null==i.currentDemandLevel?null:i.currentDemandLevel.color),s.R7$(2),s.HbH("demand-level-"+(null==i.currentDemandLevel?null:i.currentDemandLevel.level)),s.R7$(),s.SpI(" ",i.getDemandMessage()," "),s.R7$(2),s.SpI(" Nivel: ",(null==i.currentDemandLevel||null==i.currentDemandLevel.level?null:i.currentDemandLevel.level.toUpperCase())||"CALCULANDO"," "),s.R7$(4),s.JRh(i.formatCurrentTime()),s.R7$(),s.HbH("demand-"+(null==i.currentDemandLevel?null:i.currentDemandLevel.level)),s.R7$(4),s.Y8G("name","baja"===(null==i.currentDemandLevel?null:i.currentDemandLevel.level)?"flash":"normal"===(null==i.currentDemandLevel?null:i.currentDemandLevel.level)?"speedometer":"moderada"===(null==i.currentDemandLevel?null:i.currentDemandLevel.level)?"trending-up":"media"===(null==i.currentDemandLevel?null:i.currentDemandLevel.level)?"pulse":"alta"===(null==i.currentDemandLevel?null:i.currentDemandLevel.level)?"flame":"mediaalta"===(null==i.currentDemandLevel?null:i.currentDemandLevel.level)?"warning":"alert-circle")("color",null==i.currentDemandLevel?null:i.currentDemandLevel.color),s.R7$(3),s.JRh(i.getDemandDescription()),s.R7$(4),s.JRh(i.estimatedTime),s.R7$(9),s.R50("ngModel",i.fechaHoraRecoleccion),s.Y8G("min",i.fechaMinima),s.R7$(7),s.JRh(i.estimatedTime),s.R7$(5),s.JRh(i.formatAssignedTime()),s.R7$(2),s.Y8G("ngIf",i.isCountdownActive),s.R7$(),s.Y8G("ngIf",!i.isCountdownActive&&!i.isAssigned),s.R7$(),s.Y8G("ngIf",i.isAssigned),s.R7$(18),s.JRh(i.formatCurrentTime()),s.R7$(4),s.Y8G("color",null==i.currentDemandLevel?null:i.currentDemandLevel.color),s.R7$(),s.SpI(" ",(null==i.currentDemandLevel||null==i.currentDemandLevel.level?null:i.currentDemandLevel.level.toUpperCase())||"CALCULANDO"," "),s.R7$(4),s.Y8G("color",null==i.currentDemandLevel?null:i.currentDemandLevel.color),s.R7$(),s.SpI(" ",i.estimatedTime," "),s.R7$(5),s.SpI(" ",i.formatAssignedTime()," "),s.R7$(),s.Y8G("ngIf","en preparaci\xf3n"===i.pedido.estatus.toLowerCase()&&!i.isCountdownActive),s.R7$(),s.Y8G("ngIf",i.showAnimation))},dependencies:[u.bT,_.Jm,_.b_,_.I9,_.ME,_.HW,_.tN,_.W9,_.A9,_.iq,_.uz,_.he,_.JI,_.FH,_.Ob,_.w2,_.Je,_.Gw,F.BC,F.vS,ur.l],styles:[".assign-slider-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding-top:50px;text-align:center}.assign-slider[_ngcontent-%COMP%]{width:80%;--knob-size: 36px;--bar-height: 24px;--knob-background: var(--ion-color-primary);--bar-background-active: var(--ion-color-primary);--bar-background: #ddd;--bar-border-radius: 50px}.success-animation[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;margin-top:20px;animation:_ngcontent-%COMP%_fadeInScale .5s ease forwards}.success-animation[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:50px;color:var(--ion-color-primary);animation:_ngcontent-%COMP%_scaleUp .5s ease forwards}.success-animation[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;color:var(--ion-color-primary);margin-top:8px}.time-assignment-card[_ngcontent-%COMP%]{--background: #ffffff;border-radius:12px;box-shadow:0 2px 8px #0000001a;margin:16px 0}.time-assignment-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]{padding:20px}.time-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:12px 0;border-bottom:1px solid #f0f0f0}.time-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.time-label[_ngcontent-%COMP%]{font-size:16px;color:#666;font-weight:500}.time-value[_ngcontent-%COMP%]{font-size:16px;font-weight:600}.time-value.success[_ngcontent-%COMP%]{color:var(--ion-color-success)}.time-value.primary[_ngcontent-%COMP%]{color:var(--ion-color-primary)}.time-value.warning[_ngcontent-%COMP%]{color:var(--ion-color-warning)}.time-value.danger[_ngcontent-%COMP%]{color:var(--ion-color-danger)}.status-bar[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:12px 16px}.status-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.demand-info[_ngcontent-%COMP%]{display:flex;flex-direction:column}.demand-info[_ngcontent-%COMP%]   .demand-subtitle[_ngcontent-%COMP%]{font-size:.8rem;color:var(--ion-color-medium);margin-top:2px}.time-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px}.current-time[_ngcontent-%COMP%]{font-size:.9rem;color:var(--ion-color-medium)}.demand-level-baja[_ngcontent-%COMP%], .demand-level-normal[_ngcontent-%COMP%]{color:var(--ion-color-success);font-weight:600}.demand-level-moderada[_ngcontent-%COMP%], .demand-level-media[_ngcontent-%COMP%]{color:var(--ion-color-primary);font-weight:600}.demand-level-alta[_ngcontent-%COMP%], .demand-level-mediaalta[_ngcontent-%COMP%]{color:var(--ion-color-warning);font-weight:600}.demand-level-irregular[_ngcontent-%COMP%]{color:var(--ion-color-danger);font-weight:600}.peak-hour-card[_ngcontent-%COMP%]{--background: rgba(255, 193, 7, .1);border-left:4px solid var(--ion-color-warning)}.normal-hour-card[_ngcontent-%COMP%]{--background: rgba(40, 167, 69, .1);border-left:4px solid var(--ion-color-success)}.demand-info-card[_ngcontent-%COMP%]{margin-top:16px}.demand-info-card.demand-baja[_ngcontent-%COMP%], .demand-info-card.demand-normal[_ngcontent-%COMP%]{--background: rgba(40, 167, 69, .05);border-left:4px solid var(--ion-color-success)}.demand-info-card.demand-moderada[_ngcontent-%COMP%], .demand-info-card.demand-media[_ngcontent-%COMP%]{--background: rgba(52, 144, 220, .05);border-left:4px solid var(--ion-color-primary)}.demand-info-card.demand-alta[_ngcontent-%COMP%], .demand-info-card.demand-mediaalta[_ngcontent-%COMP%]{--background: rgba(255, 193, 7, .05);border-left:4px solid var(--ion-color-warning)}.demand-info-card.demand-irregular[_ngcontent-%COMP%]{--background: rgba(245, 61, 61, .05);border-left:4px solid var(--ion-color-danger)}.demand-display[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px}.demand-display[_ngcontent-%COMP%]   .demand-icon[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:2rem}.demand-display[_ngcontent-%COMP%]   .demand-text[_ngcontent-%COMP%]{flex:1}.demand-display[_ngcontent-%COMP%]   .demand-text[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 4px;font-size:1.2rem;font-weight:600}.demand-display[_ngcontent-%COMP%]   .demand-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:var(--ion-color-medium)}.auto-assignment-section[_ngcontent-%COMP%]{margin-top:24px;padding:16px 0}.countdown-container[_ngcontent-%COMP%]{margin-bottom:20px}.countdown-display[_ngcontent-%COMP%]{background:linear-gradient(135deg,#ffc1071a,#ff57331a);border:2px solid var(--ion-color-warning);border-radius:12px;padding:24px;text-align:center;margin-bottom:16px;position:relative;overflow:hidden}.countdown-display.countdown-baja[_ngcontent-%COMP%], .countdown-display.countdown-normal[_ngcontent-%COMP%]{background:linear-gradient(135deg,#28a7451a,#28a7450d);border-color:var(--ion-color-success)}.countdown-display.countdown-moderada[_ngcontent-%COMP%], .countdown-display.countdown-media[_ngcontent-%COMP%]{background:linear-gradient(135deg,#3490dc1a,#3490dc0d);border-color:var(--ion-color-primary)}.countdown-display.countdown-alta[_ngcontent-%COMP%], .countdown-display.countdown-mediaalta[_ngcontent-%COMP%]{background:linear-gradient(135deg,#ffc1071a,#ffc1070d);border-color:var(--ion-color-warning)}.countdown-display.countdown-irregular[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f53d3d1a,#f53d3d0d);border-color:var(--ion-color-danger)}.countdown-icon[_ngcontent-%COMP%]{font-size:24px;color:var(--ion-color-warning);animation:_ngcontent-%COMP%_pulse 2s infinite}.countdown-display[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:var(--ion-color-warning);font-size:1.1rem;margin:8px 0;font-weight:600}.countdown-number[_ngcontent-%COMP%]{font-size:4rem;font-weight:700;color:var(--ion-color-warning);margin:16px 0;animation:_ngcontent-%COMP%_pulse 1s infinite;text-shadow:0 2px 4px rgba(0,0,0,.1)}.auto-assignment-info[_ngcontent-%COMP%]{margin:16px 0}.auto-assignment-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:4px 0;font-size:.9rem;color:var(--ion-color-medium)}.countdown-progress[_ngcontent-%COMP%]{margin:16px 0;height:8px;--progress-background: rgba(255, 193, 7, .3);--background: rgba(255, 193, 7, .1);border-radius:4px}.countdown-text[_ngcontent-%COMP%]{font-size:.9rem;color:var(--ion-color-warning);margin:8px 0 0}.cancel-button[_ngcontent-%COMP%]{--background: var(--ion-color-danger);--background-hover: var(--ion-color-danger-shade);--color: white;margin-top:8px;font-weight:600}.cancel-button[_ngcontent-%COMP%]:active{transform:scale(.95)}.restart-button[_ngcontent-%COMP%]{--background: var(--ion-color-tertiary);--background-hover: var(--ion-color-tertiary-shade);--color: white;font-weight:600}.restart-button[_ngcontent-%COMP%]:active{transform:scale(.95)}.assigning-button[_ngcontent-%COMP%]{--background: var(--ion-color-medium);--color: white;cursor:not-allowed}.system-info-card[_ngcontent-%COMP%]{--background: rgba(40, 167, 69, .05);border:1px solid rgba(40,167,69,.2);margin-top:16px}.system-info-card[_ngcontent-%COMP%]   ion-card-subtitle[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;color:var(--ion-color-success);font-weight:600}.system-info-card[_ngcontent-%COMP%]   .info-text[_ngcontent-%COMP%]{font-size:.9rem;color:var(--ion-color-success);margin:0 0 12px;line-height:1.4}.status-info-card[_ngcontent-%COMP%]{--background: rgba(52, 144, 220, .05);border:1px solid rgba(52,144,220,.2);margin-top:16px}.status-info-card[_ngcontent-%COMP%]   ion-card-subtitle[_ngcontent-%COMP%]{color:var(--ion-color-primary);font-weight:600}.status-info-card[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--background: transparent;--padding-start: 0;--padding-end: 0;font-size:.9rem}.status-info-card[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{color:var(--ion-color-primary)}.assigned-time-highlight[_ngcontent-%COMP%]{font-weight:600;color:var(--ion-color-primary);background:#3490dc1a;padding:2px 8px;border-radius:4px}.estimated-time-peak[_ngcontent-%COMP%]{color:var(--ion-color-warning);font-weight:600}.estimated-time-normal[_ngcontent-%COMP%]{color:var(--ion-color-success);font-weight:600}@keyframes _ngcontent-%COMP%_fadeInScale{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes _ngcontent-%COMP%_scaleUp{0%{transform:scale(.5)}to{transform:scale(1)}}@keyframes _ngcontent-%COMP%_pulse{0%{transform:scale(1);opacity:1}50%{transform:scale(1.05);opacity:.8}to{transform:scale(1);opacity:1}}@media (max-width: 768px){.countdown-number[_ngcontent-%COMP%]{font-size:3rem}.countdown-display[_ngcontent-%COMP%]{padding:20px}.status-bar[_ngcontent-%COMP%]{flex-direction:column;gap:8px;text-align:center}.demand-display[_ngcontent-%COMP%]{flex-direction:column;text-align:center;gap:12px}.time-assignment-card[_ngcontent-%COMP%]{margin:12px 0}.time-assignment-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]{padding:16px}.time-row[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:8px;padding:16px 0}.time-row[_ngcontent-%COMP%]   .time-label[_ngcontent-%COMP%]{font-size:14px}.time-row[_ngcontent-%COMP%]   .time-value[_ngcontent-%COMP%]{font-size:18px;align-self:flex-end}}"]}),e})();var ki=w(421);const Mi=()=>[1,1,1,1,1,1,1,1];function Si(n,e){if(1&n){const t=s.RV6();s.j41(0,"ion-button",8),s.bIt("click",function(){s.eBV(t);const i=s.XpG();return s.Njj(i.clearFilters())}),s.EFF(1," Quitar Filtros "),s.nrm(2,"ion-icon",4),s.k0s()}}function Di(n,e){if(1&n){const t=s.RV6();s.j41(0,"ion-item-option",22),s.bIt("click",function(){s.eBV(t);const i=s.XpG(2).$implicit,o=s.XpG(2);return s.Njj(o.cancelarPedido(i))}),s.nrm(1,"ion-icon",23),s.EFF(2," Cancelar "),s.k0s()}}function Oi(n,e){if(1&n){const t=s.RV6();s.j41(0,"ion-item-sliding",11)(1,"ion-item")(2,"ion-label")(3,"div",12)(4,"h2"),s.nrm(5,"ion-icon",13),s.EFF(6),s.nI1(7,"number"),s.k0s()(),s.j41(8,"div",14)(9,"strong"),s.nrm(10,"ion-icon",15),s.EFF(11),s.k0s(),s.j41(12,"strong",16),s.nrm(13,"ion-icon",17),s.EFF(14),s.k0s()(),s.j41(15,"ion-chip",18)(16,"ion-label"),s.EFF(17),s.k0s()()()(),s.j41(18,"ion-item-options")(19,"ion-item-option",19),s.bIt("click",function(){s.eBV(t);const i=s.XpG().$implicit,o=s.XpG(2);return s.Njj(o.openAsignarHorario(i))}),s.EFF(20," Asignar horario "),s.nrm(21,"ion-icon",20),s.k0s(),s.DNE(22,Di,3,0,"ion-item-option",21),s.k0s()()}if(2&n){const t=s.XpG().$implicit;s.R7$(6),s.SpI(" $",s.i5U(7,5,t.total,"1.2-2")," "),s.R7$(5),s.SpI(" Cliente: ",t.nombre_cliente," "),s.R7$(3),s.SpI(" ",t.estatus," "),s.R7$(3),s.JRh(t.tipo_pago),s.R7$(5),s.Y8G("ngIf","cancelado"!==t.estatus.toLowerCase()&&"entregado"!==t.estatus.toLowerCase())}}function xi(n,e){if(1&n&&(s.j41(0,"ion-list"),s.DNE(1,Oi,23,8,"ion-item-sliding",10),s.k0s()),2&n){const t=e.$implicit;s.R7$(),s.Y8G("ngIf","en preparaci\xf3n"===t.estatus.toLowerCase())}}function Ni(n,e){if(1&n&&(s.qex(0),s.DNE(1,xi,2,1,"ion-list",9),s.bVm()),2&n){const t=s.XpG();s.R7$(),s.Y8G("ngForOf",t.pedidosFiltrados)}}function Li(n,e){1&n&&(s.j41(0,"ion-item",11)(1,"ion-avatar",25),s.nrm(2,"ion-skeleton-text",26),s.k0s(),s.j41(3,"ion-label")(4,"div"),s.nrm(5,"ion-skeleton-text",27),s.k0s(),s.j41(6,"div"),s.nrm(7,"ion-skeleton-text",28),s.k0s()()())}function ji(n,e){1&n&&(s.j41(0,"ion-list"),s.DNE(1,Li,8,0,"ion-item",24),s.k0s()),2&n&&(s.R7$(),s.Y8G("ngForOf",s.lJ4(1,Mi)))}function $i(n,e){1&n&&(s.j41(0,"div",29),s.nrm(1,"ion-icon",30),s.j41(2,"h3"),s.EFF(3,"No hay pedidos disponibles"),s.k0s()())}const qi=[{path:"",component:(()=>{var n;class e{constructor(r,i){this.modalCtrl=r,this.alertController=i,this.showModal=!1,this.isEditing=!1,this.pedidos=[],this.detalle_pedido=[],this.loading=!1,this.searchTerm="",this.filtersApplied=!1,this.pedidosFiltrados=[],this.utilsSvc=(0,s.WQX)(ar.T),this.firebaseSvc=(0,s.WQX)(sr.f),this.fecha=(new Date).toLocaleDateString("es-ES",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}ngOnInit(){this.fecha=this.fecha.charAt(0).toUpperCase()+this.fecha.slice(1),this.getPedidos()}user(){return this.utilsSvc.getFromLocalStorage("user")}doRefresh(r){setTimeout(()=>{this.getPedidos(),r.target.complete()},1e3)}closeModal(){this.showModal=!1}getPedidos(){var r=this;this.loading=!0;let o=[ui("estatus","==","En preparaci\xf3n")],a=new Date;a.setHours(0,0,0,0);let l=this.firebaseSvc.getCollectionData("pedidos",o).subscribe({next:c=>{if(Array.isArray(c)){this.loading=!0,this.pedidos=c;const d=this.pedidos.filter(p=>{const g=p.fecha_entrega.toDate?p.fecha_entrega.toDate():p.fecha_entrega;return g>=a&&g<new Date(a.getTime()+864e5)}),h=d.map(p=>this.firebaseSvc.getDocument(`users/${p.uid_cliente}`).then(T=>(p.nombre_cliente=T.name+" "+T.mother_Last_Name+" "+T.father_Last_Name,this.firebaseSvc.getCollectionData(`pedidos/${p.id}/detalle_pedido`,[]).subscribe({next:N=>{p.detalle_pedido=N,p.detalle_pedido.forEach(function(){var Y=(0,$.A)(function*(ne){const Ee=`productos/${ne.uid_producto}`;try{let dt=yield r.firebaseSvc.getDocument(Ee);ne.producto=dt}catch{}});return function(ne){return Y.apply(this,arguments)}}())},error:N=>console.error("Error al obtener datos:",N)}),p)));Promise.all(h).then(p=>{this.pedidosFiltrados=d,this.loading=!1}).catch(p=>{this.loading=!1})}else this.pedidos=[],this.pedidosFiltrados=[];l.unsubscribe()},error:c=>{this.loading=!1}})}refreshOrders(){}openFilterModal(){var r=this;return(0,$.A)(function*(){const o=yield r.modalCtrl.create({component:ki.w,componentProps:{estatus:!1}});yield o.present();const{data:a}=yield o.onDidDismiss();a&&r.applyFilter(a)})()}applyFilter(r){this.filtersApplied=!0,this.pedidosFiltrados=this.pedidos.filter(i=>{if(r.selectedStatus&&r.selectedStatus.length&&!r.selectedStatus.includes(i.estatus))return!1;if(r.fechaInicio&&r.fechaFin){const o=new Date(i.fecha),a=new Date(r.fechaInicio),l=new Date(r.fechaFin);if(o<a||o>l)return!1}return!(null!==r.precioMin&&null!==r.precioMax&&(i.total<r.precioMin||i.total>r.precioMax))})}clearFilters(){this.pedidosFiltrados=this.pedidos.filter(r=>{const i=new Date(r.fecha_entrega),o=new Date;return i.toDateString()===o.toDateString()}),this.filtersApplied=!1}filterPedidos(){const r=this.searchTerm.toLowerCase();this.pedidosFiltrados=this.pedidos.filter(i=>i.nombre_cliente.toLowerCase().includes(r)||i.total.toFixed(2).includes(r)||i.id.toLowerCase().includes(r)||i.estatus.toLowerCase().includes(r))}getStatusIcon(r){switch(r.toLowerCase()){case"pedido confirmado":return"bag-check-outline";case"en preparaci\xf3n":return"refresh-circle-outline";case"en espera de recolecci\xf3n":return"time-outline";case"entregado":return"checkmark-done-outline";case"cancelado":return"close-circle-outline";default:return"help-circle-outline"}}cancelarPedido(r){var i=this;return(0,$.A)(function*(){var a;yield(yield i.alertController.create({header:"Cancelar Pedido",mode:"ios",message:"\xbfRealmente deseas cancelar el pedido?",cssClass:"custom-alert",buttons:[{text:"Cancelar",role:"cancel",cssClass:"alert-cancel",handler:()=>{}},{text:"Confirmar",cssClass:"alert-confirm",handler:(a=(0,$.A)(function*(){let l=`pedidos/${r.id}`;const c=yield i.utilsSvc.loading();yield c.present(),r.estatus="Cancelado",i.firebaseSvc.updateDocumet(l,{estatus:r.estatus}).then(function(){var d=(0,$.A)(function*(h){i.utilsSvc.presentToast({message:"Pedido cancelado",duration:2500,color:"primary",position:"bottom",icon:"refresh-circle-outline"})});return function(h){return d.apply(this,arguments)}}()).catch(d=>{i.utilsSvc.presentToast({message:d.message,duration:2500,color:"primary",position:"middle",icon:"alert-circle-outline"})}).finally(()=>{c.dismiss()})}),function(){return a.apply(this,arguments)})}],backdropDismiss:!1})).present()})()}getColorIcon(r){switch(r.toLowerCase()){case"cancelado":return"danger";case"entregado":return"primary";default:return"dark"}}openAsignarHorario(r){var i=this;return(0,$.A)(function*(){(yield i.utilsSvc.presentModal({component:Ci,componentProps:{pedido:r}}))&&i.utilsSvc.presentToast({message:"Pedido en espera de entrega",duration:2500,color:"primary",position:"bottom",icon:"refresh-circle-outline"}),i.getPedidos()})()}}return(n=e).\u0275fac=function(r){return new(r||n)(s.rXU(_.W3),s.rXU(_.hG))},n.\u0275cmp=s.VBU({type:n,selectors:[["app-horario"]],decls:12,vars:6,consts:[["title","Horarios de entrega",3,"showMenu"],["slot","fixed",3,"ionRefresh"],["mode","ios","animated","true","placeholder","Cliente, productos, precio o c\xf3digo",3,"ngModelChange","ionInput","ngModel"],["expand","block","color","primary",3,"click"],["name","filter-outline",2,"margin-left","0.5rem"],["expand","block","color","light",3,"click",4,"ngIf"],[4,"ngIf"],["class","empty",4,"ngIf"],["expand","block","color","light",3,"click"],[4,"ngFor","ngForOf"],["class","product-item",4,"ngIf"],[1,"product-item"],[1,"name"],["slot","start","color","danger","name","cash-outline",2,"margin-right","2rem"],[1,"data"],["slot","start","name","person-outline"],[2,"margin-left","3rem"],["slot","start","name","refresh-circle-outline"],["color","primary","mode","ios","outline","true"],["color","primary",3,"click"],["name","alarm-outline",1,"option-btn"],["color","danger",3,"click",4,"ngIf"],["color","danger",3,"click"],["name","close-circle-outline",1,"option-btn",2,"margin-right","0.5rem"],["class","product-item",4,"ngFor","ngForOf"],["slot","start"],["animated","",2,"width","100%","height","100%"],["animated","",2,"width","50%"],["animated","",2,"width","30%"],[1,"empty"],["name","shield-outline"]],template:function(r,i){1&r&&(s.nrm(0,"app-header",0),s.j41(1,"ion-content")(2,"ion-refresher",1),s.bIt("ionRefresh",function(a){return i.doRefresh(a)}),s.nrm(3,"ion-refresher-content"),s.k0s(),s.j41(4,"ion-searchbar",2),s.mxI("ngModelChange",function(a){return s.DH7(i.searchTerm,a)||(i.searchTerm=a),a}),s.bIt("ionInput",function(){return i.filterPedidos()}),s.k0s(),s.j41(5,"ion-button",3),s.bIt("click",function(){return i.openFilterModal()}),s.EFF(6," Filtros "),s.nrm(7,"ion-icon",4),s.k0s(),s.DNE(8,Si,3,0,"ion-button",5)(9,Ni,2,1,"ng-container",6)(10,ji,2,2,"ion-list",6)(11,$i,4,0,"div",7),s.k0s()),2&r&&(s.Y8G("showMenu",!0),s.R7$(4),s.R50("ngModel",i.searchTerm),s.R7$(4),s.Y8G("ngIf",i.filtersApplied),s.R7$(),s.Y8G("ngIf",i.pedidosFiltrados.length>0),s.R7$(),s.Y8G("ngIf",i.loading),s.R7$(),s.Y8G("ngIf",!i.loading&&!i.pedidosFiltrados.length))},dependencies:[u.Sq,u.bT,F.BC,F.vS,_.mC,_.Jm,_.ZB,_.W9,_.iq,_.uz,_.LU,_.CE,_.A7,_.he,_.nf,_.To,_.Ki,_.S1,_.ds,_.Gw,ur.l,u.QX],styles:[".option-btn[_ngcontent-%COMP%]{margin-left:.5rem}"]}),e})()}];let Hi=(()=>{var n;class e{}return(n=e).\u0275fac=function(r){return new(r||n)},n.\u0275mod=s.$C({type:n}),n.\u0275inj=s.G2t({imports:[Ae.iI.forChild(qi),Ae.iI]}),e})();var Ui=w(7383);let Bi=(()=>{var n;class e{}return(n=e).\u0275fac=function(r){return new(r||n)},n.\u0275mod=s.$C({type:n}),n.\u0275inj=s.G2t({imports:[u.MD,F.YN,_.bv,Hi,Ui.G]}),e})()},421:(dr,$e,w)=>{w.d($e,{w:()=>ge});var u=w(4438),F=w(5933),_=w(177),Ae=w(9417),$=w(8461);function s(R,V){1&R&&(u.j41(0,"ion-item-divider",4)(1,"ion-label")(2,"strong"),u.EFF(3,"Estado"),u.k0s()()())}function pe(R,V){if(1&R){const D=u.RV6();u.j41(0,"ion-item",14),u.bIt("click",function(){const E=u.eBV(D).$implicit,C=u.XpG(2);return u.Njj(C.toggleStatusFilter(E))}),u.nrm(1,"ion-icon",15),u.j41(2,"ion-label"),u.EFF(3),u.nI1(4,"titlecase"),u.k0s(),u.j41(5,"ion-checkbox",16),u.mxI("ngModelChange",function(E){const C=u.eBV(D).$implicit,P=u.XpG(2);return u.DH7(P.selectedStatus[C],E)||(P.selectedStatus[C]=E),u.Njj(E)}),u.bIt("click",function(E){return u.eBV(D),u.Njj(E.stopPropagation())}),u.k0s()()}if(2&R){const D=V.$implicit,A=u.XpG(2);u.R7$(),u.Y8G("name",A.getStatusIcon(D)),u.R7$(2),u.JRh(u.bMT(4,3,D)),u.R7$(2),u.R50("ngModel",A.selectedStatus[D])}}function mt(R,V){if(1&R&&(u.j41(0,"div"),u.DNE(1,pe,6,5,"ion-item",13),u.k0s()),2&R){const D=u.XpG();u.R7$(),u.Y8G("ngForOf",D.estatusOptions)}}let ge=(()=>{var R;class V{constructor(A){this.modalCtrl=A,this.estatusOptions=["Pedido confirmado","En preparaci\xf3n","En espera de recolecci\xf3n","Entregado","Cancelado"],this.selectedStatus={},this.fechaInicio=null,this.fechaFin=null,this.precioMin=null,this.precioMax=null,this.mostrarEstatus=!0}closeModal(){this.modalCtrl.dismiss()}toggleStatusFilter(A){this.selectedStatus[A]=!this.selectedStatus[A]}applyFilter(){const E={selectedStatus:Object.keys(this.selectedStatus).filter(C=>this.selectedStatus[C]),fechaInicio:this.fechaInicio,fechaFin:this.fechaFin,precioMin:this.precioMin,precioMax:this.precioMax};this.modalCtrl.dismiss(E)}clearFilters(){this.selectedStatus={},this.fechaInicio=null,this.fechaFin=null,this.precioMin=null,this.precioMax=null}getStatusIcon(A){switch(A.toLowerCase()){case"pedido confirmado":return"bag-check-outline";case"en preparaci\xf3n":return"refresh-circle-outline";case"en espera de recolecci\xf3n":return"time-outline";case"entregado":return"checkmark-done-outline";case"cancelado":return"close-circle-outline";default:return"help-circle-outline"}}}return(R=V).\u0275fac=function(A){return new(A||R)(u.rXU(F.W3))},R.\u0275cmp=u.VBU({type:R,selectors:[["app-filtros-modal"]],inputs:{estatus:"estatus"},decls:36,vars:9,consts:[["title","Filtros",3,"isModal","showNombre","showLogo"],[1,"filter-content"],["color","light",4,"ngIf"],[4,"ngIf"],["color","light"],["displayFormat","DD MMM YYYY",3,"ngModelChange","ngModel"],["type","number","placeholder","M\xednimo",3,"ngModelChange","ngModel"],["type","number","placeholder","M\xe1ximo",3,"ngModelChange","ngModel"],[1,"filter-buttons"],["expand","block","color","primary",3,"click"],["slot","start","name","checkmark-done-outline"],["expand","block","color","danger","fill","outline",3,"click"],["slot","start","name","close-circle-outline"],["button","",3,"click",4,"ngFor","ngForOf"],["button","",3,"click"],["slot","start","color","medium",3,"name"],["slot","end",3,"ngModelChange","click","ngModel"]],template:function(A,E){1&A&&(u.nrm(0,"app-header",0),u.j41(1,"ion-content",1)(2,"ion-list"),u.DNE(3,s,4,0,"ion-item-divider",2)(4,mt,2,1,"div",3),u.j41(5,"ion-item-divider",4)(6,"ion-label")(7,"strong"),u.EFF(8,"Fecha"),u.k0s()()(),u.j41(9,"ion-item")(10,"ion-label"),u.EFF(11,"Desde"),u.k0s(),u.j41(12,"ion-datetime",5),u.mxI("ngModelChange",function(P){return u.DH7(E.fechaInicio,P)||(E.fechaInicio=P),P}),u.k0s()(),u.j41(13,"ion-item")(14,"ion-label"),u.EFF(15,"Hasta"),u.k0s(),u.j41(16,"ion-datetime",5),u.mxI("ngModelChange",function(P){return u.DH7(E.fechaFin,P)||(E.fechaFin=P),P}),u.k0s()(),u.j41(17,"ion-item-divider",4)(18,"ion-label")(19,"strong"),u.EFF(20,"Precio"),u.k0s()()(),u.j41(21,"ion-item")(22,"ion-label"),u.EFF(23,"M\xednimo"),u.k0s(),u.j41(24,"ion-input",6),u.mxI("ngModelChange",function(P){return u.DH7(E.precioMin,P)||(E.precioMin=P),P}),u.k0s()(),u.j41(25,"ion-item")(26,"ion-label"),u.EFF(27,"M\xe1ximo"),u.k0s(),u.j41(28,"ion-input",7),u.mxI("ngModelChange",function(P){return u.DH7(E.precioMax,P)||(E.precioMax=P),P}),u.k0s()(),u.j41(29,"div",8)(30,"ion-button",9),u.bIt("click",function(){return E.applyFilter()}),u.nrm(31,"ion-icon",10),u.EFF(32," Aplicar Filtros "),u.k0s(),u.j41(33,"ion-button",11),u.bIt("click",function(){return E.clearFilters()}),u.nrm(34,"ion-icon",12),u.EFF(35," Limpiar Filtros "),u.k0s()()()()),2&A&&(u.Y8G("isModal",!0)("showNombre",!1)("showLogo",!1),u.R7$(3),u.Y8G("ngIf",E.estatus),u.R7$(),u.Y8G("ngIf",E.estatus),u.R7$(8),u.R50("ngModel",E.fechaInicio),u.R7$(4),u.R50("ngModel",E.fechaFin),u.R7$(8),u.R50("ngModel",E.precioMin),u.R7$(4),u.R50("ngModel",E.precioMax))},dependencies:[_.Sq,_.bT,F.Jm,F.eY,F.W9,F.A9,F.iq,F.$w,F.uz,F.Dg,F.he,F.nf,F.hB,F.su,F.Je,Ae.BC,Ae.vS,$.l,_.PV],styles:[".filter-content[_ngcontent-%COMP%]{--ion-background-color: #f5f5f5}ion-item-divider[_ngcontent-%COMP%]{font-size:1.1rem;color:#333;background:#e0e0e0}.filter-buttons[_ngcontent-%COMP%]{padding:1rem}.filter-buttons[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{margin:.5rem 0;--border-radius: 12px;font-size:1rem}ion-input[_ngcontent-%COMP%], ion-datetime[_ngcontent-%COMP%]{--padding-start: 1rem;--background: #ffffff;border-radius:8px;margin:.5rem 0}"]}),V})()}}]);