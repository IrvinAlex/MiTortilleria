"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2791],{2791:(R,d,n)=>{n.r(d),n.d(d,{ProfilePageModule:()=>b});var p=n(177),P=n(9417),l=n(5933),f=n(8265),c=n(467),e=n(4438),h=n(7517),v=n(2723),y=n(3405),S=n(3125),M=n(1517),F=n(8461);function T(o,s){if(1&o&&e.nrm(0,"img",9),2&o){let a;const t=e.XpG();e.Y8G("src",null==(a=t.user())?null:a.image,e.B4B)}}function C(o,s){1&o&&e.nrm(0,"ion-icon",10)}const I=[{path:"",component:(()=>{var o;class s{constructor(){this.firebaseSvc=(0,e.WQX)(h.f),this.utilSvc=(0,e.WQX)(v.T),this.modalCtrl=(0,e.WQX)(l.W3)}ngOnInit(){1==this.user().type_profile?this.tipo_perfil="Super administrador":2==this.user().type_profile?this.tipo_perfil="Administrador":3==this.user().type_profile&&(this.tipo_perfil="Usuario")}user(){return this.utilSvc.getFromLocalStorage("user")}takePicture(){var t=this;return(0,c.A)(function*(){let i=t.user(),r=`users/${i.uid}`;const u=(yield t.utilSvc.takePicture("Imagen del producto")).dataUrl,g=yield t.utilSvc.loading();yield g.present();let j=`${i.uid}/profile`;i.image=yield t.firebaseSvc.uploadImage(j,u),t.firebaseSvc.updateDocumet(r,{image:i.image}).then(function(){var m=(0,c.A)(function*(A){t.utilSvc.saveInLocalStorage("user",i),t.utilSvc.presentToast({message:"Imagen actualizada exitosamente",duration:1500,color:"success",position:"middle",icon:"checkmark-circle-outline"})});return function(A){return m.apply(this,arguments)}}()).catch(m=>{t.utilSvc.presentToast({message:m.message,duration:2500,color:"primary",position:"middle",icon:"alert-circle-outline"})}).finally(()=>{g.dismiss()})})()}terms(){var t=this;return(0,c.A)(function*(){yield t.utilSvc.presentModal({component:y.TermsComponent,cssClass:"app-terms",componentProps:{}})})()}actualizarPerfilmodal(){var t=this;return(0,c.A)(function*(){(yield t.utilSvc.presentModal({component:S.A,componentProps:{userForm:t.user()}}))&&t.reloadUserFromFirebase()})()}openAddUpdateUserModal(){var t=this;return(0,c.A)(function*(){const i=yield t.utilSvc.presentModal({component:M.r,componentProps:{user:t.user()}});null!=i&&i.success&&t.reloadUserFromFirebase()})()}reloadUserFromFirebase(){var t=this;return(0,c.A)(function*(){const i=t.user();try{const r=yield t.firebaseSvc.getDocument(`users/${i.uid}`);r&&(t.utilSvc.saveInLocalStorage("user",r),t.utilSvc.presentToast({message:"Perfil actualizado correctamente.",duration:1500,color:"success",position:"middle",icon:"checkmark-circle-outline"}))}catch(r){t.utilSvc.presentToast({message:"Error al recargar el perfil.",duration:2e3,color:"danger",position:"middle"}),console.error(r)}})()}getTipoPerfil(t){switch(t){case 1:return"Super administrador";case 2:return"Administrador";case 3:return"Usuario";default:return"Desconocido"}}}return(o=s).\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.VBU({type:o,selectors:[["app-profile"]],decls:19,vars:5,consts:[["title","Perfil",3,"showMenu"],[1,"ion-paddin-top","ion-text-center"],[3,"src",4,"ngIf"],["name","person-circle-outline","class","empty-icon",4,"ngIf"],["mode","ios","size","small","shape","round",1,"photo-btn",3,"click"],["name","camera-outline"],["button","","detail","",3,"click"],["color","primary","slot","start","name","person-outline"],["color","primary","slot","start","name","document-outline"],[3,"src"],["name","person-circle-outline",1,"empty-icon"]],template:function(t,i){if(1&t&&(e.nrm(0,"app-header",0),e.j41(1,"ion-content",1)(2,"ion-avatar"),e.DNE(3,T,1,1,"img",2)(4,C,1,0,"ion-icon",3),e.k0s(),e.j41(5,"ion-button",4),e.bIt("click",function(){return i.takePicture()}),e.nrm(6,"ion-icon",5),e.k0s(),e.j41(7,"h2"),e.EFF(8),e.k0s(),e.j41(9,"div"),e.EFF(10),e.k0s(),e.j41(11,"ion-item",6),e.bIt("click",function(){return i.actualizarPerfilmodal()}),e.nrm(12,"ion-icon",7),e.j41(13,"ion-label"),e.EFF(14,"Editar Perfil"),e.k0s()(),e.j41(15,"ion-item",6),e.bIt("click",function(){return i.terms()}),e.nrm(16,"ion-icon",8),e.j41(17,"ion-label"),e.EFF(18,"T\xe9rminos y Condiciones"),e.k0s()()()),2&t){let r,u;e.Y8G("showMenu",!0),e.R7$(3),e.Y8G("ngIf",null==(r=i.user())?null:r.image),e.R7$(),e.Y8G("ngIf",!(null!=(u=i.user())&&u.image)),e.R7$(4),e.JRh(i.user().name),e.R7$(2),e.JRh(i.tipo_perfil)}},dependencies:[p.bT,l.mC,l.Jm,l.W9,l.iq,l.uz,l.he,F.l],styles:["ion-avatar[_ngcontent-%COMP%]{width:140px;height:140px;margin:0 auto}.photo-btn[_ngcontent-%COMP%]{position:relative;bottom:25px}h2[_ngcontent-%COMP%]{margin-bottom:0}ion-item[_ngcontent-%COMP%]{--padding-top: 15px}.empty-icon[_ngcontent-%COMP%]{font-size:140px;opacity:30%}"]}),s})()}];let k=(()=>{var o;class s{}return(o=s).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[f.iI.forChild(I),f.iI]}),s})();var U=n(7383);let b=(()=>{var o;class s{}return(o=s).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[p.MD,P.YN,l.bv,k,U.G]}),s})()}}]);