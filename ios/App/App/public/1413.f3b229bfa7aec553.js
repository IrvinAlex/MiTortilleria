"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1413],{3794:(C,d,n)=>{n.r(d),n.d(d,{NegocioPageModule:()=>b});var g=n(177),v=n(9417),c=n(5933),p=n(8265),l=n(467),e=n(4438),y=n(7517),P=n(2723),I=n(3405),f=n(7762),N=n(3125),S=n(8461);function k(o,s){if(1&o&&e.nrm(0,"img",12),2&o){let a;const i=e.XpG();e.Y8G("src",null==(a=i.user())?null:a.image,e.B4B)}}function F(o,s){1&o&&e.nrm(0,"ion-icon",13)}function T(o,s){1&o&&e.nrm(0,"ion-icon",14)}const M=[{path:"",component:(()=>{var o;class s{constructor(){this.firebaseSvc=(0,e.WQX)(y.f),this.utilsSvc=(0,e.WQX)(P.T),this.modalCtrl=(0,e.WQX)(c.W3),this.isDireccionVacia=!1}ngOnInit(){var i=this;return(0,l.A)(function*(){"granted"===(yield f.L.checkPermissions()).location||"granted"===(yield f.L.requestPermissions()).location?(i.isDireccionVacia=i.checkIfDireccionIsEmpty(),1==i.user().type_profile?i.tipo_perfil="Super administrador":2==i.user().type_profile?i.tipo_perfil="Administrador":3==i.user().type_profile&&(i.tipo_perfil="Usuario")):console.error("Permiso de ubicaci\xf3n denegado")})()}user(){return this.utilsSvc.getFromLocalStorage("user")}dir(){return this.utilsSvc.getFromLocalStorage("direccion")||{}}checkIfDireccionIsEmpty(){const i=this.dir();return!i||0===Object.keys(i).length}doRefresh(i){setTimeout(()=>{this.user(),this.dir(),this.isDireccionVacia=this.checkIfDireccionIsEmpty(),i.target.complete()},1e3)}takeImage(){var i=this;return(0,l.A)(function*(){let t=i.user(),r=`users/${t.uid}`;const u=(yield i.utilsSvc.takePicture("Imagen de perfil")).dataUrl,h=yield i.utilsSvc.loading();yield h.present();let E=`/users/${t.uid}`;t.image=yield i.firebaseSvc.uploadImage(E,u),i.firebaseSvc.updateDocumet(r,{image:t.image}).then(function(){var m=(0,l.A)(function*(D){i.utilsSvc.saveInLocalStorage("user",t),i.utilsSvc.presentToast({message:"Imagen actualizada correctamente",duration:1500,color:"success",position:"middle",icon:"checkmark-circle-outline"})});return function(D){return m.apply(this,arguments)}}()).catch(m=>{i.utilsSvc.presentToast({message:m.message,duration:2500,color:"primary",position:"middle",icon:"alert-circle-outline"})}).finally(()=>{h.dismiss()})})()}direccion(){var i=this;return(0,l.A)(function*(){i.utilsSvc.presentToast({message:"Pulsa el marcador y arr\xe1stralo hasta tu ubicaci\xf3n exacta",duration:3500,color:"tertiary",position:"bottom",icon:"navigate-circle-outline"}),1==i.user().type_profile?i.utilsSvc.routerLink("main/direccion-superadmin"):i.utilsSvc.routerLink("main/direccion")})()}terms(){var i=this;return(0,l.A)(function*(){yield i.utilsSvc.presentModal({component:I.TermsComponent,cssClass:"app-terms",componentProps:{}})})()}actualizarPerfilmodal(){var i=this;return(0,l.A)(function*(){(yield i.utilsSvc.presentModal({component:N.A,componentProps:{userForm:i.user()}}))&&i.reloadUserFromFirebase()})()}reloadUserFromFirebase(){var i=this;return(0,l.A)(function*(){const t=i.user();try{const r=yield i.firebaseSvc.getDocument(`users/${t.uid}`);r&&(i.utilsSvc.saveInLocalStorage("user",r),i.utilsSvc.presentToast({message:"Perfil actualizado correctamente.",duration:1500,color:"success",position:"middle",icon:"checkmark-circle-outline"}))}catch(r){i.utilsSvc.presentToast({message:"Error al recargar el perfil.",duration:2e3,color:"danger",position:"middle"}),console.error(r)}})()}}return(o=s).\u0275fac=function(i){return new(i||o)},o.\u0275cmp=e.VBU({type:o,selectors:[["app-negocio"]],decls:26,vars:6,consts:[["title","Mi perfil",3,"showMenu"],[1,"ion-padding-top","ion-text-center"],["slot","fixed",3,"ionRefresh"],[3,"src",4,"ngIf"],["class","empty-icon","name","person-circle-outline",4,"ngIf"],["mode","ios","size","small","shape","round",1,"photo-btn",3,"click"],["name","camera-outline"],["button","","detail","",3,"click"],["color","primary","slot","start","name","person-outline"],["color","primary","slot","start","name","navigate-outline"],["name","alert-circle-outline","color","danger",4,"ngIf"],["color","primary","slot","start","name","document-outline"],[3,"src"],["name","person-circle-outline",1,"empty-icon"],["name","alert-circle-outline","color","danger"]],template:function(i,t){if(1&i&&(e.nrm(0,"app-header",0),e.j41(1,"ion-content",1)(2,"ion-refresher",2),e.bIt("ionRefresh",function(u){return t.doRefresh(u)}),e.nrm(3,"ion-refresher-content"),e.k0s(),e.j41(4,"ion-avatar"),e.DNE(5,k,1,1,"img",3)(6,F,1,0,"ion-icon",4),e.k0s(),e.j41(7,"ion-button",5),e.bIt("click",function(){return t.takeImage()}),e.nrm(8,"ion-icon",6),e.k0s(),e.j41(9,"h2"),e.EFF(10),e.k0s(),e.j41(11,"div"),e.EFF(12),e.k0s(),e.j41(13,"ion-item",7),e.bIt("click",function(){return t.actualizarPerfilmodal()}),e.nrm(14,"ion-icon",8),e.j41(15,"ion-label"),e.EFF(16,"Editar Perfil"),e.k0s()(),e.j41(17,"ion-item",7),e.bIt("click",function(){return t.direccion()}),e.nrm(18,"ion-icon",9),e.j41(19,"ion-label"),e.EFF(20,"Mi direcci\xf3n "),e.DNE(21,T,1,0,"ion-icon",10),e.k0s()(),e.j41(22,"ion-item",7),e.bIt("click",function(){return t.terms()}),e.nrm(23,"ion-icon",11),e.j41(24,"ion-label"),e.EFF(25,"T\xe9rminos y Condiciones"),e.k0s()()()),2&i){let r,u;e.Y8G("showMenu",!0),e.R7$(5),e.Y8G("ngIf",null==(r=t.user())?null:r.image),e.R7$(),e.Y8G("ngIf",!(null!=(u=t.user())&&u.image)),e.R7$(4),e.JRh(t.user().name),e.R7$(2),e.JRh(t.tipo_perfil),e.R7$(9),e.Y8G("ngIf",t.isDireccionVacia)}},dependencies:[g.bT,c.mC,c.Jm,c.W9,c.iq,c.uz,c.he,c.To,c.Ki,S.l]}),s})()}];let R=(()=>{var o;class s{}return(o=s).\u0275fac=function(i){return new(i||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[p.iI.forChild(M),p.iI]}),s})();var j=n(7383);let b=(()=>{var o;class s{}return(o=s).\u0275fac=function(i){return new(i||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[g.MD,v.YN,c.bv,R,j.G]}),s})()}}]);