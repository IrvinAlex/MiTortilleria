"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7186],{7186:(_t,S,v)=>{v.r(S),v.d(S,{MetodoEntregaNegocioPageModule:()=>mt});var y=v(177),O=v(9417),l=v(5933),E=v(8265),f=v(467),t=v(4438),I=v(8663),F=v(2723),T=v(1876),x=v(8461);function R(n,c){if(1&n&&(t.j41(0,"div",12)(1,"span"),t.EFF(2),t.k0s(),t.j41(3,"span"),t.EFF(4),t.nI1(5,"currency"),t.k0s()()),2&n){const i=c.$implicit;t.R7$(2),t.Lme("",(null==i.producto?null:i.producto.nombre)||""," x",i.cantidad,""),t.R7$(2),t.JRh(t.bMT(5,3,i.subtotal))}}function $(n,c){if(1&n&&(t.j41(0,"div",12)(1,"span",22),t.EFF(2,"Subtotal: "),t.k0s(),t.j41(3,"span",22),t.EFF(4),t.nI1(5,"currency"),t.k0s()()),2&n){const i=t.XpG();t.R7$(4),t.JRh(t.bMT(5,1,null==i.cart?null:i.cart.total))}}function N(n,c){if(1&n&&(t.j41(0,"div",12)(1,"span",23),t.EFF(2,"Descuento: "),t.k0s(),t.j41(3,"span",23),t.EFF(4),t.nI1(5,"number"),t.k0s()()),2&n){const i=t.XpG();t.R7$(4),t.SpI("-",t.i5U(5,1,i.porcentaje,"1.0-0"),"%")}}function w(n,c){if(1&n&&(t.j41(0,"div",12)(1,"span",24),t.EFF(2,"Subtotal con descuento:"),t.k0s(),t.j41(3,"span",24),t.EFF(4),t.nI1(5,"currency"),t.k0s()()),2&n){const i=t.XpG();t.R7$(4),t.JRh(t.bMT(5,1,(null==i.cart?null:i.cart.total)-(null==i.cart?null:i.cart.total)*(i.porcentaje/100)))}}function G(n,c){if(1&n&&(t.j41(0,"div",12)(1,"span"),t.EFF(2,"Subtotal:"),t.k0s(),t.j41(3,"span"),t.EFF(4),t.nI1(5,"currency"),t.k0s()()),2&n){const i=t.XpG();t.R7$(4),t.JRh(t.bMT(5,1,null==i.cart?null:i.cart.total))}}function A(n,c){1&n&&(t.j41(0,"div",25),t.nrm(1,"ion-icon",26),t.j41(2,"span",27),t.EFF(3,"\xa1Tienes env\xedo gratis!"),t.k0s()())}function z(n,c){1&n&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"currency"),t.k0s()),2&n&&(t.R7$(),t.JRh(t.bMT(2,1,0)))}function Y(n,c){if(1&n&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"currency"),t.k0s()),2&n){const i=t.XpG();t.R7$(),t.JRh(t.bMT(2,1,i.transportFee))}}function L(n,c){1&n&&(t.j41(0,"div",12)(1,"span"),t.EFF(2,"Cargo de servicio:"),t.k0s(),t.j41(3,"span"),t.EFF(4),t.nI1(5,"currency"),t.k0s()()),2&n&&(t.R7$(4),t.JRh(t.bMT(5,1,5)))}function X(n,c){if(1&n&&(t.j41(0,"div",28),t.nrm(1,"ion-icon",29),t.j41(2,"span",30),t.EFF(3),t.nI1(4,"currency"),t.k0s()()),2&n){const i=t.XpG();t.R7$(3),t.SpI("Agrega ",t.bMT(4,1,140-((null==i.cart?null:i.cart.total)-(null==i.cart?null:i.cart.total)*(i.porcentaje/100)))," m\xe1s para env\xedo gratis")}}function J(n,c){if(1&n&&(t.j41(0,"span")(1,"strong"),t.EFF(2),t.nI1(3,"currency"),t.k0s()()),2&n){const i=t.XpG();t.R7$(2),t.JRh(t.bMT(3,1,(null==i.cart?null:i.cart.total)-(null==i.cart?null:i.cart.total)*(i.porcentaje/100)))}}function B(n,c){if(1&n&&(t.j41(0,"span")(1,"strong"),t.EFF(2),t.nI1(3,"currency"),t.k0s()()),2&n){const i=t.XpG();t.R7$(2),t.JRh(t.bMT(3,1,(null==i.cart?null:i.cart.total)-(null==i.cart?null:i.cart.total)*(i.porcentaje/100)+i.transportFee+5))}}function V(n,c){1&n&&(t.j41(0,"div",31),t.nrm(1,"div",32),t.k0s())}function W(n,c){1&n&&t.nrm(0,"ion-icon",36)}function U(n,c){if(1&n){const i=t.RV6();t.j41(0,"div",33)(1,"ion-button",34),t.bIt("click",function(){t.eBV(i);const e=t.XpG();return t.Njj(e.confirmPayment())}),t.DNE(2,W,1,0,"ion-icon",35),t.EFF(3),t.k0s()()}if(2&n){const i=t.XpG();t.R7$(),t.AVh("animated",i.confirming),t.Y8G("disabled",i.confirming||i.paymentConfirmed),t.R7$(),t.Y8G("ngIf",i.paymentConfirmed),t.R7$(),t.SpI(" ",i.paymentConfirmed?"Pedido Confirmado":"Confirmar Pago"," ")}}let Q=(()=>{var n;class c{constructor(){this.selectedPayment=null,this.confirming=!1,this.paymentConfirmed=!1,this.utilsSvc=(0,t.WQX)(F.T),this.firebaseSvc=(0,t.WQX)(I.f),this.emailSvc=(0,t.WQX)(T._),this.discountAmount=0,this.porcentaje=0,this.distanciaKm=0,this.transportFee=0}ngOnInit(){this.getCartDetails(),this.applyStoredCoupon();const o=this.dir()[0];o&&this.firebaseSvc.getCollectionData("direccionNegocio").subscribe(e=>{if(e&&e.length>0){const a=e[0],r=this.calcularDistancia(parseFloat(o.geopoint._lat),parseFloat(o.geopoint._long),parseFloat(a.geopoint.latitude),parseFloat(a.geopoint.longitude));this.distanciaKm=parseFloat(r.toFixed(2)),this.transportFee=this.calculateTransportFee(this.distanciaKm)}})}calculateTransportFee(o){return o<=.5?30:o<=1?35:o<=1.5?50:o<=2?65:o<=2.5?70:o<=3?80:o<=3.5?90:o<=4?115:o<=4.5?125:145}sendOrderConfirmationEmail(o,e){var a=this;return(0,f.A)(function*(){try{const r=a.utilsSvc.getFromLocalStorage("user"),s={orderId:o,customerEmail:r.email,customerName:r.name||r.email,fecha:new Date,estatus:"Pedido confirmado",tipo_pago:e,items:a.cart.detalle_carrito,subtotal:a.cart.total,discountAmount:a.cart.total*(a.porcentaje/100),discountPercent:a.porcentaje,transportFee:a.transportFee,total:a.cart.total-a.cart.total*(a.porcentaje/100)+a.transportFee};yield a.emailSvc.sendOrderConfirmationEmail(s),console.log("Email de confirmaci\xf3n enviado exitosamente")}catch(r){console.error("Error al enviar email de confirmaci\xf3n:",r)}})()}renderPayPalButton(){var a,o=this;document.getElementById("paypal-button-container")?window.paypal.Buttons({createOrder:(a,r)=>{const s=this.cart.total-this.cart.total*(this.porcentaje/100);return r.order.create({purchase_units:[{amount:{value:(s+(s>=140?0:this.transportFee)+(s<140?5:0)).toFixed(2)}}]})},onApprove:(a=(0,f.A)(function*(r,s){return s.order.capture().then(function(){var m=(0,f.A)(function*(h){console.log("Pago completado:",h);const _=yield o.utilsSvc.loading();yield _.present(),o.confirming=!0,setTimeout(()=>{o.confirming=!1,o.paymentConfirmed=!0},3e3),setTimeout((0,f.A)(function*(){const d=document.querySelector(".confirm-button");d&&d.classList.add("complete");const C=o.utilsSvc.getFromLocalStorage("user").uid,P=o.dir()[0],b=o.cart.total-o.cart.total*(o.porcentaje/100),u=b+(b>=140?0:o.transportFee)+(b<140?5:0),D={estatus:"Pedido confirmado",fecha:new Date,fecha_entrega:new Date(o.cart.fecha_entrega),pago_confirmado:!0,tipo_pago:"Tarjeta",tipo_entrega:"Negocio",total:u,uid_cliente:C,geopoint_entrega:{latitude:P.geopoint._lat,longitude:P.geopoint._long}},ft=o.cart.detalle_carrito.map(g=>({cantidad:g.cantidad,subtotal:g.subtotal,uid_producto:g.uid_producto,uid_opcion:g.uid_opcion,tamano_tortilla:g.tamano_tortilla}));o.utilsSvc.setElementInLocalstorage("pedido",D),o.utilsSvc.setElementInLocalstorage("detalle_pedido",ft);const k=o.cart.id;if(k)try{for(let g of o.cart.detalle_carrito)yield o.firebaseSvc.deleteDocumet(`users/${C}/carrito_negocio/${k}/detalle_carrito/${g.id}`)}catch(g){console.error("Error deleting cart items:",g)}else console.warn("Cart ID is missing, skipping cart item deletion");const j=yield o.firebaseSvc.addDocument("pedidos",D);for(let g of o.cart.detalle_carrito)g.tamano_tortilla>10?yield o.firebaseSvc.addDocument(`pedidos/${j.id}/detalle_pedido`,{cantidad:g.cantidad,subtotal:g.subtotal,uid_producto:g.uid_producto,uid_opcion:g.uid_opcion,tamano_tortilla:g.tamano_tortilla}):yield o.firebaseSvc.addDocument(`pedidos/${j.id}/detalle_pedido`,{cantidad:g.cantidad,subtotal:g.subtotal,uid_producto:g.uid_producto,uid_opcion:g.uid_opcion});yield o.sendOrderConfirmationEmail(j.id,"Tarjeta"),yield o.firebaseSvc.updateDocumet(`users/${C}/carrito_negocio/${k}`,{total:0}),o.cart.detalle_carrito=[],o.cart.total=0,o.utilsSvc.setElementInLocalstorage("carrito",[o.cart]),localStorage.removeItem("selectedMethod"),_.dismiss(),o.utilsSvc.presentToast({message:"Pedido confirmado",duration:2500,color:"primary",position:"bottom",icon:"alert-circle-outline"}),o.paymentConfirmed=!1,o.utilsSvc.dismissModal(!0),o.utilsSvc.routerLink("/main/confirmacion-pago")}),3e3)});return function(h){return m.apply(this,arguments)}}())}),function(s,m){return a.apply(this,arguments)}),onError:a=>{console.error("Error en el pago:",a),alert("Hubo un problema con el pago. Por favor, int\xe9ntalo de nuevo.")}}).render("#paypal-button-container"):console.error("Contenedor #paypal-button-container no encontrado.")}onPaymentChange(o){var e=this;return(0,f.A)(function*(){if(e.selectedPayment=o,"paypal"===o){const a=yield e.utilsSvc.loading();yield a.present(),setTimeout(()=>{e.renderPayPalButton(),a.dismiss()},1500)}})()}confirmPayment(){var o=this;return(0,f.A)(function*(){const e=yield o.utilsSvc.loading();yield e.present(),o.confirming=!0,setTimeout(()=>{o.confirming=!1,o.paymentConfirmed=!0},3e3),setTimeout((0,f.A)(function*(){const a=document.querySelector(".confirm-button");a&&a.classList.add("complete");const r=o.utilsSvc.getFromLocalStorage("user").uid,s=o.dir()[0],m=o.cart.total-o.cart.total*(o.porcentaje/100),d=m+(m>=140?0:o.transportFee)+(m<140?5:0),C={estatus:"Pedido confirmado",fecha:new Date,fecha_entrega:new Date(o.cart.fecha_entrega),pago_confirmado:!1,tipo_pago:"Efectivo",tipo_entrega:"Negocio",total:d,uid_cliente:r,geopoint_entrega:{latitude:s.geopoint._lat,longitude:s.geopoint._long}},P=o.cart.detalle_carrito.map(p=>({cantidad:p.cantidad,subtotal:p.subtotal,uid_producto:p.uid_producto,uid_opcion:p.uid_opcion,tamano_tortilla:p.tamano_tortilla}));o.utilsSvc.setElementInLocalstorage("pedido",C),o.utilsSvc.setElementInLocalstorage("detalle_pedido",P);const b=o.cart.id;if(b)try{for(let p of o.cart.detalle_carrito)yield o.firebaseSvc.deleteDocumet(`users/${r}/carrito_negocio/${b}/detalle_carrito/${p.id}`)}catch(p){console.error("Error deleting cart items:",p)}else console.warn("Cart ID is missing, skipping cart item deletion");const M=yield o.firebaseSvc.addDocument("pedidos",C);for(let p of o.cart.detalle_carrito)p.tamano_tortilla?yield o.firebaseSvc.addDocument(`pedidos/${M.id}/detalle_pedido`,{cantidad:p.cantidad,subtotal:p.subtotal,uid_producto:p.uid_producto,uid_opcion:p.uid_opcion,tamano_tortilla:p.tamano_tortilla}):yield o.firebaseSvc.addDocument(`pedidos/${M.id}/detalle_pedido`,{cantidad:p.cantidad,subtotal:p.subtotal,uid_producto:p.uid_producto,uid_opcion:p.uid_opcion});yield o.sendOrderConfirmationEmail(M.id,"Efectivo"),b&&(yield o.firebaseSvc.updateDocumet(`users/${r}/carrito_negocio/${b}`,{total:0})),o.cart.detalle_carrito=[],o.cart.total=0,o.utilsSvc.setElementInLocalstorage("carrito_negocio",[o.cart]),localStorage.removeItem("selectedMethod"),e.dismiss(),o.utilsSvc.presentToast({message:"Pedido confirmado",duration:2500,color:"primary",position:"bottom",icon:"alert-circle-outline"}),o.paymentConfirmed=!1,o.utilsSvc.dismissModal(!0),o.utilsSvc.routerLink("/main/confirmacion-pago")}),3e3)})()}getCartDetails(){var o=this;return(0,f.A)(function*(){const e=yield o.utilsSvc.loading();yield e.present();const a=o.utilsSvc.getFromLocalStorage("carrito_negocio");o.cart=a[0];for(let r of o.cart.detalle_carrito){const s=yield o.firebaseSvc.getDocument(`productos/${r.uid_producto}`),m=yield o.firebaseSvc.getDocument(`productos/${r.uid_producto}/opciones/${r.uid_opcion}`);r.producto=s||{},r.opcion=m||{}}console.log("Carrito:",o.cart),e.dismiss()})()}applyStoredCoupon(){if(this.cart=this.utilsSvc.getFromLocalStorage("carrito_negocio")[0],this.cart){const o=this.utilsSvc.getFromLocalStorage("appliedCoupon");o&&(this.discountAmount=this.cart.total*o.porcentaje/100,this.porcentaje=o.porcentaje,this.cart.total-=this.discountAmount)}}calcularDistancia(o,e,a,r){const m=(a-o)*Math.PI/180,h=(r-e)*Math.PI/180,_=Math.sin(m/2)*Math.sin(m/2)+Math.cos(o*Math.PI/180)*Math.cos(a*Math.PI/180)*Math.sin(h/2)*Math.sin(h/2);return 2*Math.atan2(Math.sqrt(_),Math.sqrt(1-_))*6371}dir(){return this.utilsSvc.getFromLocalStorage("direccion")||{}}}return(n=c).\u0275fac=function(o){return new(o||n)},n.\u0275cmp=t.VBU({type:n,selectors:[["app-entrega-domicilio-negocio"]],decls:54,vars:25,consts:[["title","Pago",3,"isModal"],[3,"fullscreen"],[1,"payment-card"],[1,"title"],[3,"ionChange"],["button","",1,"option-card",3,"click"],["name","cash-outline","slot","start",1,"option-icon"],["slot","end","value","efectivo"],["name","card-outline","slot","start",1,"option-icon"],["slot","end","value","tarjeta"],[1,"summary-card"],[1,"summary-title"],[1,"summary-item"],["class","summary-item",4,"ngFor","ngForOf"],[1,"divider"],["class","summary-item",4,"ngIf"],["class","free-shipping-message",4,"ngIf"],[4,"ngIf"],["class","motivational-message",4,"ngIf"],[1,"summary-item","total-item"],["class","confirm-button-container-paypal",4,"ngIf"],["class","confirm-button-container",4,"ngIf"],[1,"original-price"],[1,"descuento"],[1,"discounted-price"],[1,"free-shipping-message"],["name","gift-outline","color","success"],[1,"success-text"],[1,"motivational-message"],["name","information-circle-outline","color","primary"],[1,"info-text"],[1,"confirm-button-container-paypal"],["id","paypal-button-container"],[1,"confirm-button-container"],["expand","block","mode","ios",3,"click","disabled"],["name","checkmark-outline","slot","start",4,"ngIf"],["name","checkmark-outline","slot","start"]],template:function(o,e){1&o&&(t.nrm(0,"app-header",0),t.j41(1,"ion-content",1)(2,"ion-card",2)(3,"ion-card-header")(4,"h2",3),t.EFF(5,"M\xe9todo de Pago"),t.k0s()(),t.j41(6,"ion-card-content")(7,"ion-radio-group",4),t.bIt("ionChange",function(r){return e.onPaymentChange(r.detail.value)}),t.j41(8,"ion-card",5),t.bIt("click",function(){return e.onPaymentChange("efectivo")}),t.j41(9,"ion-item"),t.nrm(10,"ion-icon",6),t.j41(11,"ion-label"),t.EFF(12,"Efectivo en domicilio"),t.k0s(),t.nrm(13,"ion-radio",7),t.k0s()(),t.j41(14,"ion-card",5),t.bIt("click",function(){return e.onPaymentChange("paypal")}),t.j41(15,"ion-item"),t.nrm(16,"ion-icon",8),t.j41(17,"ion-label"),t.EFF(18,"Tarjeta"),t.k0s(),t.nrm(19,"ion-radio",9),t.k0s()()()()(),t.j41(20,"ion-card",10)(21,"ion-card-header")(22,"h3",11),t.EFF(23,"Resumen de compra"),t.k0s()(),t.j41(24,"ion-card-content")(25,"div",12)(26,"span"),t.EFF(27),t.k0s(),t.j41(28,"span"),t.EFF(29),t.nI1(30,"currency"),t.k0s()(),t.DNE(31,R,6,5,"div",13),t.nrm(32,"div",14),t.DNE(33,$,6,3,"div",15)(34,N,6,4,"div",15)(35,w,6,3,"div",15)(36,G,6,3,"div",15)(37,A,4,0,"div",16),t.j41(38,"div",12)(39,"span"),t.EFF(40),t.k0s(),t.DNE(41,z,3,3,"span",17)(42,Y,3,3,"span",17),t.k0s(),t.DNE(43,L,6,3,"div",15)(44,X,5,3,"div",18),t.nrm(45,"div",14),t.j41(46,"div",19)(47,"span")(48,"strong"),t.EFF(49,"Total a pagar:"),t.k0s()(),t.DNE(50,J,4,3,"span",17)(51,B,4,3,"span",17),t.k0s()()(),t.DNE(52,V,2,0,"div",20)(53,U,4,5,"div",21),t.k0s()),2&o&&(t.Y8G("isModal",!0),t.R7$(),t.Y8G("fullscreen",!0),t.R7$(7),t.AVh("selected","efectivo"===e.selectedPayment),t.R7$(6),t.AVh("selected","paypal"===e.selectedPayment),t.R7$(13),t.SpI("Productos (",(null==e.cart||null==e.cart.detalle_carrito?null:e.cart.detalle_carrito.length)||0,")"),t.R7$(2),t.JRh(t.bMT(30,23,null==e.cart?null:e.cart.total)),t.R7$(2),t.Y8G("ngForOf",null==e.cart?null:e.cart.detalle_carrito),t.R7$(2),t.Y8G("ngIf",e.discountAmount>0),t.R7$(),t.Y8G("ngIf",e.discountAmount>0),t.R7$(),t.Y8G("ngIf",e.discountAmount>0),t.R7$(),t.Y8G("ngIf",0===e.discountAmount),t.R7$(),t.Y8G("ngIf",(null==e.cart?null:e.cart.total)-(null==e.cart?null:e.cart.total)*(e.porcentaje/100)>=140),t.R7$(3),t.SpI("Tarifa de transporte (",e.distanciaKm," km):"),t.R7$(),t.Y8G("ngIf",(null==e.cart?null:e.cart.total)-(null==e.cart?null:e.cart.total)*(e.porcentaje/100)>=140),t.R7$(),t.Y8G("ngIf",(null==e.cart?null:e.cart.total)-(null==e.cart?null:e.cart.total)*(e.porcentaje/100)<140),t.R7$(),t.Y8G("ngIf",(null==e.cart?null:e.cart.total)-(null==e.cart?null:e.cart.total)*(e.porcentaje/100)<140),t.R7$(),t.Y8G("ngIf",(null==e.cart?null:e.cart.total)-(null==e.cart?null:e.cart.total)*(e.porcentaje/100)<140),t.R7$(6),t.Y8G("ngIf",(null==e.cart?null:e.cart.total)-(null==e.cart?null:e.cart.total)*(e.porcentaje/100)>=140),t.R7$(),t.Y8G("ngIf",(null==e.cart?null:e.cart.total)-(null==e.cart?null:e.cart.total)*(e.porcentaje/100)<140),t.R7$(),t.Y8G("ngIf","tarjeta"===e.selectedPayment),t.R7$(),t.Y8G("ngIf","efectivo"===e.selectedPayment))},dependencies:[y.Sq,y.bT,l.Jm,l.b_,l.I9,l.ME,l.W9,l.iq,l.uz,l.he,l.KO,l.f0,l.uR,l.Je,x.l,y.QX,y.oe],styles:['@charset "UTF-8";.payment-card[_ngcontent-%COMP%], .summary-card[_ngcontent-%COMP%]{margin:16px;border-radius:16px;box-shadow:0 4px 8px #0000001a}.title[_ngcontent-%COMP%], .summary-title[_ngcontent-%COMP%]{font-size:1.2rem;font-weight:700;text-align:center;color:var(--ion-color-primary)}.option-card[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:16px;transition:transform .2s ease,background-color .3s ease}.option-card.selected[_ngcontent-%COMP%]{transform:scale(1.05);background-color:var(--ion-color-primary-tint)}.option-icon[_ngcontent-%COMP%]{font-size:2rem;color:var(--ion-color-primary);margin-right:8px}.summary-card[_ngcontent-%COMP%]{background-color:#f8f9fa;color:#343a40}.summary-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:12px 0;font-size:1rem}.divider[_ngcontent-%COMP%]{border-bottom:1px solid #dee2e6;margin:8px 0}.confirm-button-container[_ngcontent-%COMP%], .confirm-button-container-paypal[_ngcontent-%COMP%]{margin:16px}.confirm-button[_ngcontent-%COMP%]{--background: var(--ion-color-primary);color:#fff;font-weight:700;border-radius:24px;text-align:center;position:relative;overflow:hidden;transition:background-color .3s ease-in-out}.complete[_ngcontent-%COMP%]{--background: var(--ion-color-primary);color:#fff;font-weight:700;border-radius:24px;text-align:center;position:relative;overflow:hidden}.confirm-button.animated[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;height:100%;width:0%;background:linear-gradient(to right,var(--ion-color-primary),var(--ion-color-secondary),var(--ion-color-tertiary));z-index:1;animation:_ngcontent-%COMP%_slideIn 3s forwards}.confirm-button.animated[_ngcontent-%COMP%]{color:transparent}.confirm-button.animated[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#fff}.confirm-button.complete[_ngcontent-%COMP%]{--background: var(--ion-color-primary)}@keyframes _ngcontent-%COMP%_slideIn{0%{width:0%}50%{width:100%}to{width:0%}}.total-summary[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start}.total-summary[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin:4px 0}.discounted-price[_ngcontent-%COMP%]{color:green;font-weight:700}.original-price[_ngcontent-%COMP%]{color:gray;text-decoration:line-through;font-size:17px}.descuento[_ngcontent-%COMP%]{font-weight:700;font-size:17px}.free-shipping-message[_ngcontent-%COMP%], .motivational-message[_ngcontent-%COMP%]{display:flex;align-items:center;padding:8px 12px;margin:8px 0;border-radius:8px;font-size:.9rem}.free-shipping-message[_ngcontent-%COMP%]{background-color:#28a7451a;border:1px solid rgba(40,167,69,.3)}.motivational-message[_ngcontent-%COMP%]{background-color:#007bff1a;border:1px solid rgba(0,123,255,.3)}.success-text[_ngcontent-%COMP%]{color:var(--ion-color-success);font-weight:500;margin-left:8px}.info-text[_ngcontent-%COMP%]{color:var(--ion-color-primary);font-weight:500;margin-left:8px}.total-item[_ngcontent-%COMP%]{font-size:1.1rem;border-top:2px solid var(--ion-color-primary);padding-top:12px;margin-top:8px}']}),c})();function H(n,c){if(1&n&&(t.j41(0,"div",12)(1,"span"),t.EFF(2),t.k0s(),t.j41(3,"span"),t.EFF(4),t.nI1(5,"currency"),t.k0s()()),2&n){const i=c.$implicit;t.R7$(2),t.Lme("",(null==i.producto?null:i.producto.nombre)||""," x",i.cantidad,""),t.R7$(2),t.JRh(t.bMT(5,3,i.subtotal))}}function q(n,c){if(1&n&&(t.j41(0,"div",12)(1,"span",18),t.EFF(2,"Total: "),t.k0s(),t.j41(3,"span",18),t.EFF(4),t.nI1(5,"currency"),t.k0s()()),2&n){const i=t.XpG();t.R7$(4),t.JRh(t.bMT(5,1,null==i.cart?null:i.cart.total))}}function Z(n,c){if(1&n&&(t.j41(0,"div",12)(1,"span",19),t.EFF(2,"Descuento: "),t.k0s(),t.j41(3,"span",19),t.EFF(4),t.nI1(5,"number"),t.k0s()()),2&n){const i=t.XpG();t.R7$(4),t.SpI("-",t.i5U(5,1,i.porcentaje,"1.0-0"),"%")}}function K(n,c){if(1&n&&(t.j41(0,"div",12)(1,"span",20),t.EFF(2,"Total con descuento:"),t.k0s(),t.j41(3,"span",20),t.EFF(4),t.nI1(5,"currency"),t.k0s()()),2&n){const i=t.XpG();t.R7$(4),t.JRh(t.bMT(5,1,(null==i.cart?null:i.cart.total)-(null==i.cart?null:i.cart.total)*(i.porcentaje/100)))}}function tt(n,c){if(1&n&&(t.j41(0,"div",12)(1,"span"),t.EFF(2,"Pagas"),t.k0s(),t.j41(3,"span"),t.EFF(4),t.nI1(5,"currency"),t.k0s()()),2&n){const i=t.XpG();t.R7$(4),t.JRh(t.bMT(5,1,null==i.cart?null:i.cart.total))}}function ot(n,c){1&n&&(t.j41(0,"div",21),t.nrm(1,"div",22),t.k0s())}function et(n,c){1&n&&t.nrm(0,"ion-icon",26)}function nt(n,c){if(1&n){const i=t.RV6();t.j41(0,"div",23)(1,"ion-button",24),t.bIt("click",function(){t.eBV(i);const e=t.XpG();return t.Njj(e.confirmPayment())}),t.DNE(2,et,1,0,"ion-icon",25),t.EFF(3),t.k0s()()}if(2&n){const i=t.XpG();t.R7$(),t.AVh("animated",i.confirming),t.Y8G("disabled",i.confirming||i.paymentConfirmed),t.R7$(),t.Y8G("ngIf",i.paymentConfirmed),t.R7$(),t.SpI(" ",i.paymentConfirmed?"Pedido Confirmado":"Confirmar Pago"," ")}}let it=(()=>{var n;class c{constructor(){this.selectedPayment=null,this.confirming=!1,this.paymentConfirmed=!1,this.utilsSvc=(0,t.WQX)(F.T),this.firebaseSvc=(0,t.WQX)(I.f),this.emailSvc=(0,t.WQX)(T._),this.discountAmount=0,this.porcentaje=0}ngOnInit(){this.getCartDetails(),console.log(this.cart)}sendOrderConfirmationEmail(o,e){var a=this;return(0,f.A)(function*(){try{const r=a.utilsSvc.getFromLocalStorage("user"),s={orderId:o,customerEmail:r.email,customerName:r.name||r.email,fecha:new Date,estatus:"Pedido confirmado",tipo_pago:e,items:a.cart.detalle_carrito,subtotal:a.cart.total,discountAmount:a.cart.total*(a.porcentaje/100),discountPercent:a.porcentaje,transportFee:0,total:a.cart.total-a.cart.total*(a.porcentaje/100)};yield a.emailSvc.sendOrderConfirmationEmail(s),console.log("Email de confirmaci\xf3n enviado exitosamente")}catch(r){console.error("Error al enviar email de confirmaci\xf3n:",r)}})()}renderPayPalButton(){var a,o=this;document.getElementById("paypal-button-container")?window.paypal.Buttons({createOrder:(a,r)=>r.order.create({purchase_units:[{amount:{value:this.cart.total-this.cart.total*(this.porcentaje/100)}}]}),onApprove:(a=(0,f.A)(function*(r,s){return s.order.capture().then(function(){var m=(0,f.A)(function*(h){console.log("Pago completado:",h);const _=yield o.utilsSvc.loading();yield _.present(),o.confirming=!0,setTimeout(()=>{o.confirming=!1,o.paymentConfirmed=!0},3e3),setTimeout((0,f.A)(function*(){const d=document.querySelector(".confirm-button");d&&d.classList.add("complete");const C=o.utilsSvc.getFromLocalStorage("user").uid,P={estatus:"Pedido confirmado",fecha:new Date,fecha_entrega:new Date(o.cart.fecha_entrega),pago_confirmado:!0,tipo_pago:"Tarjeta",total:o.cart.total,uid_cliente:C},b=o.cart.detalle_carrito.map(u=>({cantidad:u.cantidad,subtotal:u.subtotal,uid_producto:u.uid_producto,uid_opcion:u.uid_opcion,tamano_tortilla:u.tamano_tortilla}));o.utilsSvc.setElementInLocalstorage("pedido",P),o.utilsSvc.setElementInLocalstorage("detalle_pedido",b);const M=o.cart.id;for(let u of o.cart.detalle_carrito)yield o.firebaseSvc.deleteDocumet(`users/${C}/carrito_negocio/${M}/detalle_carrito/${u.id}`);const p=yield o.firebaseSvc.addDocument("pedidos",P);for(let u of o.cart.detalle_carrito)u.tamano_tortilla?yield o.firebaseSvc.addDocument(`pedidos/${p.id}/detalle_pedido`,{cantidad:u.cantidad,subtotal:u.subtotal,uid_producto:u.uid_producto,uid_opcion:u.uid_opcion,tamano_tortilla:u.tamano_tortilla}):yield o.firebaseSvc.addDocument(`pedidos/${p.id}/detalle_pedido`,{cantidad:u.cantidad,subtotal:u.subtotal,uid_producto:u.uid_producto,uid_opcion:u.uid_opcion});yield o.sendOrderConfirmationEmail(p.id,"Tarjeta"),yield o.firebaseSvc.updateDocumet(`users/${C}/carrito_negocio/${M}`,{total:0}),o.cart.detalle_carrito=[],o.cart.total=0,o.utilsSvc.setElementInLocalstorage("carrito_negocio",[o.cart]),localStorage.removeItem("selectedMethod"),_.dismiss(),o.utilsSvc.presentToast({message:"Pedido confirmado",duration:2500,color:"primary",position:"bottom",icon:"alert-circle-outline"}),o.paymentConfirmed=!1,o.utilsSvc.dismissModal(!0),o.utilsSvc.routerLink("/main/confirmacion-pago")}),3e3)});return function(h){return m.apply(this,arguments)}}())}),function(s,m){return a.apply(this,arguments)}),onError:a=>{console.error("Error en el pago:",a),alert("Hubo un problema con el pago. Por favor, int\xe9ntalo de nuevo.")}}).render("#paypal-button-container"):console.error("Contenedor #paypal-button-container no encontrado.")}onPaymentChange(o){var e=this;return(0,f.A)(function*(){if(e.selectedPayment=o,"paypal"===o){const a=yield e.utilsSvc.loading();yield a.present(),setTimeout(()=>{e.renderPayPalButton(),a.dismiss()},1500)}})()}confirmPayment(){var o=this;return(0,f.A)(function*(){const e=yield o.utilsSvc.loading();yield e.present(),o.confirming=!0,setTimeout(()=>{o.confirming=!1,o.paymentConfirmed=!0},3e3),setTimeout((0,f.A)(function*(){const a=document.querySelector(".confirm-button");a&&a.classList.add("complete");const r=o.utilsSvc.getFromLocalStorage("user").uid,s={estatus:"Pedido confirmado",fecha:new Date,fecha_entrega:new Date(o.cart.fecha_entrega),pago_confirmado:!1,tipo_pago:"Efectivo",total:o.cart.total-o.cart.total*(o.porcentaje/100),uid_cliente:r},m=o.cart.detalle_carrito.map(d=>({cantidad:d.cantidad,subtotal:d.subtotal,uid_producto:d.uid_producto,uid_opcion:d.uid_opcion,tamano_tortilla:d.tamano_tortilla}));o.utilsSvc.setElementInLocalstorage("pedido",s),o.utilsSvc.setElementInLocalstorage("detalle_pedido",m);const h=o.cart.id;for(let d of o.cart.detalle_carrito)yield o.firebaseSvc.deleteDocumet(`users/${r}/carrito_negocio/${h}/detalle_carrito/${d.id}`);const _=yield o.firebaseSvc.addDocument("pedidos",s);for(let d of o.cart.detalle_carrito)d.tamano_tortilla?yield o.firebaseSvc.addDocument(`pedidos/${_.id}/detalle_pedido`,{cantidad:d.cantidad,subtotal:d.subtotal,uid_producto:d.uid_producto,uid_opcion:d.uid_opcion,tamano_tortilla:d.tamano_tortilla}):yield o.firebaseSvc.addDocument(`pedidos/${_.id}/detalle_pedido`,{cantidad:d.cantidad,subtotal:d.subtotal,uid_producto:d.uid_producto,uid_opcion:d.uid_opcion});yield o.sendOrderConfirmationEmail(_.id,"Efectivo"),yield o.firebaseSvc.updateDocumet(`users/${r}/carrito_negocio/${h}`,{total:0}),o.cart.detalle_carrito=[],o.cart.total=0,o.utilsSvc.setElementInLocalstorage("carrito_negocio",[o.cart]),localStorage.removeItem("selectedMethod"),e.dismiss(),o.utilsSvc.presentToast({message:"Pedido confirmado",duration:2500,color:"primary",position:"bottom",icon:"alert-circle-outline"}),o.paymentConfirmed=!1,o.utilsSvc.dismissModal(!0),o.utilsSvc.routerLink("/main/confirmacion-pago")}),3e3)})()}getCartDetails(){var o=this;return(0,f.A)(function*(){const e=yield o.utilsSvc.loading();yield e.present(),o.cart=o.utilsSvc.getFromLocalStorage("carrito_negocio")[0];for(let a of o.cart.detalle_carrito){const r=yield o.firebaseSvc.getDocument(`productos/${a.uid_producto}`),s=yield o.firebaseSvc.getDocument(`productos/${a.uid_producto}/opciones/${a.uid_opcion}`);a.producto=r||{},a.opcion=s||{}}e.dismiss()})()}applyStoredCoupon(){if(this.cart=this.utilsSvc.getFromLocalStorage("carrito_negocio")[0],this.cart){const o=this.utilsSvc.getFromLocalStorage("appliedCoupon");o&&(this.discountAmount=this.cart.total*o.porcentaje/100,this.porcentaje=o.porcentaje,this.cart.total-=this.discountAmount)}}}return(n=c).\u0275fac=function(o){return new(o||n)},n.\u0275cmp=t.VBU({type:n,selectors:[["app-entrega-negocio-negocio"]],decls:39,vars:17,consts:[["title","Pago",3,"isModal"],[3,"fullscreen"],[1,"payment-card"],[1,"title"],[3,"ionChange"],["button","",1,"option-card",3,"click"],["name","cash-outline","slot","start",1,"option-icon"],["slot","end","value","efectivo"],["name","card-outline","slot","start",1,"option-icon"],["slot","end","value","tarjeta"],[1,"summary-card"],[1,"summary-title"],[1,"summary-item"],["class","summary-item",4,"ngFor","ngForOf"],[1,"divider"],["class","summary-item",4,"ngIf"],["class","confirm-button-container-paypal",4,"ngIf"],["class","confirm-button-container",4,"ngIf"],[1,"original-price"],[1,"descuento"],[1,"discounted-price"],[1,"confirm-button-container-paypal"],["id","paypal-button-container"],[1,"confirm-button-container"],["expand","block","mode","ios",3,"click","disabled"],["name","checkmark-outline","slot","start",4,"ngIf"],["name","checkmark-outline","slot","start"]],template:function(o,e){1&o&&(t.nrm(0,"app-header",0),t.j41(1,"ion-content",1)(2,"ion-card",2)(3,"ion-card-header")(4,"h2",3),t.EFF(5,"M\xe9todo de Pago"),t.k0s()(),t.j41(6,"ion-card-content")(7,"ion-radio-group",4),t.bIt("ionChange",function(r){return e.onPaymentChange(r.detail.value)}),t.j41(8,"ion-card",5),t.bIt("click",function(){return e.onPaymentChange("efectivo")}),t.j41(9,"ion-item"),t.nrm(10,"ion-icon",6),t.j41(11,"ion-label"),t.EFF(12,"Efectivo en Negocio"),t.k0s(),t.nrm(13,"ion-radio",7),t.k0s()(),t.j41(14,"ion-card",5),t.bIt("click",function(){return e.onPaymentChange("paypal")}),t.j41(15,"ion-item"),t.nrm(16,"ion-icon",8),t.j41(17,"ion-label"),t.EFF(18,"Tarjeta"),t.k0s(),t.nrm(19,"ion-radio",9),t.k0s()()()()(),t.j41(20,"ion-card",10)(21,"ion-card-header")(22,"h3",11),t.EFF(23,"Resumen de compra"),t.k0s()(),t.j41(24,"ion-card-content")(25,"div",12)(26,"span"),t.EFF(27),t.k0s(),t.j41(28,"span"),t.EFF(29),t.nI1(30,"currency"),t.k0s()(),t.DNE(31,H,6,5,"div",13),t.nrm(32,"div",14),t.DNE(33,q,6,3,"div",15)(34,Z,6,4,"div",15)(35,K,6,3,"div",15)(36,tt,6,3,"div",15),t.k0s()(),t.DNE(37,ot,2,0,"div",16)(38,nt,4,5,"div",17),t.k0s()),2&o&&(t.Y8G("isModal",!0),t.R7$(),t.Y8G("fullscreen",!0),t.R7$(7),t.AVh("selected","efectivo"===e.selectedPayment),t.R7$(6),t.AVh("selected","paypal"===e.selectedPayment),t.R7$(13),t.SpI("Productos (",(null==e.cart||null==e.cart.detalle_carrito?null:e.cart.detalle_carrito.length)||0,")"),t.R7$(2),t.JRh(t.bMT(30,15,null==e.cart?null:e.cart.total)),t.R7$(2),t.Y8G("ngForOf",null==e.cart?null:e.cart.detalle_carrito),t.R7$(2),t.Y8G("ngIf",e.discountAmount>0),t.R7$(),t.Y8G("ngIf",e.discountAmount>0),t.R7$(),t.Y8G("ngIf",e.discountAmount>0),t.R7$(),t.Y8G("ngIf",0===e.discountAmount),t.R7$(),t.Y8G("ngIf","tarjeta"===e.selectedPayment),t.R7$(),t.Y8G("ngIf","efectivo"===e.selectedPayment))},dependencies:[y.Sq,y.bT,l.Jm,l.b_,l.I9,l.ME,l.W9,l.iq,l.uz,l.he,l.KO,l.f0,l.uR,l.Je,x.l,y.QX,y.oe],styles:['@charset "UTF-8";.payment-card[_ngcontent-%COMP%], .summary-card[_ngcontent-%COMP%]{margin:16px;border-radius:16px;box-shadow:0 4px 8px #0000001a}.title[_ngcontent-%COMP%], .summary-title[_ngcontent-%COMP%]{font-size:1.2rem;font-weight:700;text-align:center;color:var(--ion-color-primary)}.option-card[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:16px;transition:transform .2s ease,background-color .3s ease}.option-card.selected[_ngcontent-%COMP%]{transform:scale(1.05);background-color:var(--ion-color-primary-tint)}.option-icon[_ngcontent-%COMP%]{font-size:2rem;color:var(--ion-color-primary);margin-right:8px}.summary-card[_ngcontent-%COMP%]{background-color:#f8f9fa;color:#343a40}.summary-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:12px 0;font-size:1rem}.divider[_ngcontent-%COMP%]{border-bottom:1px solid #dee2e6;margin:8px 0}.confirm-button-container[_ngcontent-%COMP%], .confirm-button-container-paypal[_ngcontent-%COMP%]{margin:16px}.confirm-button[_ngcontent-%COMP%]{--background: var(--ion-color-primary);color:#fff;font-weight:700;border-radius:24px;text-align:center;position:relative;overflow:hidden;transition:background-color .3s ease-in-out}.complete[_ngcontent-%COMP%]{--background: var(--ion-color-primary);color:#fff;font-weight:700;border-radius:24px;text-align:center;position:relative;overflow:hidden}.confirm-button.animated[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;height:100%;width:0%;background:linear-gradient(to right,var(--ion-color-primary),var(--ion-color-secondary),var(--ion-color-tertiary));z-index:1;animation:_ngcontent-%COMP%_slideIn 3s forwards}.confirm-button.animated[_ngcontent-%COMP%]{color:transparent}.confirm-button.animated[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#fff}.confirm-button.complete[_ngcontent-%COMP%]{--background: var(--ion-color-primary)}@keyframes _ngcontent-%COMP%_slideIn{0%{width:0%}50%{width:100%}to{width:0%}}.total-summary[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start}.total-summary[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin:4px 0}.discounted-price[_ngcontent-%COMP%]{color:green;font-weight:700}.original-price[_ngcontent-%COMP%]{color:gray;text-decoration:line-through;font-size:17px}.descuento[_ngcontent-%COMP%]{font-weight:700;font-size:17px}']}),c})();var at=v(9365);function rt(n,c){1&n&&(t.j41(0,"div",53),t.nrm(1,"ion-icon",54),t.k0s())}function ct(n,c){1&n&&(t.j41(0,"div",53),t.nrm(1,"ion-icon",54),t.k0s())}function lt(n,c){if(1&n&&(t.j41(0,"div",38)(1,"span",55),t.nrm(2,"ion-icon",56),t.EFF(3),t.k0s(),t.j41(4,"span",57),t.EFF(5),t.nI1(6,"currency"),t.k0s()()),2&n){const i=t.XpG();t.R7$(3),t.SpI(" Descuento (",i.porcentaje,"%) "),t.R7$(2),t.SpI("-",t.bMT(6,2,i.discountAmount),"")}}function dt(n,c){if(1&n&&(t.j41(0,"div",58),t.nrm(1,"ion-icon",59),t.j41(2,"span"),t.EFF(3),t.nI1(4,"currency"),t.k0s()()),2&n){const i=t.XpG();t.R7$(3),t.SpI("\xa1Ahorras ",t.bMT(4,1,i.discountAmount),"!")}}function st(n,c){if(1&n&&(t.j41(0,"div",60),t.nrm(1,"ion-icon",61),t.j41(2,"span"),t.EFF(3),t.k0s()()),2&n){const i=t.XpG();t.R7$(),t.Y8G("name","negocio"===i.selectedMethod?"storefront-outline":"bicycle-outline"),t.R7$(2),t.JRh("negocio"===i.selectedMethod?"Recoger en tienda":"Entrega a domicilio")}}const pt=[{path:"",component:(()=>{var n;class c{constructor(o,e){this.router=o,this.utilsSvc=e,this.selectedMethod="",this.selectedDate="",this.selectedTime="",this.discountAmount=0,this.porcentaje=0,this.minDate=(new Date).toISOString(),this.selectedDate=(new Date).toISOString(),this.selectedTime=(new Date).toISOString()}ngOnInit(){this.getCartDetails(),this.applyStoredCoupon()}onMethodChange(o){this.selectedMethod=o}continue(){var o=this;return(0,f.A)(function*(){o.selectedMethod&&o.selectedDate&&o.selectedTime&&(o.utilsSvc.saveInLocalStorage("selectedMethod",o.selectedMethod),o.cart.fecha_entrega=o.selectedDate,o.cart.hora_entrega=o.selectedTime,o.utilsSvc.saveInLocalStorage("carrito_negocio",[o.cart]),console.log("M\xe9todo seleccionado:",o.selectedMethod),console.log("Fecha seleccionada:",o.selectedDate),console.log("Hora seleccionada:",o.selectedTime),console.log("Carrito:",o.cart),"negocio"===o.selectedMethod?(yield o.utilsSvc.presentModal({component:it,componentProps:{}}))&&o.utilsSvc.dismissModal(!0):"domicilio"===o.selectedMethod&&(yield o.utilsSvc.presentModal({component:at.H,componentProps:{}}))&&(yield o.utilsSvc.presentModal({component:Q,componentProps:{}}))&&o.utilsSvc.dismissModal(!0))})()}getCartDetails(){this.cart=this.utilsSvc.getFromLocalStorage("carrito_negocio")[0]}applyStoredCoupon(){if(this.cart){const o=this.utilsSvc.getFromLocalStorage("appliedCoupon");o&&(this.discountAmount=this.cart.total*o.porcentaje/100,this.porcentaje=o.porcentaje)}}getTotalAmount(){return this.cart?this.discountAmount>0?this.cart.total-this.discountAmount:this.cart.total:0}}return(n=c).\u0275fac=function(o){return new(o||n)(t.rXU(E.Ix),t.rXU(F.T))},n.\u0275cmp=t.VBU({type:n,selectors:[["app-metodo-entrega-negocio"]],decls:101,vars:22,consts:[["title","M\xe9todo de entrega",3,"showMenu"],[3,"fullscreen"],[1,"container"],[1,"hero-section"],["name","fast-food-outline",1,"hero-icon"],[1,"hero-title"],[1,"hero-subtitle"],[1,"content-grid"],[1,"delivery-section"],[1,"delivery-options"],[1,"delivery-option",3,"click"],[1,"option-header"],[1,"option-icon-wrapper"],["name","storefront",1,"option-main-icon"],["class","option-badge",4,"ngIf"],[1,"option-content"],[1,"option-features"],[1,"feature"],["name","time-outline"],["name","cash-outline"],["name","bicycle",1,"option-main-icon"],["name","location-outline"],[1,"date-section"],[1,"date-card"],[1,"date-header"],["name","calendar-outline",1,"date-icon"],["presentation","date","locale","es-ES",1,"custom-datetime",3,"ngModelChange","ngModel","min"],[1,"time-section"],[1,"time-card"],[1,"time-header"],["name","time-outline",1,"time-icon"],["presentation","time","locale","es-ES",1,"custom-datetime",3,"ngModelChange","ngModel"],[1,"summary-section"],[1,"summary-card"],[1,"summary-header"],["name","receipt-outline",1,"summary-icon"],[1,"summary-content"],[1,"order-details"],[1,"detail-row"],[1,"detail-label"],["name","bag-outline"],[1,"detail-value"],["class","detail-row",4,"ngIf"],[1,"summary-divider"],[1,"total-section"],[1,"total-row"],[1,"total-label"],[1,"total-amount"],["class","savings",4,"ngIf"],[1,"footer-content"],["class","selected-method",4,"ngIf"],["expand","block","size","large",1,"continue-button",3,"click","disabled"],["name","arrow-forward-outline","slot","end"],[1,"option-badge"],["name","checkmark-circle"],[1,"detail-label","discount-label"],["name","pricetag-outline"],[1,"detail-value","discount-value"],[1,"savings"],["name","happy-outline"],[1,"selected-method"],[3,"name"]],template:function(o,e){1&o&&(t.nrm(0,"app-header",0),t.j41(1,"ion-content",1)(2,"div",2)(3,"div",3),t.nrm(4,"ion-icon",4),t.j41(5,"h1",5),t.EFF(6,"\xbfC\xf3mo quieres recibir tu pedido?"),t.k0s(),t.j41(7,"p",6),t.EFF(8,"Elige la opci\xf3n que mejor se adapte a ti"),t.k0s()(),t.j41(9,"div",7)(10,"div",8)(11,"div",9)(12,"div",10),t.bIt("click",function(){return e.onMethodChange("negocio")}),t.j41(13,"div",11)(14,"div",12),t.nrm(15,"ion-icon",13),t.k0s(),t.DNE(16,rt,2,0,"div",14),t.k0s(),t.j41(17,"div",15)(18,"h3"),t.EFF(19,"Recoger en tienda"),t.k0s(),t.j41(20,"p"),t.EFF(21,"Retira tu pedido directamente en nuestro local"),t.k0s(),t.j41(22,"div",16)(23,"div",17),t.nrm(24,"ion-icon",18),t.j41(25,"span"),t.EFF(26,"15-20 min"),t.k0s()(),t.j41(27,"div",17),t.nrm(28,"ion-icon",19),t.j41(29,"span"),t.EFF(30,"Sin costo"),t.k0s()()()()(),t.j41(31,"div",10),t.bIt("click",function(){return e.onMethodChange("domicilio")}),t.j41(32,"div",11)(33,"div",12),t.nrm(34,"ion-icon",20),t.k0s(),t.DNE(35,ct,2,0,"div",14),t.k0s(),t.j41(36,"div",15)(37,"h3"),t.EFF(38,"Entrega a domicilio"),t.k0s(),t.j41(39,"p"),t.EFF(40,"Recibe tu pedido en la comodidad de tu hogar"),t.k0s(),t.j41(41,"div",16)(42,"div",17),t.nrm(43,"ion-icon",18),t.j41(44,"span"),t.EFF(45,"30-45 min"),t.k0s()(),t.j41(46,"div",17),t.nrm(47,"ion-icon",21),t.j41(48,"span"),t.EFF(49,"A tu puerta"),t.k0s()()()()()(),t.j41(50,"div",22)(51,"div",23)(52,"div",24),t.nrm(53,"ion-icon",25),t.j41(54,"h3"),t.EFF(55,"Fecha de entrega"),t.k0s()(),t.j41(56,"ion-datetime",26),t.mxI("ngModelChange",function(r){return t.DH7(e.selectedDate,r)||(e.selectedDate=r),r}),t.k0s()()(),t.j41(57,"div",27)(58,"div",28)(59,"div",29),t.nrm(60,"ion-icon",30),t.j41(61,"h3"),t.EFF(62,"Hora de entrega"),t.k0s()(),t.j41(63,"ion-datetime",31),t.mxI("ngModelChange",function(r){return t.DH7(e.selectedTime,r)||(e.selectedTime=r),r}),t.k0s()()()(),t.j41(64,"div",32)(65,"div",33)(66,"div",34),t.nrm(67,"ion-icon",35),t.j41(68,"h3"),t.EFF(69,"Resumen del pedido"),t.k0s()(),t.j41(70,"div",36)(71,"div",37)(72,"div",38)(73,"span",39),t.nrm(74,"ion-icon",40),t.EFF(75," Productos "),t.k0s(),t.j41(76,"span",41),t.EFF(77),t.k0s()(),t.j41(78,"div",38)(79,"span",39),t.EFF(80,"Subtotal"),t.k0s(),t.j41(81,"span",41),t.EFF(82),t.nI1(83,"currency"),t.k0s()(),t.DNE(84,lt,7,4,"div",42),t.k0s(),t.nrm(85,"div",43),t.j41(86,"div",44)(87,"div",45)(88,"span",46),t.EFF(89,"Total a pagar"),t.k0s(),t.j41(90,"span",47),t.EFF(91),t.nI1(92,"currency"),t.k0s()(),t.DNE(93,dt,5,3,"div",48),t.k0s()()()()()()(),t.j41(94,"ion-footer")(95,"ion-toolbar")(96,"div",49),t.DNE(97,st,4,2,"div",50),t.j41(98,"ion-button",51),t.bIt("click",function(){return e.continue()}),t.nrm(99,"ion-icon",52),t.EFF(100," Continuar con el pedido "),t.k0s()()()()),2&o&&(t.Y8G("showMenu",!0),t.R7$(),t.Y8G("fullscreen",!0),t.R7$(11),t.AVh("selected","negocio"===e.selectedMethod),t.R7$(4),t.Y8G("ngIf","negocio"===e.selectedMethod),t.R7$(15),t.AVh("selected","domicilio"===e.selectedMethod),t.R7$(4),t.Y8G("ngIf","domicilio"===e.selectedMethod),t.R7$(21),t.R50("ngModel",e.selectedDate),t.Y8G("min",e.minDate),t.R7$(7),t.R50("ngModel",e.selectedTime),t.R7$(14),t.SpI("",(null==e.cart||null==e.cart.detalle_carrito?null:e.cart.detalle_carrito.length)||0," items"),t.R7$(5),t.JRh(t.bMT(83,18,null==e.cart?null:e.cart.total)),t.R7$(2),t.Y8G("ngIf",e.discountAmount>0),t.R7$(7),t.JRh(t.bMT(92,20,e.getTotalAmount())),t.R7$(2),t.Y8G("ngIf",e.discountAmount>0),t.R7$(4),t.Y8G("ngIf",e.selectedMethod),t.R7$(),t.Y8G("disabled",!e.selectedMethod||!e.selectedDate||!e.selectedTime))},dependencies:[y.bT,O.BC,O.vS,l.Jm,l.W9,l.A9,l.M0,l.iq,l.ai,l.Je,x.l,y.oe],styles:['ion-content[_ngcontent-%COMP%]{--background: linear-gradient(135deg, #a3a3a3 0%, #e2e2e2 100%);--padding-start: 0;--padding-end: 0}.container[_ngcontent-%COMP%]{min-height:100vh;padding:0 16px 100px}.hero-section[_ngcontent-%COMP%]{text-align:center;padding:40px 20px;color:#fff}.hero-section[_ngcontent-%COMP%]   .hero-icon[_ngcontent-%COMP%]{font-size:4rem;margin-bottom:16px;opacity:.9}.hero-section[_ngcontent-%COMP%]   .hero-title[_ngcontent-%COMP%]{font-size:1.8rem;font-weight:700;margin:0 0 8px;text-shadow:0 2px 4px rgba(0,0,0,.3)}.hero-section[_ngcontent-%COMP%]   .hero-subtitle[_ngcontent-%COMP%]{font-size:1rem;opacity:.9;margin:0;font-weight:400}.content-grid[_ngcontent-%COMP%]{display:grid;gap:24px;max-width:1200px;margin:0 auto}@media (min-width: 768px){.content-grid[_ngcontent-%COMP%]{grid-template-columns:2fr 1fr;gap:32px}}.delivery-section[_ngcontent-%COMP%]   .delivery-options[_ngcontent-%COMP%]{display:grid;gap:20px;margin-bottom:24px}@media (min-width: 480px){.delivery-section[_ngcontent-%COMP%]   .delivery-options[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr;gap:16px}}@media (min-width: 768px){.delivery-section[_ngcontent-%COMP%]   .delivery-options[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:20px}}.delivery-option[_ngcontent-%COMP%]{background:#fff;border-radius:20px;padding:24px;cursor:pointer;transition:all .3s cubic-bezier(.4,0,.2,1);border:3px solid transparent;box-shadow:0 8px 32px #0000001a;position:relative;overflow:hidden}.delivery-option[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background:linear-gradient(135deg,#667eea0d,#764ba20d);opacity:0;transition:opacity .3s ease}.delivery-option[_ngcontent-%COMP%]:hover{transform:translateY(-4px);box-shadow:0 16px 48px #00000026}.delivery-option[_ngcontent-%COMP%]:hover:before{opacity:1}.delivery-option[_ngcontent-%COMP%]:hover   .option-main-icon[_ngcontent-%COMP%]{transform:scale(1.1)}.delivery-option.selected[_ngcontent-%COMP%]{border-color:var(--ion-color-primary);transform:translateY(-2px);box-shadow:0 12px 40px rgba(var(--ion-color-primary-rgb),.3)}.delivery-option.selected[_ngcontent-%COMP%]:before{opacity:1;background:linear-gradient(135deg,rgba(var(--ion-color-primary-rgb),.1),rgba(var(--ion-color-secondary-rgb),.1))}.delivery-option.selected[_ngcontent-%COMP%]   .option-main-icon[_ngcontent-%COMP%]{color:var(--ion-color-primary);transform:scale(1.05)}.delivery-option.selected[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:var(--ion-color-primary)}.option-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;position:relative;z-index:1}.option-icon-wrapper[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:50%;background:linear-gradient(135deg,#f8f9fa,#e9ecef);display:flex;align-items:center;justify-content:center;box-shadow:0 4px 12px #0000001a}.option-main-icon[_ngcontent-%COMP%]{font-size:1.8rem;color:var(--ion-color-medium);transition:all .3s ease}.option-badge[_ngcontent-%COMP%]{width:32px;height:32px;background:var(--ion-color-success);border-radius:50%;display:flex;align-items:center;justify-content:center}.option-badge[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#fff;font-size:1.2rem}.option-content[_ngcontent-%COMP%]{position:relative;z-index:1}.option-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.3rem;font-weight:700;margin:0 0 8px;color:var(--ion-color-dark);transition:color .3s ease}.option-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--ion-color-medium);font-size:.95rem;margin:0 0 16px;line-height:1.4}.option-features[_ngcontent-%COMP%]{display:flex;gap:16px}.option-features[_ngcontent-%COMP%]   .feature[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;font-size:.85rem;color:var(--ion-color-medium)}.option-features[_ngcontent-%COMP%]   .feature[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1rem;color:var(--ion-color-primary)}.date-section[_ngcontent-%COMP%]{margin-top:24px}.date-card[_ngcontent-%COMP%]{background:#fff;border-radius:20px;padding:24px;box-shadow:0 8px 32px #0000001a}.date-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin-bottom:20px}.date-header[_ngcontent-%COMP%]   .date-icon[_ngcontent-%COMP%]{font-size:1.5rem;color:var(--ion-color-primary)}.date-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.2rem;font-weight:600;color:var(--ion-color-dark)}.time-section[_ngcontent-%COMP%]{margin-top:24px}.time-card[_ngcontent-%COMP%]{background:#fff;border-radius:20px;padding:24px;box-shadow:0 8px 32px #0000001a}.time-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin-bottom:20px}.time-header[_ngcontent-%COMP%]   .time-icon[_ngcontent-%COMP%]{font-size:1.5rem;color:var(--ion-color-secondary)}.time-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.2rem;font-weight:600;color:var(--ion-color-dark)}.custom-datetime[_ngcontent-%COMP%]{width:100%;--background: var(--ion-color-light);--color: var(--ion-color-primary);--border-radius: 12px;--padding: 16px;--box-shadow: 0px 4px 8px rgba(0, 0, 0, .1)}@media (max-width: 767px){.summary-section[_ngcontent-%COMP%]{order:-1}}.summary-card[_ngcontent-%COMP%]{background:#fff;border-radius:20px;overflow:hidden;box-shadow:0 8px 32px #0000001a;position:sticky;top:20px}.summary-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--ion-color-primary) 0%,var(--ion-color-secondary) 100%);color:#fff;padding:20px 24px;display:flex;align-items:center;gap:12px}.summary-header[_ngcontent-%COMP%]   .summary-icon[_ngcontent-%COMP%]{font-size:1.5rem}.summary-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.2rem;font-weight:600}.summary-content[_ngcontent-%COMP%]{padding:24px}.order-details[_ngcontent-%COMP%]{margin-bottom:20px}.detail-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:12px 0;border-bottom:1px solid #f0f0f0}.detail-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.detail-row[_ngcontent-%COMP%]   .detail-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;color:var(--ion-color-medium);font-size:.95rem}.detail-row[_ngcontent-%COMP%]   .detail-label[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1rem;color:var(--ion-color-primary)}.detail-row[_ngcontent-%COMP%]   .detail-label.discount-label[_ngcontent-%COMP%]{color:var(--ion-color-warning);font-weight:600}.detail-row[_ngcontent-%COMP%]   .detail-value[_ngcontent-%COMP%]{font-weight:600;color:var(--ion-color-dark)}.detail-row[_ngcontent-%COMP%]   .detail-value.discount-value[_ngcontent-%COMP%]{color:var(--ion-color-warning)}.summary-divider[_ngcontent-%COMP%]{height:2px;background:linear-gradient(to right,transparent,var(--ion-color-primary),transparent);margin:16px 0;border-radius:2px}.total-section[_ngcontent-%COMP%]   .total-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:16px 0}.total-section[_ngcontent-%COMP%]   .total-row[_ngcontent-%COMP%]   .total-label[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:600;color:var(--ion-color-dark)}.total-section[_ngcontent-%COMP%]   .total-row[_ngcontent-%COMP%]   .total-amount[_ngcontent-%COMP%]{font-size:1.4rem;font-weight:700;color:var(--ion-color-primary)}.total-section[_ngcontent-%COMP%]   .savings[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:12px 16px;background:linear-gradient(135deg,rgba(var(--ion-color-success-rgb),.1),rgba(var(--ion-color-success-rgb),.05));border-radius:12px;margin-top:12px}.total-section[_ngcontent-%COMP%]   .savings[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:var(--ion-color-success);font-size:1.2rem}.total-section[_ngcontent-%COMP%]   .savings[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--ion-color-success);font-weight:600;font-size:.9rem}ion-footer[_ngcontent-%COMP%]{background:#fff;border-top:1px solid #f0f0f0}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background: transparent;--padding-start: 16px;--padding-end: 16px;--padding-top: 16px;--padding-bottom: 16px}.footer-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.selected-method[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:8px 16px;background:rgba(var(--ion-color-primary-rgb),.1);border-radius:8px;font-size:.9rem;color:var(--ion-color-primary);font-weight:600}.selected-method[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1rem}.continue-button[_ngcontent-%COMP%]{--border-radius: 16px;--padding-start: 24px;--padding-end: 24px;height:56px;font-size:1.1rem;font-weight:600;background:linear-gradient(135deg,var(--ion-color-primary) 0%,var(--ion-color-secondary) 100%);box-shadow:0 4px 16px rgba(var(--ion-color-primary-rgb),.4);transition:all .3s ease}.continue-button[_ngcontent-%COMP%]:not([disabled]):hover{transform:translateY(-2px);box-shadow:0 8px 24px rgba(var(--ion-color-primary-rgb),.5)}.continue-button[disabled][_ngcontent-%COMP%]{opacity:.5;background:var(--ion-color-medium);box-shadow:none}.continue-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1.2rem}@keyframes _ngcontent-%COMP%_slideInUp{0%{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}.delivery-option[_ngcontent-%COMP%], .date-card[_ngcontent-%COMP%], .summary-card[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideInUp .6s ease-out}.delivery-option[_ngcontent-%COMP%]:nth-child(1){animation-delay:.1s}.delivery-option[_ngcontent-%COMP%]:nth-child(2){animation-delay:.2s}.date-card[_ngcontent-%COMP%]{animation-delay:.3s}.time-card[_ngcontent-%COMP%]{animation-delay:.4s}@media (max-width: 480px){.container[_ngcontent-%COMP%]{padding:0 12px 100px}.hero-section[_ngcontent-%COMP%]{padding:30px 16px}.hero-section[_ngcontent-%COMP%]   .hero-title[_ngcontent-%COMP%]{font-size:1.5rem}.hero-section[_ngcontent-%COMP%]   .hero-icon[_ngcontent-%COMP%]{font-size:3rem}.delivery-option[_ngcontent-%COMP%], .date-card[_ngcontent-%COMP%], .time-card[_ngcontent-%COMP%]{padding:20px}.option-features[_ngcontent-%COMP%]{flex-direction:column;gap:8px}.summary-content[_ngcontent-%COMP%]{padding:20px}}']}),c})()}];let ut=(()=>{var n;class c{}return(n=c).\u0275fac=function(o){return new(o||n)},n.\u0275mod=t.$C({type:n}),n.\u0275inj=t.G2t({imports:[E.iI.forChild(pt),E.iI]}),c})();var gt=v(7383);let mt=(()=>{var n;class c{}return(n=c).\u0275fac=function(o){return new(o||n)},n.\u0275mod=t.$C({type:n}),n.\u0275inj=t.G2t({imports:[y.MD,O.YN,l.bv,ut,gt.G]}),c})()}}]);