"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1517],{1517:(D,U,l)=>{l.d(U,{r:()=>$});var n=l(467),e=l(4438),i=l(9417),E=l(8663),C=l(2723),h=l(177),p=l(5933),m=l(8461),f=l(8827);function u(o,a){if(1&o&&(e.j41(0,"ion-avatar"),e.nrm(1,"img",15),e.k0s()),2&o){const s=e.XpG();e.R7$(),e.Y8G("src",s.form.value.image,e.B4B)}}function _(o,a){1&o&&e.nrm(0,"ion-icon",16)}function c(o,a){1&o&&(e.j41(0,"div"),e.EFF(1,"Este campo es requerido"),e.k0s())}function R(o,a){1&o&&(e.j41(0,"div"),e.EFF(1,"El nombre debe tener al menos 4 caracteres"),e.k0s())}function k(o,a){if(1&o&&(e.j41(0,"div",17),e.DNE(1,c,2,0,"div",2)(2,R,2,0,"div",2),e.k0s()),2&o){const s=e.XpG();e.R7$(),e.Y8G("ngIf",null==s.form.controls.name.errors?null:s.form.controls.name.errors.required),e.R7$(),e.Y8G("ngIf",null==s.form.controls.name.errors?null:s.form.controls.name.errors.minlength)}}function M(o,a){1&o&&(e.j41(0,"div"),e.EFF(1,"Este campo es requerido"),e.k0s())}function P(o,a){if(1&o&&(e.j41(0,"div",17),e.DNE(1,M,2,0,"div",2),e.k0s()),2&o){const s=e.XpG();e.R7$(),e.Y8G("ngIf",null==s.form.controls.father_Last_Name.errors?null:s.form.controls.father_Last_Name.errors.required)}}function N(o,a){1&o&&(e.j41(0,"div"),e.EFF(1,"Este campo es requerido"),e.k0s())}function Y(o,a){if(1&o&&(e.j41(0,"div",17),e.DNE(1,N,2,0,"div",2),e.k0s()),2&o){const s=e.XpG();e.R7$(),e.Y8G("ngIf",null==s.form.controls.mother_Last_Name.errors?null:s.form.controls.mother_Last_Name.errors.required)}}function F(o,a){1&o&&(e.j41(0,"div"),e.EFF(1,"Este campo es requerido"),e.k0s())}function O(o,a){1&o&&(e.j41(0,"div"),e.EFF(1,"Correo no v\xe1lido"),e.k0s())}function w(o,a){if(1&o&&(e.j41(0,"div",17),e.DNE(1,F,2,0,"div",2)(2,O,2,0,"div",2),e.k0s()),2&o){const s=e.XpG();e.R7$(),e.Y8G("ngIf",null==s.form.controls.email.errors?null:s.form.controls.email.errors.required),e.R7$(),e.Y8G("ngIf",null==s.form.controls.email.errors?null:s.form.controls.email.errors.email)}}function j(o,a){1&o&&(e.j41(0,"div"),e.EFF(1,"Este campo es requerido"),e.k0s())}function L(o,a){if(1&o&&(e.j41(0,"div",17),e.DNE(1,j,2,0,"div",2),e.k0s()),2&o){const s=e.XpG();e.R7$(),e.Y8G("ngIf",null==s.form.controls.type_profile.errors?null:s.form.controls.type_profile.errors.required)}}function S(o,a){1&o&&(e.j41(0,"div"),e.EFF(1,"Este campo es requerido"),e.k0s())}function B(o,a){1&o&&(e.j41(0,"div"),e.EFF(1,"Contrase\xf1a no v\xe1lida"),e.k0s())}function W(o,a){if(1&o&&(e.j41(0,"div",17),e.DNE(1,S,2,0,"div",2)(2,B,2,0,"div",2),e.k0s()),2&o){const s=e.XpG();e.R7$(),e.Y8G("ngIf",null==s.form.controls.password_Change.errors?null:s.form.controls.password_Change.errors.required),e.R7$(),e.Y8G("ngIf",null==s.form.controls.password_Change.errors?null:s.form.controls.password_Change.errors.minlength)}}let $=(()=>{var o;class a{constructor(){this.user=null,this.dataSelect=[],this.form=new i.gE({uid:new i.MJ(""),active_user:new i.MJ("1"),name:new i.MJ("",[i.k0.required,i.k0.minLength(4)]),father_Last_Name:new i.MJ("",[i.k0.required]),mother_Last_Name:new i.MJ("",[i.k0.required]),email:new i.MJ("",[i.k0.required,i.k0.email]),email_verified:new i.MJ("1"),type_profile:new i.MJ(null,[i.k0.required]),password_Change:new i.MJ("",[i.k0.minLength(4)]),image:new i.MJ("")}),this.firebaseSvc=(0,e.WQX)(E.f),this.utilSvc=(0,e.WQX)(C.T)}ngOnInit(){if(this.user){const t=this.getPermissions(this.user.type_profile);this.form.patchValue({...this.user,type_profile:t})}}takePicture(){var t=this;return(0,n.A)(function*(){const r=(yield t.utilSvc.takePicture("Imagen del usuario")).dataUrl;t.form.controls.image.setValue(r)})()}submit(){var t=this;return(0,n.A)(function*(){t.form.valid?t.user?yield t.updateUser():yield t.createUser():t.utilSvc.presentToast({message:"Por favor, completa todos los campos requeridos.",duration:2e3,color:"warning",position:"top"})})()}createUser(){var t=this;return(0,n.A)(function*(){const r=yield t.utilSvc.loading();yield r.present();try{let d="";if(t.form.value.image){const g=`users/${Date.now()}`;d=yield t.firebaseSvc.uploadImage(g,t.form.value.image)}const v={...t.form.value,image:d,type_profile:Number(t.form.value.type_profile)};yield t.firebaseSvc.addDocumentWithUid("users",v),t.utilSvc.presentToast({message:"Usuario creado exitosamente.",duration:1500,color:"success"}),t.utilSvc.dismissModal({success:!0})}catch(d){t.utilSvc.presentToast({message:"Error al crear usuario.",duration:2e3,color:"danger"}),console.error(d)}finally{r.dismiss()}})()}updateUser(){var t=this;return(0,n.A)(function*(){const r=yield t.utilSvc.loading();yield r.present();try{var d,v,g,y,I;const J=`users/${null===(d=t.form.get("uid"))||void 0===d?void 0:d.value}`;let G=null===(v=t.user)||void 0===v?void 0:v.image;if(null!==(g=t.form.get("image"))&&void 0!==g&&g.value&&(null===(y=t.form.get("image"))||void 0===y?void 0:y.value)!==(null===(I=t.user)||void 0===I?void 0:I.image)){var T;const K=`users/${Date.now()}`;G=yield t.firebaseSvc.uploadImage(K,null===(T=t.form.get("image"))||void 0===T?void 0:T.value)}const b={...t.form.value,image:G};delete b.uid,yield t.firebaseSvc.updateDocumet(J,b),t.utilSvc.presentToast({message:"Usuario actualizado exitosamente.",duration:1500,color:"success"}),t.utilSvc.dismissModal({success:!0})}catch(A){t.utilSvc.presentToast({message:"Error al actualizar usuario.",duration:2e3,color:"danger"}),console.error(A)}finally{r.dismiss()}})()}getPermissions(t){let r;switch(t){case"Super administrador":r=1;break;case"Administrador":r=2;break;default:r=3}}}return(o=a).\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.VBU({type:o,selectors:[["app-add-update-user"]],inputs:{user:"user"},decls:29,vars:21,consts:[[3,"isModal","title"],[1,"ion-padding","ion-text-center",3,"ngSubmit","keypress.enter","formGroup"],[4,"ngIf"],["class","image-icon","name","image-outline",4,"ngIf"],["size","small","shape","round",3,"click"],["autocomplete","name","type","text","label","Nombre",3,"control"],["class","validators",4,"ngIf"],["autocomplete","father_Last_Name","type","text","label","Apellido paterno",3,"control"],["autocomplete","mother_Last_Name","type","text","label","Apellido materno",3,"control"],["autocomplete","off","autocorrect","off","type","email","label","Correo",3,"control"],["formControlName","type_profile","justify","space-between","label","Tipo de usuario","fill","outline","placeholder","Seleccione un rol"],[3,"value"],["autocomplete","off","autocorrect","off","type","password","label","Contrase\xf1a",3,"control"],["mode","ios","type","submit",1,"submit",3,"disabled"],["slot","end","name","checkmark-circle-outline"],[3,"src"],["name","image-outline",1,"image-icon"],[1,"validators"]],template:function(t,r){1&t&&(e.nrm(0,"app-header",0),e.j41(1,"ion-content")(2,"form",1),e.bIt("ngSubmit",function(){return r.submit()})("keypress.enter",function(){return r.submit()}),e.DNE(3,u,2,1,"ion-avatar",2)(4,_,1,0,"ion-icon",3),e.nrm(5,"br"),e.j41(6,"ion-button",4),e.bIt("click",function(){return r.takePicture()}),e.EFF(7," Tomar/Seleccionar "),e.k0s(),e.nrm(8,"app-custom-input",5),e.DNE(9,k,3,2,"div",6),e.nrm(10,"app-custom-input",7),e.DNE(11,P,2,1,"div",6),e.nrm(12,"app-custom-input",8),e.DNE(13,Y,2,1,"div",6),e.nrm(14,"app-custom-input",9),e.DNE(15,w,3,2,"div",6),e.j41(16,"ion-select",10)(17,"ion-select-option",11),e.EFF(18,"Super Administrador"),e.k0s(),e.j41(19,"ion-select-option",11),e.EFF(20,"Administrador"),e.k0s(),e.j41(21,"ion-select-option",11),e.EFF(22,"Cliente"),e.k0s()(),e.DNE(23,L,2,1,"div",6),e.nrm(24,"app-custom-input",12),e.DNE(25,W,3,2,"div",6),e.j41(26,"ion-button",13),e.EFF(27),e.nrm(28,"ion-icon",14),e.k0s()()()),2&t&&(e.Y8G("isModal",!0)("title",r.user?"Actualizar usuario":"Agregar usuario"),e.R7$(2),e.Y8G("formGroup",r.form),e.R7$(),e.Y8G("ngIf",r.form.value.image),e.R7$(),e.Y8G("ngIf",!r.form.value.image),e.R7$(4),e.Y8G("control",r.form.controls.name),e.R7$(),e.Y8G("ngIf",r.form.controls.name.errors&&r.form.controls.name.touched),e.R7$(),e.Y8G("control",r.form.controls.father_Last_Name),e.R7$(),e.Y8G("ngIf",r.form.controls.father_Last_Name.errors&&r.form.controls.father_Last_Name.touched),e.R7$(),e.Y8G("control",r.form.controls.mother_Last_Name),e.R7$(),e.Y8G("ngIf",r.form.controls.mother_Last_Name.errors&&r.form.controls.mother_Last_Name.touched),e.R7$(),e.Y8G("control",r.form.controls.email),e.R7$(),e.Y8G("ngIf",r.form.controls.email.errors&&r.form.controls.email.touched),e.R7$(2),e.Y8G("value",1),e.R7$(2),e.Y8G("value",2),e.R7$(2),e.Y8G("value",3),e.R7$(2),e.Y8G("ngIf",r.form.controls.type_profile.errors&&r.form.controls.type_profile.touched),e.R7$(),e.Y8G("control",r.form.controls.password_Change),e.R7$(),e.Y8G("ngIf",r.form.controls.password_Change.errors&&r.form.controls.password_Change.touched),e.R7$(),e.Y8G("disabled",r.form.invalid),e.R7$(),e.SpI(" ",r.user?"Actualizar usuario":"Agregar usuario"," "))},dependencies:[h.bT,p.mC,p.Jm,p.W9,p.iq,p.Nm,p.Ip,p.Je,i.qT,i.BC,i.cb,i.j4,i.JD,m.l,f.H],styles:[".image-icon[_ngcontent-%COMP%]{font-size:100px;opacity:30%}ion-avatar[_ngcontent-%COMP%]{width:200px;height:160px;--border-radius: 15px;margin:0 auto}"]}),a})()},8827:(D,U,l)=>{l.d(U,{H:()=>p});var n=l(4438),e=l(177),i=l(5933),E=l(9417);function C(m,f){if(1&m&&n.nrm(0,"ion-icon",4),2&m){const u=n.XpG();n.Y8G("name",u.icon)}}function h(m,f){if(1&m){const u=n.RV6();n.j41(0,"ion-button",5),n.bIt("click",function(){n.eBV(u);const c=n.XpG();return n.Njj(c.showOrHidePassword())}),n.nrm(1,"ion-icon",6),n.k0s()}if(2&m){const u=n.XpG();n.R7$(),n.Y8G("name",u.hide?"eye-outline":"eye-off-outline")}}let p=(()=>{var m;class f{constructor(){this.hide=!0}ngOnInit(){"password"==this.type&&(this.isPassword=!0)}showOrHidePassword(){this.hide=!this.hide,this.type=this.hide?"password":"text"}}return(m=f).\u0275fac=function(_){return new(_||m)},m.\u0275cmp=n.VBU({type:m,selectors:[["app-custom-input"]],inputs:{control:"control",type:"type",label:"label",autocomplete:"autocomplete",icon:"icon"},decls:4,vars:6,consts:[["lines","none",1,"custom-input"],["color","primary","slot","start",3,"name",4,"ngIf"],["label-placement","floating",3,"type","autocomplete","label","formControl"],["slot","end","fill","clear","shape","round",3,"click",4,"ngIf"],["color","primary","slot","start",3,"name"],["slot","end","fill","clear","shape","round",3,"click"],["slot","icon-only",3,"name"]],template:function(_,c){1&_&&(n.j41(0,"ion-item",0),n.DNE(1,C,1,1,"ion-icon",1),n.nrm(2,"ion-input",2),n.DNE(3,h,2,1,"ion-button",3),n.k0s()),2&_&&(n.R7$(),n.Y8G("ngIf",c.icon),n.R7$(),n.Y8G("type",c.type)("autocomplete",c.autocomplete)("label",c.label)("formControl",c.control),n.R7$(),n.Y8G("ngIf",c.isPassword))},dependencies:[e.bT,i.Jm,i.iq,i.$w,i.uz,i.Gw,E.BC,E.l_]}),f})()}}]);