"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2403],{2403:(x,F,b)=>{b.r(F),b.d(F,{InformePageModule:()=>A});var S=b(177),k=b(9417),u=b(5933),P=b(8265),e=b(4438),p=b(9834),g=b(2784),y=b(7517),E=b(8461);const I=[{path:"",component:(()=>{var s;class m{constructor(){this.firebaseSvc=(0,e.WQX)(y.f),this.ventasDiarias=[],this.ventasSemanales=[],this.ventasMensuales=[],this.ventasAnuales=[],this.dataSemanal=[],this.dataSemanalGastos=[]}ngOnInit(){this.renderChartDiarioK(),this.renderChartDiarioP(),this.renderChartMensual(),this.renderChartAnual(),this.loadData(),this.firebaseSvc.getGastosSemanales().subscribe({next:o=>{this.dataSemanalGastos=o,this.firebaseSvc.getGananciasSemanales().subscribe({next:r=>{this.dataSemanal=r,this.renderChart(),console.log("Ganancias Semanales:",r)},error:r=>console.error("Error al obtener ganancias semanales:",r)}),console.log("Gastos Semanales:",o)},error:o=>console.error("Error al obtener ganancias semanales:",o)})}getGastosSemanales(){this.firebaseSvc.getGastosSemanales().subscribe({next:o=>{this.dataSemanalGastos=o,this.renderChart(),console.log("Gastos Semanales:",o)},error:o=>console.error("Error al obtener ganancias semanales:",o)})}doRefresh(o){setTimeout(()=>{o.target.complete()},1e3)}renderChart(){const o=new Set([...this.dataSemanal.map(t=>t.dia),...this.dataSemanalGastos.map(t=>t.dia)]),r=Array.from(o).sort(),i=r.map(t=>{const d=this.dataSemanal.find(a=>a.dia===t);return d?d.total:0}),n=r.map(t=>{const d=this.dataSemanalGastos.find(a=>a.dia===t);return d?d.total:0});new p.t1("miGraficaSemanal",{type:"line",data:{labels:r,datasets:[{label:"Ganancias diarias",data:i,backgroundColor:"rgba(75, 192, 192, 0.2)",borderColor:"rgba(75, 192, 192, 1)",borderWidth:2,pointBackgroundColor:"rgba(75, 192, 192, 1)",tension:.4,fill:!0},{label:"Gastos diarios",data:n,backgroundColor:"rgba(255, 99, 132, 0.6)",borderColor:"rgba(255, 99, 132, 1)",borderWidth:2,pointBackgroundColor:"rgba(255, 99, 132, 1)",tension:.4,fill:!0}]},options:{responsive:!0,plugins:{legend:{position:"top"},title:{display:!0,text:"Pagos Diarios Semanales"}},scales:{x:{title:{display:!0,text:"D\xedas"}},y:{title:{display:!0,text:"Total de Pagos"},beginAtZero:!0}}}})}loadData(){}renderChartDiarioK(){this.firebaseSvc.getCollectionData("productos").subscribe(o=>{const r=o.map(a=>a.nombre),i={};r.forEach(a=>{i[a]=0});const n=new Date;n.setHours(0,0,0,0);const t=new Date;t.setDate(n.getDate()+1),t.setHours(0,0,0,0),this.firebaseSvc.getCollectionData("pedidos",[(0,g._M)("pago_confirmado","==",!0),(0,g._M)("fecha",">=",n),(0,g._M)("fecha","<",t)]).subscribe(a=>{const c=a.map(l=>l.id);for(let l=0;l<c.length;l++)this.firebaseSvc.getCollectionData(`pedidos/${c[l]}/detalle_pedido`).subscribe(v=>{v.forEach(h=>{this.firebaseSvc.getDocument(`productos/${h.uid_producto}`).then(D=>{const C=D.nombre;C in i&&(i[`${C}`]+=h.cantidad)})})})});const d=document.getElementById("ChartDiarioK");setTimeout(()=>{const a=r.map(c=>i[c]||0);this.chart=new p.t1(d,{type:"bar",data:{labels:r,datasets:[{label:"Reporte diario",data:a,backgroundColor:["rgba(255, 99, 132, 0.6)","rgba(54, 162, 235, 0.6)","rgba(255, 206, 86, 0.6)","rgba(75, 192, 192, 0.6)","rgba(153, 102, 255, 0.6)","rgba(255, 159, 64, 0.6)"],borderColor:["rgba(255, 99, 132, 1)","rgba(54, 162, 235, 1)","rgba(255, 206, 86, 1)","rgba(75, 192, 192, 1)","rgba(153, 102, 255, 1)","rgba(255, 159, 64, 1)"],borderWidth:1}]},options:{responsive:!0,scales:{y:{beginAtZero:!0,ticks:{callback:function(c){return c+" kg/bolsa"}}},x:{beginAtZero:!0}}}})},1e3)})}renderChartDiarioP(){this.firebaseSvc.getCollectionData("productos").subscribe(o=>{const r=o.map(a=>a.nombre),i={};r.forEach(a=>{i[a]=0});const n=new Date;n.setHours(0,0,0,0);const t=new Date;t.setDate(n.getDate()+1),t.setHours(0,0,0,0),this.firebaseSvc.getCollectionData("pedidos",[(0,g._M)("pago_confirmado","==",!0),(0,g._M)("fecha",">=",n),(0,g._M)("fecha","<",t)]).subscribe(a=>{const c=a.map(l=>l.id);for(let l=0;l<c.length;l++)this.firebaseSvc.getCollectionData(`pedidos/${c[l]}/detalle_pedido`).subscribe(v=>{v.forEach(h=>{this.firebaseSvc.getDocument(`productos/${h.uid_producto}`).then(D=>{const C=D.nombre;C in i&&(i[`${C}`]+=h.subtotal)})})})});const d=document.getElementById("ChartDiarioP");setTimeout(()=>{const a=r.map(c=>i[c]||0);this.chart=new p.t1(d,{type:"bar",data:{labels:r,datasets:[{label:"Reporte diario",data:a,backgroundColor:["rgba(255, 99, 132, 0.6)","rgba(54, 162, 235, 0.6)","rgba(255, 206, 86, 0.6)","rgba(75, 192, 192, 0.6)","rgba(153, 102, 255, 0.6)","rgba(255, 159, 64, 0.6)"],borderColor:["rgba(255, 99, 132, 1)","rgba(54, 162, 235, 1)","rgba(255, 206, 86, 1)","rgba(75, 192, 192, 1)","rgba(153, 102, 255, 1)","rgba(255, 159, 64, 1)"],borderWidth:1}]},options:{responsive:!0,scales:{y:{beginAtZero:!0,ticks:{callback:function(c){return"$"+c}}},x:{beginAtZero:!0}}}})},1e3)})}renderChartMensual(){const o=document.getElementById("ChartMensual"),i=((new Date).getFullYear(),["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"]),n={},t=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],d=(new Date).getFullYear();for(let a=0;a<12;a++){const c=new Date(d,a,1),l=new Date(d,a+1,1);l.setHours(0,0,0,0),n[t[a]]=0,this.firebaseSvc.getCollectionData("pedidos",[(0,g._M)("pago_confirmado","==",!0),(0,g._M)("fecha",">=",c),(0,g._M)("fecha","<",l)]).subscribe(v=>{v.forEach(h=>{n[t[a]]+=h.total||0}),console.log(`Total para ${t[a]}: ${n[t[a]]}`)})}console.log(n),setTimeout(()=>{this.chart=new p.t1(o,{type:"bar",data:{labels:i,datasets:[{label:"Reporte diario",data:n,backgroundColor:["rgba(255, 99, 132, 0.6)","rgba(54, 162, 235, 0.6)","rgba(255, 206, 86, 0.6)","rgba(75, 192, 192, 0.6)","rgba(153, 102, 255, 0.6)","rgba(255, 159, 64, 0.6)"],borderColor:["rgba(255, 99, 132, 1)","rgba(54, 162, 235, 1)","rgba(255, 206, 86, 1)","rgba(75, 192, 192, 1)","rgba(153, 102, 255, 1)","rgba(255, 159, 64, 1)"],borderWidth:1}]},options:{responsive:!0,scales:{y:{beginAtZero:!0,ticks:{callback:function(a){return"$ "+a}}},x:{beginAtZero:!0}}}})},1500)}renderChartAnual(){const o=document.getElementById("ChartAnual"),r=(new Date).getFullYear(),i=[r-2,r-1,r],n={};i.forEach(t=>{n[t]=0;const d=new Date(t,0,1),a=new Date(t+1,0,1);this.firebaseSvc.getCollectionData("pedidos",[(0,g._M)("pago_confirmado","==",!0),(0,g._M)("fecha",">=",d),(0,g._M)("fecha","<",a)]).subscribe(c=>{c.forEach(l=>{n[t]+=l.total||0}),console.log(`Total para ${t}: ${n[t]}`)})}),setTimeout(()=>{this.chart=new p.t1(o,{type:"pie",data:{labels:i.map(t=>t.toString()),datasets:[{label:"Reporte anual",data:i.map(t=>n[t]||0),backgroundColor:["rgba(255, 99, 132, 0.6)","rgba(54, 162, 235, 0.6)","rgba(255, 206, 86, 0.6)","rgba(75, 192, 192, 0.6)","rgba(153, 102, 255, 0.6)","rgba(255, 159, 64, 0.6)"],borderColor:["rgba(255, 99, 132, 1)","rgba(54, 162, 235, 1)","rgba(255, 206, 86, 1)","rgba(75, 192, 192, 1)","rgba(153, 102, 255, 1)","rgba(255, 159, 64, 1)"],borderWidth:1,hoverOffset:2}]},options:{responsive:!0}})},1500)}}return(s=m).\u0275fac=function(o){return new(o||s)},s.\u0275cmp=e.VBU({type:s,selectors:[["app-informe"]],decls:68,vars:1,consts:[["title","Informes de ventas",3,"showMenu"],["slot","fixed",3,"ionRefresh"],[1,"ion-text-center","tit"],[1,"container"],[1,"tittle-today"],[1,"card-container-today"],["size","12","size-md","6","size-lg","6"],["id","ChartDiarioK"],["id","ChartDiarioP"],[1,"tittle-week"],[1,"card-container-week"],["id","miGraficaSemanal"],[1,"tittle-month"],[1,"card-container-month"],["id","ChartMensual"],[1,"tittle-year"],[1,"card-container-year"],["id","ChartAnual",1,"pieChart"]],template:function(o,r){1&o&&(e.nrm(0,"app-header",0),e.j41(1,"ion-content")(2,"ion-refresher",1),e.bIt("ionRefresh",function(n){return r.doRefresh(n)}),e.nrm(3,"ion-refresher-content"),e.k0s(),e.j41(4,"h2",2),e.EFF(5,"Informes de ventas"),e.k0s(),e.j41(6,"div",3)(7,"h1",4),e.EFF(8,"Informes de ventas diarias"),e.k0s(),e.j41(9,"div",5)(10,"ion-row")(11,"ion-col",6)(12,"ion-card")(13,"ion-card-header")(14,"ion-card-title"),e.EFF(15,"Reporte en kilogramos"),e.k0s(),e.j41(16,"ion-card-subtitle"),e.EFF(17,"Datos obtenidos en las ventas del dia de hoy."),e.k0s()(),e.j41(18,"ion-card-content"),e.nrm(19,"canvas",7),e.k0s()()(),e.j41(20,"ion-col",6)(21,"ion-card")(22,"ion-card-header")(23,"ion-card-title"),e.EFF(24,"Reporte en pesos"),e.k0s(),e.j41(25,"ion-card-subtitle"),e.EFF(26,"Datos obtenidos en las ventas del dia de hoy."),e.k0s()(),e.j41(27,"ion-card-content"),e.nrm(28,"canvas",8),e.k0s()()()()(),e.j41(29,"h1",9),e.EFF(30,"Informes de ventas semanales"),e.k0s(),e.j41(31,"div",10)(32,"ion-row")(33,"ion-col",6)(34,"ion-card")(35,"ion-card-header")(36,"ion-card-title"),e.EFF(37,"Reporte en pesos"),e.k0s(),e.j41(38,"ion-card-subtitle"),e.EFF(39,"Datos obtenidos en las ventas de los \xfaltimos d\xedas del mes."),e.k0s()(),e.j41(40,"ion-card-content"),e.nrm(41,"canvas",11),e.k0s()()()()(),e.j41(42,"h1",12),e.EFF(43,"Informes de ventas mensuales"),e.k0s(),e.j41(44,"div",13)(45,"ion-row")(46,"ion-col",6)(47,"ion-card")(48,"ion-card-header")(49,"ion-card-title"),e.EFF(50,"Reporte en pesos"),e.k0s(),e.j41(51,"ion-card-subtitle"),e.EFF(52,"Datos obtenidos en las ventas de los meses anteriores."),e.k0s()(),e.j41(53,"ion-card-content"),e.nrm(54,"canvas",14),e.k0s()()()()(),e.j41(55,"h1",15),e.EFF(56,"Informes de ventas anuales"),e.k0s(),e.j41(57,"div",16)(58,"ion-row")(59,"ion-col",6)(60,"ion-card")(61,"ion-card-header")(62,"ion-card-title"),e.EFF(63,"Reporte en pesos"),e.k0s(),e.j41(64,"ion-card-subtitle"),e.EFF(65,"Datos obtenidos en las ventas de los a\xf1os anteriores."),e.k0s()(),e.j41(66,"ion-card-content"),e.nrm(67,"canvas",17),e.k0s()()()()()()()),2&o&&e.Y8G("showMenu",!0)},dependencies:[u.b_,u.I9,u.ME,u.HW,u.tN,u.hU,u.W9,u.To,u.Ki,u.ln,E.l],styles:[".pieChart[_ngcontent-%COMP%]{width:100%!important;max-width:250px;margin:0 auto}ion-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}ion-card-header[_ngcontent-%COMP%], ion-card-content[_ngcontent-%COMP%]{flex-grow:1}.tittle-today[_ngcontent-%COMP%]{margin-top:4%}.tittle-week[_ngcontent-%COMP%], .tittle-month[_ngcontent-%COMP%], .tittle-year[_ngcontent-%COMP%]{margin-top:10%}.container[_ngcontent-%COMP%]{margin:2%}"]}),m})()}];let j=(()=>{var s;class m{}return(s=m).\u0275fac=function(o){return new(o||s)},s.\u0275mod=e.$C({type:s}),s.\u0275inj=e.G2t({imports:[P.iI.forChild(I),P.iI]}),m})();var w=b(7383);let A=(()=>{var s;class m{}return(s=m).\u0275fac=function(o){return new(o||s)},s.\u0275mod=e.$C({type:s}),s.\u0275inj=e.G2t({imports:[S.MD,k.YN,u.bv,j,w.G]}),m})()}}]);