"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4746],{4746:(Ct,D,v)=>{v.r(D),v.d(D,{MetodoEntregaPageModule:()=>yt});var b=v(177),T=v(9417),s=v(5933),j=v(8265),m=v(467),t=v(4438),w=v(7517),I=v(2723),R=v(1876),x=v(8461);const M=n=>[n,"MXN","symbol-narrow","1.2-2","en-US"],N=()=>[0,"MXN","symbol-narrow","1.2-2","en-US"],A=()=>[5,"MXN","symbol-narrow","1.2-2","en-US"];function G(n,c){if(1&n&&(t.j41(0,"div",12)(1,"span"),t.EFF(2),t.k0s(),t.j41(3,"span"),t.EFF(4),t.nI1(5,"currency"),t.k0s()()),2&n){const i=c.$implicit;t.R7$(2),t.Lme("",(null==i.producto?null:i.producto.nombre)||""," x",i.cantidad,""),t.R7$(2),t.SpI("",t.iJd(5,3,t.eq3(9,M,i.subtotal))," MXN")}}function X(n,c){if(1&n&&(t.j41(0,"div",12)(1,"span",22),t.EFF(2,"Subtotal: "),t.k0s(),t.j41(3,"span",22),t.EFF(4),t.nI1(5,"currency"),t.k0s()()),2&n){const i=t.XpG();t.R7$(4),t.SpI("",t.iJd(5,1,t.eq3(7,M,null==i.cart?null:i.cart.total))," MXN")}}function Y(n,c){if(1&n&&(t.j41(0,"div",12)(1,"span",23),t.EFF(2,"Descuento: "),t.k0s(),t.j41(3,"span",23),t.EFF(4),t.nI1(5,"number"),t.k0s()()),2&n){const i=t.XpG();t.R7$(4),t.SpI("-",t.i5U(5,1,i.porcentaje,"1.0-0"),"%")}}function L(n,c){if(1&n&&(t.j41(0,"div",12)(1,"span",24),t.EFF(2,"Subtotal con descuento:"),t.k0s(),t.j41(3,"span",24),t.EFF(4),t.nI1(5,"currency"),t.k0s()()),2&n){const i=t.XpG();t.R7$(4),t.SpI("",t.iJd(5,1,t.eq3(7,M,(null==i.cart?null:i.cart.total)-(null==i.cart?null:i.cart.total)*(i.porcentaje/100)))," MXN")}}function z(n,c){if(1&n&&(t.j41(0,"div",12)(1,"span"),t.EFF(2,"Subtotal:"),t.k0s(),t.j41(3,"span"),t.EFF(4),t.nI1(5,"currency"),t.k0s()()),2&n){const i=t.XpG();t.R7$(4),t.SpI("",t.iJd(5,1,t.eq3(7,M,null==i.cart?null:i.cart.total))," MXN")}}function J(n,c){1&n&&(t.j41(0,"div",25),t.nrm(1,"ion-icon",26),t.j41(2,"span",27),t.EFF(3,"\xa1Tienes env\xedo gratis!"),t.k0s()())}function U(n,c){1&n&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"currency"),t.k0s()),2&n&&(t.R7$(),t.SpI("",t.iJd(2,1,t.lJ4(7,N))," MXN"))}function B(n,c){if(1&n&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"currency"),t.k0s()),2&n){const i=t.XpG();t.R7$(),t.SpI("",t.iJd(2,1,t.eq3(7,M,i.transportFee))," MXN")}}function q(n,c){1&n&&(t.j41(0,"div",12)(1,"span"),t.EFF(2,"Cargo de servicio:"),t.k0s(),t.j41(3,"span"),t.EFF(4),t.nI1(5,"currency"),t.k0s()()),2&n&&(t.R7$(4),t.SpI("",t.iJd(5,1,t.lJ4(7,A))," MXN"))}function V(n,c){if(1&n&&(t.j41(0,"div",28),t.nrm(1,"ion-icon",29),t.j41(2,"span",30),t.EFF(3),t.nI1(4,"currency"),t.k0s()()),2&n){const i=t.XpG();t.R7$(3),t.SpI("Agrega ",t.iJd(4,1,t.eq3(7,M,140-((null==i.cart?null:i.cart.total)-(null==i.cart?null:i.cart.total)*(i.porcentaje/100))))," MXN m\xe1s para env\xedo gratis")}}function W(n,c){if(1&n&&(t.j41(0,"span")(1,"strong"),t.EFF(2),t.nI1(3,"currency"),t.k0s()()),2&n){const i=t.XpG();t.R7$(2),t.SpI("",t.iJd(3,1,t.eq3(7,M,(null==i.cart?null:i.cart.total)-(null==i.cart?null:i.cart.total)*(i.porcentaje/100)))," MXN")}}function Q(n,c){if(1&n&&(t.j41(0,"span")(1,"strong"),t.EFF(2),t.nI1(3,"currency"),t.k0s()()),2&n){const i=t.XpG();t.R7$(2),t.SpI("",t.iJd(3,1,t.eq3(7,M,(null==i.cart?null:i.cart.total)-(null==i.cart?null:i.cart.total)*(i.porcentaje/100)+i.transportFee+5))," MXN")}}function H(n,c){1&n&&(t.j41(0,"div",31),t.nrm(1,"div",32),t.k0s())}function Z(n,c){1&n&&t.nrm(0,"ion-icon",36)}function K(n,c){if(1&n){const i=t.RV6();t.j41(0,"div",33)(1,"ion-button",34),t.bIt("click",function(){t.eBV(i);const e=t.XpG();return t.Njj(e.confirmPayment())}),t.DNE(2,Z,1,0,"ion-icon",35),t.EFF(3),t.k0s()()}if(2&n){const i=t.XpG();t.R7$(),t.AVh("animated",i.confirming),t.Y8G("disabled",i.confirming||i.paymentConfirmed),t.R7$(),t.Y8G("ngIf",i.paymentConfirmed),t.R7$(),t.SpI(" ",i.paymentConfirmed?"Pedido Confirmado":"Confirmar Pago"," ")}}let tt=(()=>{var n;class c{constructor(){this.selectedPayment=null,this.confirming=!1,this.paymentConfirmed=!1,this.utilsSvc=(0,t.WQX)(I.T),this.firebaseSvc=(0,t.WQX)(w.f),this.emailSvc=(0,t.WQX)(R._),this.discountAmount=0,this.porcentaje=0,this.distanciaKm=0,this.transportFee=0,this.serviceFee=5,this.useDistancePricing=!0,this.fixedFare=50,this.pricingTiers=[]}ngOnInit(){this.getCartDetails(),this.applyStoredCoupon();const o=this.dir()[0];console.log(`User Location: ${JSON.stringify(o)}`),o&&this.firebaseSvc.getCollectionData("direccionNegocio").subscribe(e=>{if(e&&e.length>0){const r=e[0];console.log(`Business Location: ${JSON.stringify(r)}`);const a=this.calcularDistancia(parseFloat(o.geopoint._lat||o.geopoint.latitude),parseFloat(o.geopoint._long||o.geopoint.longitude),parseFloat(r.geopoint.latitude)||parseFloat(r.geopoint._lat),parseFloat(r.geopoint.longitude)||parseFloat(r.geopoint._long));console.log(`Distancia: ${a} km`),this.distanciaKm=parseFloat(a.toFixed(2)),this.loadTransportFeeFromFirebase(this.distanciaKm)}})}loadTransportFeeFromFirebase(o){var e=this;return(0,m.A)(function*(){try{e.firebaseSvc.getCollectionData("tarifas_transporte").subscribe(r=>{if(r&&r.length>0){const a=r.find(l=>o>=l.distancia_min&&o<=l.distancia_max&&l.activo);if(a)return void(e.transportFee=a.tarifa)}e.firebaseSvc.getCollectionData("tarifa_fija").subscribe(a=>{e.transportFee=a&&a.length>0&&a[0].activo?a[0].precio:e.calculateTransportFee(o)})})}catch(r){console.error("Error loading transport fee from Firebase:",r),e.transportFee=e.calculateTransportFee(o)}})()}calculateTransportFee(o){return o<=.5?30:o<=1?35:o<=1.5?50:o<=2?65:o<=2.5?70:o<=3?80:o<=3.5?90:o<=4?115:o<=4.5?125:145}sendOrderConfirmationEmail(o,e){var r=this;return(0,m.A)(function*(){try{const a=r.utilsSvc.getFromLocalStorage("user"),l={orderId:o,customerEmail:a.email,customerName:a.name||a.email,fecha:new Date,estatus:"Pedido confirmado",tipo_pago:e,items:r.cart.detalle_carrito,subtotal:r.cart.total,discountAmount:r.cart.total*(r.porcentaje/100),discountPercent:r.porcentaje,transportFee:r.transportFee,serviceFee:r.serviceFee,total:r.cart.total-r.cart.total*(r.porcentaje/100)+r.transportFee+r.serviceFee};yield r.emailSvc.sendOrderConfirmationEmail(l),console.log("Email de confirmaci\xf3n enviado exitosamente")}catch(a){console.error("Error al enviar email de confirmaci\xf3n:",a)}})()}renderPayPalButton(){var r,o=this;document.getElementById("paypal-button-container")?window.paypal.Buttons({createOrder:(r,a)=>a.order.create({purchase_units:[{amount:{value:(this.cart.total-this.cart.total*(this.porcentaje/100)+this.transportFee+this.serviceFee).toFixed(2)},shipping_address:{country_code:"MX"}}],shipping_preference:"SET_PROVIDED_ADDRESS"}),onApprove:(r=(0,m.A)(function*(a,l){return l.order.capture().then(function(){var h=(0,m.A)(function*(y){console.log("Pago completado:",y);const f=yield o.utilsSvc.loading();yield f.present();let C=!1;for(let d of o.cart.detalle_carrito){const p=yield o.firebaseSvc.getDocument(`productos/${d.uid_producto}`);if(p&&p.stock<d.cantidad){C=!0;break}}if(C)return f.dismiss(),void o.utilsSvc.presentToast({message:"Uno o m\xe1s productos en tu carrito no tienen stock.",duration:2500,color:"danger",position:"bottom",icon:"alert-circle-outline"});o.confirming=!0,setTimeout(()=>{o.confirming=!1,o.paymentConfirmed=!0},3e3),setTimeout((0,m.A)(function*(){const d=document.querySelector(".confirm-button");d&&d.classList.add("complete");const p=o.utilsSvc.getFromLocalStorage("user").uid,u=o.dir()[0],P=new Date,F={estatus:"Pedido confirmado",fecha:P,fecha_entrega:P,pago_confirmado:!0,tipo_pago:"Tarjeta",tipo_entrega:"Domicilio",total:o.cart.total-o.cart.total*(o.porcentaje/100)+o.transportFee+o.serviceFee,serviceFee:o.serviceFee,uid_cliente:p,geopoint_entrega:{latitude:parseFloat(u.geopoint._lat),longitude:parseFloat(u.geopoint._long)}},k=o.cart.detalle_carrito.map(_=>({cantidad:_.cantidad,subtotal:_.subtotal,uid_producto:_.uid_producto,uid_opcion:_.uid_opcion}));o.utilsSvc.setElementInLocalstorage("pedido",F),o.utilsSvc.setElementInLocalstorage("detalle_pedido",k);const g=o.cart.id;for(let _ of o.cart.detalle_carrito){yield o.firebaseSvc.deleteDocumet(`users/${p}/carrito/${g}/detalle_carrito/${_.id}`);const $=yield o.firebaseSvc.getDocument(`productos/${_.uid_producto}`);if(console.log("Producto:",$),$){const bt=$.stock-_.cantidad;yield o.firebaseSvc.updateDocumet(`productos/${_.uid_producto}`,{stock:bt})}}const E=yield o.firebaseSvc.addDocument("pedidos",F);for(let _ of o.cart.detalle_carrito)yield o.firebaseSvc.addDocument(`pedidos/${E.id}/detalle_pedido`,{cantidad:_.cantidad,subtotal:_.subtotal,uid_producto:_.uid_producto,uid_opcion:_.uid_opcion});yield o.sendOrderConfirmationEmail(E.id,"Tarjeta"),yield o.firebaseSvc.updateDocumet(`users/${p}/carrito/${g}`,{total:0}),o.cart.detalle_carrito=[],o.cart.total=0,o.utilsSvc.setElementInLocalstorage("carrito",[o.cart]),localStorage.removeItem("selectedMethod"),f.dismiss(),o.utilsSvc.presentToast({message:"Pedido confirmado",duration:2500,color:"primary",position:"bottom",icon:"alert-circle-outline"}),o.paymentConfirmed=!1,o.utilsSvc.dismissModal(!0),o.utilsSvc.routerLink("/main/confirmacion-pago")}),3e3)});return function(y){return h.apply(this,arguments)}}())}),function(l,h){return r.apply(this,arguments)}),onError:r=>{console.error("Error en el pago:",r),alert("Hubo un problema con el pago. Por favor, int\xe9ntalo de nuevo.")}}).render("#paypal-button-container"):console.error("Contenedor #paypal-button-container no encontrado.")}onPaymentChange(o){var e=this;return(0,m.A)(function*(){if(e.selectedPayment=o,"paypal"===o){const r=yield e.utilsSvc.loading();yield r.present(),setTimeout(()=>{e.renderPayPalButton(),r.dismiss()},1500)}})()}confirmPayment(){var o=this;return(0,m.A)(function*(){const e=yield o.utilsSvc.loading();yield e.present();let r=!1;for(let a of o.cart.detalle_carrito){const l=yield o.firebaseSvc.getDocument(`productos/${a.uid_producto}`);if(l&&l.stock<a.cantidad){r=!0;break}}if(r)return e.dismiss(),void o.utilsSvc.presentToast({message:"Uno o m\xe1s productos en tu carrito no tienen stock.",duration:2500,color:"danger",position:"bottom",icon:"alert-circle-outline"});o.confirming=!0,setTimeout(()=>{o.confirming=!1,o.paymentConfirmed=!0},3e3),setTimeout((0,m.A)(function*(){const a=document.querySelector(".confirm-button");a&&a.classList.add("complete");const l=o.utilsSvc.getFromLocalStorage("user").uid,h=o.dir()[0],y=new Date,f={estatus:"Pedido confirmado",fecha:y,fecha_entrega:y,pago_confirmado:!1,tipo_pago:"Efectivo",tipo_entrega:"Domicilio",total:o.cart.total-o.cart.total*(o.porcentaje/100)+o.transportFee+o.serviceFee,serviceFee:o.serviceFee,uid_cliente:l,geopoint_entrega:{latitude:parseFloat(h.geopoint._lat),longitude:parseFloat(h.geopoint._long)}},C=o.cart.detalle_carrito.map(u=>({cantidad:u.cantidad,subtotal:u.subtotal,uid_producto:u.uid_producto,uid_opcion:u.uid_opcion}));o.utilsSvc.setElementInLocalstorage("pedido",f),o.utilsSvc.setElementInLocalstorage("detalle_pedido",C);const d=o.cart.id;for(let u of o.cart.detalle_carrito){yield o.firebaseSvc.deleteDocumet(`users/${l}/carrito/${d}/detalle_carrito/${u.id}`);const P=yield o.firebaseSvc.getDocument(`productos/${u.uid_producto}`);if(console.log("Producto:",P),P){const F=P.stock-u.cantidad;yield o.firebaseSvc.updateDocumet(`productos/${u.uid_producto}`,{stock:F})}}const p=yield o.firebaseSvc.addDocument("pedidos",f);for(let u of o.cart.detalle_carrito)yield o.firebaseSvc.addDocument(`pedidos/${p.id}/detalle_pedido`,{cantidad:u.cantidad,subtotal:u.subtotal,uid_producto:u.uid_producto,uid_opcion:u.uid_opcion});yield o.sendOrderConfirmationEmail(p.id,"Efectivo"),yield o.firebaseSvc.updateDocumet(`users/${l}/carrito/${d}`,{total:0}),o.cart.detalle_carrito=[],o.cart.total=0,o.utilsSvc.setElementInLocalstorage("carrito",[o.cart]),localStorage.removeItem("selectedMethod"),e.dismiss(),o.utilsSvc.presentToast({message:"Pedido confirmado",duration:2500,color:"primary",position:"bottom",icon:"alert-circle-outline"}),o.paymentConfirmed=!1,o.utilsSvc.dismissModal(!0),o.utilsSvc.routerLink("/main/confirmacion-pago")}),3e3)})()}getCartDetails(){var o=this;return(0,m.A)(function*(){const e=yield o.utilsSvc.loading();yield e.present(),o.cart=o.utilsSvc.getFromLocalStorage("carrito")[0];for(let r of o.cart.detalle_carrito){const a=yield o.firebaseSvc.getDocument(`productos/${r.uid_producto}`),l=yield o.firebaseSvc.getDocument(`productos/${r.uid_producto}/opciones/${r.uid_opcion}`);r.producto=a||{},r.opcion=l||{}}e.dismiss()})()}applyStoredCoupon(){if(this.cart=this.utilsSvc.getFromLocalStorage("carrito")[0],this.cart){const o=this.utilsSvc.getFromLocalStorage("appliedCoupon");o&&(this.discountAmount=this.cart.total*o.porcentaje/100,this.porcentaje=o.porcentaje,this.cart.total-=this.discountAmount)}}calcularDistancia(o,e,r,a){const h=(r-o)*Math.PI/180,y=(a-e)*Math.PI/180,f=Math.sin(h/2)*Math.sin(h/2)+Math.cos(o*Math.PI/180)*Math.cos(r*Math.PI/180)*Math.sin(y/2)*Math.sin(y/2);return 2*Math.atan2(Math.sqrt(f),Math.sqrt(1-f))*6371}dir(){return this.utilsSvc.getFromLocalStorage("direccion")||{}}}return(n=c).\u0275fac=function(o){return new(o||n)},n.\u0275cmp=t.VBU({type:n,selectors:[["app-entrega-domicilio"]],decls:54,vars:31,consts:[["title","Pago",3,"isModal"],[3,"fullscreen"],[1,"payment-card"],[1,"title"],[3,"ionChange"],["button","",1,"option-card",3,"click"],["name","cash-outline","slot","start",1,"option-icon"],["slot","end","value","efectivo"],["name","card-outline","slot","start",1,"option-icon"],["slot","end","value","tarjeta"],[1,"summary-card"],[1,"summary-title"],[1,"summary-item"],["class","summary-item",4,"ngFor","ngForOf"],[1,"divider"],["class","summary-item",4,"ngIf"],["class","free-shipping-message",4,"ngIf"],[4,"ngIf"],["class","motivational-message",4,"ngIf"],[1,"summary-item","total-item"],["class","confirm-button-container-paypal",4,"ngIf"],["class","confirm-button-container",4,"ngIf"],[1,"original-price"],[1,"descuento"],[1,"discounted-price"],[1,"free-shipping-message"],["name","gift-outline","color","success"],[1,"success-text"],[1,"motivational-message"],["name","information-circle-outline","color","primary"],[1,"info-text"],[1,"confirm-button-container-paypal"],["id","paypal-button-container"],[1,"confirm-button-container"],["expand","block","mode","ios",3,"click","disabled"],["name","checkmark-outline","slot","start",4,"ngIf"],["name","checkmark-outline","slot","start"]],template:function(o,e){1&o&&(t.nrm(0,"app-header",0),t.j41(1,"ion-content",1)(2,"ion-card",2)(3,"ion-card-header")(4,"h2",3),t.EFF(5,"M\xe9todo de Pago"),t.k0s()(),t.j41(6,"ion-card-content")(7,"ion-radio-group",4),t.bIt("ionChange",function(a){return e.onPaymentChange(a.detail.value)}),t.j41(8,"ion-card",5),t.bIt("click",function(){return e.onPaymentChange("efectivo")}),t.j41(9,"ion-item"),t.nrm(10,"ion-icon",6),t.j41(11,"ion-label"),t.EFF(12,"Efectivo en domicilio"),t.k0s(),t.nrm(13,"ion-radio",7),t.k0s()(),t.j41(14,"ion-card",5),t.bIt("click",function(){return e.onPaymentChange("paypal")}),t.j41(15,"ion-item"),t.nrm(16,"ion-icon",8),t.j41(17,"ion-label"),t.EFF(18,"Tarjeta"),t.k0s(),t.nrm(19,"ion-radio",9),t.k0s()()()()(),t.j41(20,"ion-card",10)(21,"ion-card-header")(22,"h3",11),t.EFF(23,"Resumen de compra"),t.k0s()(),t.j41(24,"ion-card-content")(25,"div",12)(26,"span"),t.EFF(27),t.k0s(),t.j41(28,"span"),t.EFF(29),t.nI1(30,"currency"),t.k0s()(),t.DNE(31,G,6,11,"div",13),t.nrm(32,"div",14),t.DNE(33,X,6,9,"div",15)(34,Y,6,4,"div",15)(35,L,6,9,"div",15)(36,z,6,9,"div",15)(37,J,4,0,"div",16),t.j41(38,"div",12)(39,"span"),t.EFF(40),t.k0s(),t.DNE(41,U,3,8,"span",17)(42,B,3,9,"span",17),t.k0s(),t.DNE(43,q,6,8,"div",15)(44,V,5,9,"div",18),t.nrm(45,"div",14),t.j41(46,"div",19)(47,"span")(48,"strong"),t.EFF(49,"Total a pagar:"),t.k0s()(),t.DNE(50,W,4,9,"span",17)(51,Q,4,9,"span",17),t.k0s()()(),t.DNE(52,H,2,0,"div",20)(53,K,4,5,"div",21),t.k0s()),2&o&&(t.Y8G("isModal",!0),t.R7$(),t.Y8G("fullscreen",!0),t.R7$(7),t.AVh("selected","efectivo"===e.selectedPayment),t.R7$(6),t.AVh("selected","paypal"===e.selectedPayment),t.R7$(13),t.SpI("Productos (",(null==e.cart||null==e.cart.detalle_carrito?null:e.cart.detalle_carrito.length)||0,")"),t.R7$(2),t.SpI("",t.iJd(30,23,t.eq3(29,M,null==e.cart?null:e.cart.total))," MXN"),t.R7$(2),t.Y8G("ngForOf",null==e.cart?null:e.cart.detalle_carrito),t.R7$(2),t.Y8G("ngIf",e.discountAmount>0),t.R7$(),t.Y8G("ngIf",e.discountAmount>0),t.R7$(),t.Y8G("ngIf",e.discountAmount>0),t.R7$(),t.Y8G("ngIf",0===e.discountAmount),t.R7$(),t.Y8G("ngIf",(null==e.cart?null:e.cart.total)-(null==e.cart?null:e.cart.total)*(e.porcentaje/100)>=140),t.R7$(3),t.SpI("Tarifa de transporte (",e.distanciaKm," km):"),t.R7$(),t.Y8G("ngIf",(null==e.cart?null:e.cart.total)-(null==e.cart?null:e.cart.total)*(e.porcentaje/100)>=140),t.R7$(),t.Y8G("ngIf",(null==e.cart?null:e.cart.total)-(null==e.cart?null:e.cart.total)*(e.porcentaje/100)<140),t.R7$(),t.Y8G("ngIf",(null==e.cart?null:e.cart.total)-(null==e.cart?null:e.cart.total)*(e.porcentaje/100)<140),t.R7$(),t.Y8G("ngIf",(null==e.cart?null:e.cart.total)-(null==e.cart?null:e.cart.total)*(e.porcentaje/100)<140),t.R7$(6),t.Y8G("ngIf",(null==e.cart?null:e.cart.total)-(null==e.cart?null:e.cart.total)*(e.porcentaje/100)>=140),t.R7$(),t.Y8G("ngIf",(null==e.cart?null:e.cart.total)-(null==e.cart?null:e.cart.total)*(e.porcentaje/100)<140),t.R7$(),t.Y8G("ngIf","tarjeta"===e.selectedPayment),t.R7$(),t.Y8G("ngIf","efectivo"===e.selectedPayment))},dependencies:[b.Sq,b.bT,s.Jm,s.b_,s.I9,s.ME,s.W9,s.iq,s.uz,s.he,s.KO,s.f0,s.uR,s.Je,x.l,b.QX,b.oe],styles:['@charset "UTF-8";.payment-card[_ngcontent-%COMP%], .summary-card[_ngcontent-%COMP%]{margin:16px;border-radius:16px;box-shadow:0 4px 8px #0000001a}.title[_ngcontent-%COMP%], .summary-title[_ngcontent-%COMP%]{font-size:1.2rem;font-weight:700;text-align:center;color:var(--ion-color-primary)}.option-card[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:16px;transition:transform .2s ease,background-color .3s ease}.option-card.selected[_ngcontent-%COMP%]{transform:scale(1.05);background-color:var(--ion-color-primary-tint)}.option-icon[_ngcontent-%COMP%]{font-size:2rem;color:var(--ion-color-primary);margin-right:8px}.summary-card[_ngcontent-%COMP%]{background-color:#f8f9fa;color:#343a40}.summary-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:12px 0;font-size:1rem}.divider[_ngcontent-%COMP%]{border-bottom:1px solid #dee2e6;margin:8px 0}.confirm-button-container[_ngcontent-%COMP%], .confirm-button-container-paypal[_ngcontent-%COMP%]{margin:16px}.confirm-button[_ngcontent-%COMP%]{--background: var(--ion-color-primary);color:#fff;font-weight:700;border-radius:24px;text-align:center;position:relative;overflow:hidden;transition:background-color .3s ease-in-out}.complete[_ngcontent-%COMP%]{--background: var(--ion-color-primary);color:#fff;font-weight:700;border-radius:24px;text-align:center;position:relative;overflow:hidden}.confirm-button.animated[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;height:100%;width:0%;background:linear-gradient(to right,var(--ion-color-primary),var(--ion-color-secondary),var(--ion-color-tertiary));z-index:1;animation:_ngcontent-%COMP%_slideIn 3s forwards}.confirm-button.animated[_ngcontent-%COMP%]{color:transparent}.confirm-button.animated[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#fff}.confirm-button.complete[_ngcontent-%COMP%]{--background: var(--ion-color-primary)}@keyframes _ngcontent-%COMP%_slideIn{0%{width:0%}50%{width:100%}to{width:0%}}.total-summary[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start}.total-summary[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin:4px 0}.discounted-price[_ngcontent-%COMP%]{color:green;font-weight:700}.original-price[_ngcontent-%COMP%]{color:gray;text-decoration:line-through;font-size:17px}.descuento[_ngcontent-%COMP%]{font-weight:700;font-size:17px}']}),c})();const O=n=>[n,"MXN","symbol-narrow","1.2-2","en-US"];function ot(n,c){if(1&n&&(t.j41(0,"div",12)(1,"span"),t.EFF(2),t.k0s(),t.j41(3,"span"),t.EFF(4),t.nI1(5,"currency"),t.k0s()()),2&n){const i=c.$implicit;t.R7$(2),t.Lme("",(null==i.producto?null:i.producto.nombre)||""," x",i.cantidad,""),t.R7$(2),t.SpI("",t.iJd(5,3,t.eq3(9,O,i.subtotal))," MXN")}}function et(n,c){if(1&n&&(t.j41(0,"div",12)(1,"span",18),t.EFF(2,"Total: "),t.k0s(),t.j41(3,"span",18),t.EFF(4),t.nI1(5,"currency"),t.k0s()()),2&n){const i=t.XpG();t.R7$(4),t.SpI("",t.iJd(5,1,t.eq3(7,O,null==i.cart?null:i.cart.total))," MXN")}}function nt(n,c){if(1&n&&(t.j41(0,"div",12)(1,"span",19),t.EFF(2,"Descuento: "),t.k0s(),t.j41(3,"span",19),t.EFF(4),t.nI1(5,"number"),t.k0s()()),2&n){const i=t.XpG();t.R7$(4),t.SpI("-",t.i5U(5,1,i.porcentaje,"1.0-0"),"%")}}function it(n,c){if(1&n&&(t.j41(0,"div",12)(1,"span",20),t.EFF(2,"Total con descuento:"),t.k0s(),t.j41(3,"span",20),t.EFF(4),t.nI1(5,"currency"),t.k0s()()),2&n){const i=t.XpG();t.R7$(4),t.SpI("",t.iJd(5,1,t.eq3(7,O,(null==i.cart?null:i.cart.total)-(null==i.cart?null:i.cart.total)*(i.porcentaje/100)))," MXN")}}function rt(n,c){if(1&n&&(t.j41(0,"div",12)(1,"span"),t.EFF(2,"Pagas"),t.k0s(),t.j41(3,"span"),t.EFF(4),t.nI1(5,"currency"),t.k0s()()),2&n){const i=t.XpG();t.R7$(4),t.SpI("",t.iJd(5,1,t.eq3(7,O,null==i.cart?null:i.cart.total))," MXN")}}function at(n,c){1&n&&(t.j41(0,"div",21),t.nrm(1,"div",22),t.k0s())}function ct(n,c){1&n&&t.nrm(0,"ion-icon",26)}function lt(n,c){if(1&n){const i=t.RV6();t.j41(0,"div",23)(1,"ion-button",24),t.bIt("click",function(){t.eBV(i);const e=t.XpG();return t.Njj(e.confirmPayment())}),t.DNE(2,ct,1,0,"ion-icon",25),t.EFF(3),t.k0s()()}if(2&n){const i=t.XpG();t.R7$(),t.AVh("animated",i.confirming),t.Y8G("disabled",i.confirming||i.paymentConfirmed),t.R7$(),t.Y8G("ngIf",i.paymentConfirmed),t.R7$(),t.SpI(" ",i.paymentConfirmed?"Pedido Confirmado":"Confirmar Pago"," ")}}let st=(()=>{var n;class c{constructor(){this.selectedPayment=null,this.confirming=!1,this.paymentConfirmed=!1,this.utilsSvc=(0,t.WQX)(I.T),this.firebaseSvc=(0,t.WQX)(w.f),this.emailSvc=(0,t.WQX)(R._),this.discountAmount=0,this.porcentaje=0,this.serviceFee=10}ngOnInit(){this.getCartDetails(),this.applyStoredCoupon()}sendOrderConfirmationEmail(o,e){var r=this;return(0,m.A)(function*(){try{const a=r.utilsSvc.getFromLocalStorage("user"),l={orderId:o,customerEmail:a.email,customerName:a.name||a.email,fecha:new Date,estatus:"Pedido confirmado",tipo_pago:e,items:r.cart.detalle_carrito,subtotal:r.cart.total,discountAmount:r.cart.total*(r.porcentaje/100),discountPercent:r.porcentaje,transportFee:0,serviceFee:r.serviceFee,total:r.cart.total-r.cart.total*(r.porcentaje/100)+r.serviceFee};yield r.emailSvc.sendOrderConfirmationEmail(l),console.log("Email de confirmaci\xf3n enviado exitosamente")}catch(a){console.error("Error al enviar email de confirmaci\xf3n:",a)}})()}renderPayPalButton(){var r,o=this;document.getElementById("paypal-button-container")?window.paypal.Buttons({createOrder:(r,a)=>a.order.create({purchase_units:[{amount:{value:this.cart.total-this.cart.total*(this.porcentaje/100)+this.serviceFee},shipping_address:{country_code:"MX"}}],shipping_preference:"SET_PROVIDED_ADDRESS"}),onApprove:(r=(0,m.A)(function*(a,l){return l.order.capture().then(function(){var h=(0,m.A)(function*(y){console.log("Pago completado:",y);const f=yield o.utilsSvc.loading();yield f.present();let C=!1;for(let d of o.cart.detalle_carrito){const p=yield o.firebaseSvc.getDocument(`productos/${d.uid_producto}`);if(p&&p.stock<d.cantidad){C=!0;break}}if(C)return f.dismiss(),void o.utilsSvc.presentToast({message:"Uno o m\xe1s productos en tu carrito no tienen stock.",duration:2500,color:"danger",position:"bottom",icon:"alert-circle-outline"});o.confirming=!0,setTimeout(()=>{o.confirming=!1,o.paymentConfirmed=!0},3e3),setTimeout((0,m.A)(function*(){const d=document.querySelector(".confirm-button");d&&d.classList.add("complete");const p=o.utilsSvc.getFromLocalStorage("user").uid,u={estatus:"Pedido confirmado",fecha:new Date,fecha_entrega:new Date,pago_confirmado:!0,tipo_pago:"Tarjeta",total:o.cart.total-o.cart.total*(o.porcentaje/100)+o.serviceFee,serviceFee:o.serviceFee,uid_cliente:p},P=o.cart.detalle_carrito.map(g=>({cantidad:g.cantidad,subtotal:g.subtotal,uid_producto:g.uid_producto,uid_opcion:g.uid_opcion}));o.utilsSvc.setElementInLocalstorage("pedido",u),o.utilsSvc.setElementInLocalstorage("detalle_pedido",P);const F=o.cart.id;for(let g of o.cart.detalle_carrito){yield o.firebaseSvc.deleteDocumet(`users/${p}/carrito/${F}/detalle_carrito/${g.id}`);const E=yield o.firebaseSvc.getDocument(`productos/${g.uid_producto}`);if(console.log("Producto:",E),E){const _=E.stock-g.cantidad;yield o.firebaseSvc.updateDocumet(`productos/${g.uid_producto}`,{stock:_})}}const k=yield o.firebaseSvc.addDocument("pedidos",u);for(let g of o.cart.detalle_carrito)yield o.firebaseSvc.addDocument(`pedidos/${k.id}/detalle_pedido`,{cantidad:g.cantidad,subtotal:g.subtotal,uid_producto:g.uid_producto,uid_opcion:g.uid_opcion});yield o.sendOrderConfirmationEmail(k.id,"Tarjeta"),yield o.firebaseSvc.updateDocumet(`users/${p}/carrito/${F}`,{total:0}),o.cart.detalle_carrito=[],o.cart.total=0,o.utilsSvc.setElementInLocalstorage("carrito",[o.cart]),localStorage.removeItem("selectedMethod"),f.dismiss(),o.utilsSvc.presentToast({message:"Pedido confirmado",duration:2500,color:"primary",position:"bottom",icon:"alert-circle-outline"}),o.paymentConfirmed=!1,o.utilsSvc.dismissModal(!0),o.utilsSvc.routerLink("/main/confirmacion-pago")}),3e3)});return function(y){return h.apply(this,arguments)}}())}),function(l,h){return r.apply(this,arguments)}),onError:r=>{console.error("Error en el pago:",r),alert("Hubo un problema con el pago. Por favor, int\xe9ntalo de nuevo.")}}).render("#paypal-button-container"):console.error("Contenedor #paypal-button-container no encontrado.")}onPaymentChange(o){var e=this;return(0,m.A)(function*(){if(e.selectedPayment=o,"paypal"===o){const r=yield e.utilsSvc.loading();yield r.present(),setTimeout(()=>{e.renderPayPalButton(),r.dismiss()},1500)}})()}confirmPayment(){var o=this;return(0,m.A)(function*(){const e=yield o.utilsSvc.loading();yield e.present();let r=!1;for(let a of o.cart.detalle_carrito){const l=yield o.firebaseSvc.getDocument(`productos/${a.uid_producto}`);if(l&&l.stock<a.cantidad){r=!0;break}}if(r)return e.dismiss(),void o.utilsSvc.presentToast({message:"Uno o m\xe1s productos en tu carrito no tienen stock.",duration:2500,color:"danger",position:"bottom",icon:"alert-circle-outline"});o.confirming=!0,setTimeout(()=>{o.confirming=!1,o.paymentConfirmed=!0},3e3),setTimeout((0,m.A)(function*(){const a=document.querySelector(".confirm-button");a&&a.classList.add("complete");const l=o.utilsSvc.getFromLocalStorage("user").uid,h={estatus:"Pedido confirmado",fecha:new Date,fecha_entrega:new Date,pago_confirmado:!1,tipo_pago:"Efectivo",total:o.cart.total-o.cart.total*(o.porcentaje/100)+o.serviceFee,serviceFee:o.serviceFee,uid_cliente:l},y=o.cart.detalle_carrito.map(d=>({cantidad:d.cantidad,subtotal:d.subtotal,uid_producto:d.uid_producto,uid_opcion:d.uid_opcion}));o.utilsSvc.setElementInLocalstorage("pedido",h),o.utilsSvc.setElementInLocalstorage("detalle_pedido",y);const f=o.cart.id;for(let d of o.cart.detalle_carrito){yield o.firebaseSvc.deleteDocumet(`users/${l}/carrito/${f}/detalle_carrito/${d.id}`);const p=yield o.firebaseSvc.getDocument(`productos/${d.uid_producto}`);if(console.log("Producto:",p),p){const u=p.stock-d.cantidad;yield o.firebaseSvc.updateDocumet(`productos/${d.uid_producto}`,{stock:u})}}const C=yield o.firebaseSvc.addDocument("pedidos",h);for(let d of o.cart.detalle_carrito)yield o.firebaseSvc.addDocument(`pedidos/${C.id}/detalle_pedido`,{cantidad:d.cantidad,subtotal:d.subtotal,uid_producto:d.uid_producto,uid_opcion:d.uid_opcion});yield o.sendOrderConfirmationEmail(C.id,"Efectivo"),yield o.firebaseSvc.updateDocumet(`users/${l}/carrito/${f}`,{total:0}),o.cart.detalle_carrito=[],o.cart.total=0,o.utilsSvc.setElementInLocalstorage("carrito",[o.cart]),localStorage.removeItem("selectedMethod"),e.dismiss(),o.utilsSvc.presentToast({message:"Pedido confirmado",duration:2500,color:"primary",position:"bottom",icon:"alert-circle-outline"}),o.paymentConfirmed=!1,o.utilsSvc.dismissModal(!0),o.utilsSvc.routerLink("/main/confirmacion-pago")}),3e3)})()}getCartDetails(){var o=this;return(0,m.A)(function*(){const e=yield o.utilsSvc.loading();yield e.present(),o.cart=o.utilsSvc.getFromLocalStorage("carrito")[0];for(let r of o.cart.detalle_carrito){const a=yield o.firebaseSvc.getDocument(`productos/${r.uid_producto}`),l=yield o.firebaseSvc.getDocument(`productos/${r.uid_producto}/opciones/${r.uid_opcion}`);r.producto=a||{},r.opcion=l||{}}e.dismiss()})()}applyStoredCoupon(){if(this.cart=this.utilsSvc.getFromLocalStorage("carrito")[0],this.cart){const o=this.utilsSvc.getFromLocalStorage("appliedCoupon");o&&(this.discountAmount=this.cart.total*o.porcentaje/100,this.porcentaje=o.porcentaje,this.cart.total-=this.discountAmount),this.cart.total+=this.serviceFee}}}return(n=c).\u0275fac=function(o){return new(o||n)},n.\u0275cmp=t.VBU({type:n,selectors:[["app-entrega-negocio"]],decls:39,vars:23,consts:[["title","Pago",3,"isModal"],[3,"fullscreen"],[1,"payment-card"],[1,"title"],[3,"ionChange"],["button","",1,"option-card",3,"click"],["name","cash-outline","slot","start",1,"option-icon"],["slot","end","value","efectivo"],["name","card-outline","slot","start",1,"option-icon"],["slot","end","value","tarjeta"],[1,"summary-card"],[1,"summary-title"],[1,"summary-item"],["class","summary-item",4,"ngFor","ngForOf"],[1,"divider"],["class","summary-item",4,"ngIf"],["class","confirm-button-container-paypal",4,"ngIf"],["class","confirm-button-container",4,"ngIf"],[1,"original-price"],[1,"descuento"],[1,"discounted-price"],[1,"confirm-button-container-paypal"],["id","paypal-button-container"],[1,"confirm-button-container"],["expand","block","mode","ios",3,"click","disabled"],["name","checkmark-outline","slot","start",4,"ngIf"],["name","checkmark-outline","slot","start"]],template:function(o,e){1&o&&(t.nrm(0,"app-header",0),t.j41(1,"ion-content",1)(2,"ion-card",2)(3,"ion-card-header")(4,"h2",3),t.EFF(5,"M\xe9todo de Pago"),t.k0s()(),t.j41(6,"ion-card-content")(7,"ion-radio-group",4),t.bIt("ionChange",function(a){return e.onPaymentChange(a.detail.value)}),t.j41(8,"ion-card",5),t.bIt("click",function(){return e.onPaymentChange("efectivo")}),t.j41(9,"ion-item"),t.nrm(10,"ion-icon",6),t.j41(11,"ion-label"),t.EFF(12,"Efectivo en Negocio"),t.k0s(),t.nrm(13,"ion-radio",7),t.k0s()(),t.j41(14,"ion-card",5),t.bIt("click",function(){return e.onPaymentChange("paypal")}),t.j41(15,"ion-item"),t.nrm(16,"ion-icon",8),t.j41(17,"ion-label"),t.EFF(18,"Tarjeta"),t.k0s(),t.nrm(19,"ion-radio",9),t.k0s()()()()(),t.j41(20,"ion-card",10)(21,"ion-card-header")(22,"h3",11),t.EFF(23,"Resumen de compra"),t.k0s()(),t.j41(24,"ion-card-content")(25,"div",12)(26,"span"),t.EFF(27),t.k0s(),t.j41(28,"span"),t.EFF(29),t.nI1(30,"currency"),t.k0s()(),t.DNE(31,ot,6,11,"div",13),t.nrm(32,"div",14),t.DNE(33,et,6,9,"div",15)(34,nt,6,4,"div",15)(35,it,6,9,"div",15)(36,rt,6,9,"div",15),t.k0s()(),t.DNE(37,at,2,0,"div",16)(38,lt,4,5,"div",17),t.k0s()),2&o&&(t.Y8G("isModal",!0),t.R7$(),t.Y8G("fullscreen",!0),t.R7$(7),t.AVh("selected","efectivo"===e.selectedPayment),t.R7$(6),t.AVh("selected","paypal"===e.selectedPayment),t.R7$(13),t.SpI("Productos (",(null==e.cart||null==e.cart.detalle_carrito?null:e.cart.detalle_carrito.length)||0,")"),t.R7$(2),t.SpI("",t.iJd(30,15,t.eq3(21,O,null==e.cart?null:e.cart.total))," MXN"),t.R7$(2),t.Y8G("ngForOf",null==e.cart?null:e.cart.detalle_carrito),t.R7$(2),t.Y8G("ngIf",e.discountAmount>0),t.R7$(),t.Y8G("ngIf",e.discountAmount>0),t.R7$(),t.Y8G("ngIf",e.discountAmount>0),t.R7$(),t.Y8G("ngIf",0===e.discountAmount),t.R7$(),t.Y8G("ngIf","tarjeta"===e.selectedPayment),t.R7$(),t.Y8G("ngIf","efectivo"===e.selectedPayment))},dependencies:[b.Sq,b.bT,s.Jm,s.b_,s.I9,s.ME,s.W9,s.iq,s.uz,s.he,s.KO,s.f0,s.uR,s.Je,x.l,b.QX,b.oe],styles:['@charset "UTF-8";.payment-card[_ngcontent-%COMP%], .summary-card[_ngcontent-%COMP%]{margin:16px;border-radius:16px;box-shadow:0 4px 8px #0000001a}.title[_ngcontent-%COMP%], .summary-title[_ngcontent-%COMP%]{font-size:1.2rem;font-weight:700;text-align:center;color:var(--ion-color-primary)}.option-card[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:16px;transition:transform .2s ease,background-color .3s ease}.option-card.selected[_ngcontent-%COMP%]{transform:scale(1.05);background-color:var(--ion-color-primary-tint)}.option-icon[_ngcontent-%COMP%]{font-size:2rem;color:var(--ion-color-primary);margin-right:8px}.summary-card[_ngcontent-%COMP%]{background-color:#f8f9fa;color:#343a40}.summary-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:12px 0;font-size:1rem}.divider[_ngcontent-%COMP%]{border-bottom:1px solid #dee2e6;margin:8px 0}.confirm-button-container[_ngcontent-%COMP%], .confirm-button-container-paypal[_ngcontent-%COMP%]{margin:16px}.confirm-button[_ngcontent-%COMP%]{--background: var(--ion-color-primary);color:#fff;font-weight:700;border-radius:24px;text-align:center;position:relative;overflow:hidden;transition:background-color .3s ease-in-out}.complete[_ngcontent-%COMP%]{--background: var(--ion-color-primary);color:#fff;font-weight:700;border-radius:24px;text-align:center;position:relative;overflow:hidden}.confirm-button.animated[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;height:100%;width:0%;background:linear-gradient(to right,var(--ion-color-primary),var(--ion-color-secondary),var(--ion-color-tertiary));z-index:1;animation:_ngcontent-%COMP%_slideIn 3s forwards}.confirm-button.animated[_ngcontent-%COMP%]{color:transparent}.confirm-button.animated[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#fff}.confirm-button.complete[_ngcontent-%COMP%]{--background: var(--ion-color-primary)}@keyframes _ngcontent-%COMP%_slideIn{0%{width:0%}50%{width:100%}to{width:0%}}.total-summary[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start}.total-summary[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin:4px 0}.discounted-price[_ngcontent-%COMP%]{color:green;font-weight:700}.original-price[_ngcontent-%COMP%]{color:gray;text-decoration:line-through;font-size:17px}.descuento[_ngcontent-%COMP%]{font-weight:700;font-size:17px}']}),c})();var dt=v(9365);const S=n=>[n,"MXN","symbol-narrow","1.2-2","en-US"];function ut(n,c){1&n&&(t.j41(0,"div",43),t.nrm(1,"ion-icon",44),t.k0s())}function pt(n,c){1&n&&(t.j41(0,"div",43),t.nrm(1,"ion-icon",44),t.k0s())}function mt(n,c){if(1&n&&(t.j41(0,"div",28)(1,"span",45),t.nrm(2,"ion-icon",46),t.EFF(3),t.k0s(),t.j41(4,"span",47),t.EFF(5),t.nI1(6,"currency"),t.k0s()()),2&n){const i=t.XpG();t.R7$(3),t.SpI(" Descuento (",i.porcentaje,"%) "),t.R7$(2),t.SpI("-",t.iJd(6,2,t.eq3(8,S,i.discountAmount))," MXN")}}function gt(n,c){if(1&n&&(t.j41(0,"div",48),t.nrm(1,"ion-icon",49),t.j41(2,"span"),t.EFF(3),t.nI1(4,"currency"),t.k0s()()),2&n){const i=t.XpG();t.R7$(3),t.SpI("\xa1Ahorras ",t.iJd(4,1,t.eq3(7,S,i.discountAmount))," MXN!")}}function ft(n,c){if(1&n&&(t.j41(0,"div",50),t.nrm(1,"ion-icon",51),t.j41(2,"span"),t.EFF(3),t.k0s()()),2&n){const i=t.XpG();t.R7$(),t.Y8G("name","negocio"===i.selectedMethod?"storefront-outline":"bicycle-outline"),t.R7$(2),t.JRh("negocio"===i.selectedMethod?"Recoger en tienda":"Entrega a domicilio")}}const _t=[{path:"",component:(()=>{var n;class c{constructor(o,e){this.router=o,this.utilsSvc=e,this.selectedMethod="",this.discountAmount=0,this.porcentaje=0}ngOnInit(){this.getCartDetails(),this.applyStoredCoupon()}onMethodChange(o){this.selectedMethod=o}continue(){var o=this;return(0,m.A)(function*(){o.selectedMethod&&(o.utilsSvc.saveInLocalStorage("selectedMethod",o.selectedMethod),console.log("M\xe9todo seleccionado:",o.selectedMethod),"negocio"===o.selectedMethod?(yield o.utilsSvc.presentModal({component:st,componentProps:{}}))&&o.utilsSvc.dismissModal(!0):"domicilio"===o.selectedMethod&&(yield o.utilsSvc.presentModal({component:dt.H,componentProps:{}}))&&(yield o.utilsSvc.presentModal({component:tt,componentProps:{}}))&&o.utilsSvc.dismissModal(!0))})()}getCartDetails(){this.cart=this.utilsSvc.getFromLocalStorage("carrito")[0]}applyStoredCoupon(){if(this.cart){const o=this.utilsSvc.getFromLocalStorage("appliedCoupon");o&&(this.discountAmount=this.cart.total*o.porcentaje/100,this.porcentaje=o.porcentaje)}}getTotalAmount(){return this.cart?this.discountAmount>0?this.cart.total-this.discountAmount:this.cart.total:0}}return(n=c).\u0275fac=function(o){return new(o||n)(t.rXU(j.Ix),t.rXU(I.T))},n.\u0275cmp=t.VBU({type:n,selectors:[["app-metodo-entrega"]],decls:87,vars:31,consts:[["title","M\xe9todo de entrega",3,"showMenu"],[3,"fullscreen"],[1,"container"],[1,"hero-section"],["name","fast-food-outline",1,"hero-icon"],[1,"hero-title"],[1,"hero-subtitle"],[1,"content-grid"],[1,"delivery-section"],[1,"delivery-options"],[1,"delivery-option",3,"click"],[1,"option-header"],[1,"option-icon-wrapper"],["name","storefront",1,"option-main-icon"],["class","option-badge",4,"ngIf"],[1,"option-content"],[1,"option-features"],[1,"feature"],["name","time-outline"],["name","cash-outline"],["name","bicycle",1,"option-main-icon"],["name","location-outline"],[1,"summary-section"],[1,"summary-card"],[1,"summary-header"],["name","receipt-outline",1,"summary-icon"],[1,"summary-content"],[1,"order-details"],[1,"detail-row"],[1,"detail-label"],["name","bag-outline"],[1,"detail-value"],["class","detail-row",4,"ngIf"],[1,"summary-divider"],[1,"total-section"],[1,"total-row"],[1,"total-label"],[1,"total-amount"],["class","savings",4,"ngIf"],[1,"footer-content"],["class","selected-method",4,"ngIf"],["expand","block","size","large",1,"continue-button",3,"click","disabled"],["name","arrow-forward-outline","slot","end"],[1,"option-badge"],["name","checkmark-circle"],[1,"detail-label","discount-label"],["name","pricetag-outline"],[1,"detail-value","discount-value"],[1,"savings"],["name","happy-outline"],[1,"selected-method"],[3,"name"]],template:function(o,e){1&o&&(t.nrm(0,"app-header",0),t.j41(1,"ion-content",1)(2,"div",2)(3,"div",3),t.nrm(4,"ion-icon",4),t.j41(5,"h1",5),t.EFF(6,"\xbfC\xf3mo quieres recibir tu pedido?"),t.k0s(),t.j41(7,"p",6),t.EFF(8,"Elige la opci\xf3n que mejor se adapte a ti"),t.k0s()(),t.j41(9,"div",7)(10,"div",8)(11,"div",9)(12,"div",10),t.bIt("click",function(){return e.onMethodChange("negocio")}),t.j41(13,"div",11)(14,"div",12),t.nrm(15,"ion-icon",13),t.k0s(),t.DNE(16,ut,2,0,"div",14),t.k0s(),t.j41(17,"div",15)(18,"h3"),t.EFF(19,"Recoger en tienda"),t.k0s(),t.j41(20,"p"),t.EFF(21,"Retira tu pedido directamente en nuestro local"),t.k0s(),t.j41(22,"div",16)(23,"div",17),t.nrm(24,"ion-icon",18),t.j41(25,"span"),t.EFF(26,"15-20 min"),t.k0s()(),t.j41(27,"div",17),t.nrm(28,"ion-icon",19),t.j41(29,"span"),t.EFF(30,"Sin costo"),t.k0s()()()()(),t.j41(31,"div",10),t.bIt("click",function(){return e.onMethodChange("domicilio")}),t.j41(32,"div",11)(33,"div",12),t.nrm(34,"ion-icon",20),t.k0s(),t.DNE(35,pt,2,0,"div",14),t.k0s(),t.j41(36,"div",15)(37,"h3"),t.EFF(38,"Entrega a domicilio"),t.k0s(),t.j41(39,"p"),t.EFF(40,"Recibe tu pedido en la comodidad de tu hogar"),t.k0s(),t.j41(41,"div",16)(42,"div",17),t.nrm(43,"ion-icon",18),t.j41(44,"span"),t.EFF(45,"30-45 min"),t.k0s()(),t.j41(46,"div",17),t.nrm(47,"ion-icon",21),t.j41(48,"span"),t.EFF(49,"A tu puerta"),t.k0s()()()()()()(),t.j41(50,"div",22)(51,"div",23)(52,"div",24),t.nrm(53,"ion-icon",25),t.j41(54,"h3"),t.EFF(55,"Resumen del pedido"),t.k0s()(),t.j41(56,"div",26)(57,"div",27)(58,"div",28)(59,"span",29),t.nrm(60,"ion-icon",30),t.EFF(61," Productos "),t.k0s(),t.j41(62,"span",31),t.EFF(63),t.k0s()(),t.j41(64,"div",28)(65,"span",29),t.EFF(66,"Subtotal"),t.k0s(),t.j41(67,"span",31),t.EFF(68),t.nI1(69,"currency"),t.k0s()(),t.DNE(70,mt,7,10,"div",32),t.k0s(),t.nrm(71,"div",33),t.j41(72,"div",34)(73,"div",35)(74,"span",36),t.EFF(75,"Total a pagar"),t.k0s(),t.j41(76,"span",37),t.EFF(77),t.nI1(78,"currency"),t.k0s()(),t.DNE(79,gt,5,9,"div",38),t.k0s()()()()()()(),t.j41(80,"ion-footer")(81,"ion-toolbar")(82,"div",39),t.DNE(83,ft,4,2,"div",40),t.j41(84,"ion-button",41),t.bIt("click",function(){return e.continue()}),t.nrm(85,"ion-icon",42),t.EFF(86," Continuar con el pedido "),t.k0s()()()()),2&o&&(t.Y8G("showMenu",!0),t.R7$(),t.Y8G("fullscreen",!0),t.R7$(11),t.AVh("selected","negocio"===e.selectedMethod),t.R7$(4),t.Y8G("ngIf","negocio"===e.selectedMethod),t.R7$(15),t.AVh("selected","domicilio"===e.selectedMethod),t.R7$(4),t.Y8G("ngIf","domicilio"===e.selectedMethod),t.R7$(28),t.SpI("",(null==e.cart||null==e.cart.detalle_carrito?null:e.cart.detalle_carrito.length)||0," items"),t.R7$(5),t.SpI("",t.iJd(69,15,t.eq3(27,S,null==e.cart?null:e.cart.total))," MXN"),t.R7$(2),t.Y8G("ngIf",e.discountAmount>0),t.R7$(7),t.SpI("",t.iJd(78,21,t.eq3(29,S,e.getTotalAmount()))," MXN"),t.R7$(2),t.Y8G("ngIf",e.discountAmount>0),t.R7$(4),t.Y8G("ngIf",e.selectedMethod),t.R7$(),t.Y8G("disabled",!e.selectedMethod))},dependencies:[b.bT,s.Jm,s.W9,s.M0,s.iq,s.ai,x.l,b.oe],styles:['ion-content[_ngcontent-%COMP%]{--background: linear-gradient(135deg, #a3a3a3 0%, #e2e2e2 100%);--padding-start: 0;--padding-end: 0}.container[_ngcontent-%COMP%]{min-height:100vh;padding:0 16px 100px}.hero-section[_ngcontent-%COMP%]{text-align:center;padding:40px 20px;color:#fff}.hero-section[_ngcontent-%COMP%]   .hero-icon[_ngcontent-%COMP%]{font-size:4rem;margin-bottom:16px;opacity:.9}.hero-section[_ngcontent-%COMP%]   .hero-title[_ngcontent-%COMP%]{font-size:1.8rem;font-weight:700;margin:0 0 8px;text-shadow:0 2px 4px rgba(0,0,0,.3)}.hero-section[_ngcontent-%COMP%]   .hero-subtitle[_ngcontent-%COMP%]{font-size:1rem;opacity:.9;margin:0;font-weight:400}.content-grid[_ngcontent-%COMP%]{display:grid;gap:24px;max-width:1200px;margin:0 auto}@media (min-width: 768px){.content-grid[_ngcontent-%COMP%]{grid-template-columns:2fr 1fr;gap:32px}}.delivery-section[_ngcontent-%COMP%]   .delivery-options[_ngcontent-%COMP%]{display:grid;gap:20px}@media (min-width: 480px){.delivery-section[_ngcontent-%COMP%]   .delivery-options[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr;gap:16px}}@media (min-width: 768px){.delivery-section[_ngcontent-%COMP%]   .delivery-options[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:20px}}.delivery-option[_ngcontent-%COMP%]{background:#fff;border-radius:20px;padding:24px;cursor:pointer;transition:all .3s cubic-bezier(.4,0,.2,1);border:3px solid transparent;box-shadow:0 8px 32px #0000001a;position:relative;overflow:hidden}.delivery-option[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background:linear-gradient(135deg,#667eea0d,#764ba20d);opacity:0;transition:opacity .3s ease}.delivery-option[_ngcontent-%COMP%]:hover{transform:translateY(-4px);box-shadow:0 16px 48px #00000026}.delivery-option[_ngcontent-%COMP%]:hover:before{opacity:1}.delivery-option[_ngcontent-%COMP%]:hover   .option-main-icon[_ngcontent-%COMP%]{transform:scale(1.1)}.delivery-option.selected[_ngcontent-%COMP%]{border-color:var(--ion-color-primary);transform:translateY(-2px);box-shadow:0 12px 40px rgba(var(--ion-color-primary-rgb),.3)}.delivery-option.selected[_ngcontent-%COMP%]:before{opacity:1;background:linear-gradient(135deg,rgba(var(--ion-color-primary-rgb),.1),rgba(var(--ion-color-secondary-rgb),.1))}.delivery-option.selected[_ngcontent-%COMP%]   .option-main-icon[_ngcontent-%COMP%]{color:var(--ion-color-primary);transform:scale(1.05)}.delivery-option.selected[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:var(--ion-color-primary)}.option-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;position:relative;z-index:1}.option-icon-wrapper[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:50%;background:linear-gradient(135deg,#f8f9fa,#e9ecef);display:flex;align-items:center;justify-content:center;box-shadow:0 4px 12px #0000001a}.option-main-icon[_ngcontent-%COMP%]{font-size:1.8rem;color:var(--ion-color-medium);transition:all .3s ease}.option-badge[_ngcontent-%COMP%]{width:32px;height:32px;background:var(--ion-color-success);border-radius:50%;display:flex;align-items:center;justify-content:center}.option-badge[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#fff;font-size:1.2rem}.option-content[_ngcontent-%COMP%]{position:relative;z-index:1}.option-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.3rem;font-weight:700;margin:0 0 8px;color:var(--ion-color-dark);transition:color .3s ease}.option-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--ion-color-medium);font-size:.95rem;margin:0 0 16px;line-height:1.4}.option-features[_ngcontent-%COMP%]{display:flex;gap:16px}.option-features[_ngcontent-%COMP%]   .feature[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;font-size:.85rem;color:var(--ion-color-medium)}.option-features[_ngcontent-%COMP%]   .feature[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1rem;color:var(--ion-color-primary)}@media (max-width: 767px){.summary-section[_ngcontent-%COMP%]{order:-1}}.summary-card[_ngcontent-%COMP%]{background:#fff;border-radius:20px;overflow:hidden;box-shadow:0 8px 32px #0000001a;position:sticky;top:20px}.summary-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--ion-color-primary) 0%,var(--ion-color-secondary) 100%);color:#fff;padding:20px 24px;display:flex;align-items:center;gap:12px}.summary-header[_ngcontent-%COMP%]   .summary-icon[_ngcontent-%COMP%]{font-size:1.5rem}.summary-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.2rem;font-weight:600}.summary-content[_ngcontent-%COMP%]{padding:24px}.order-details[_ngcontent-%COMP%]{margin-bottom:20px}.detail-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:12px 0;border-bottom:1px solid #f0f0f0}.detail-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.detail-row[_ngcontent-%COMP%]   .detail-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;color:var(--ion-color-medium);font-size:.95rem}.detail-row[_ngcontent-%COMP%]   .detail-label[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1rem;color:var(--ion-color-primary)}.detail-row[_ngcontent-%COMP%]   .detail-label.discount-label[_ngcontent-%COMP%]{color:var(--ion-color-warning);font-weight:600}.detail-row[_ngcontent-%COMP%]   .detail-value[_ngcontent-%COMP%]{font-weight:600;color:var(--ion-color-dark)}.detail-row[_ngcontent-%COMP%]   .detail-value.discount-value[_ngcontent-%COMP%]{color:var(--ion-color-warning)}.summary-divider[_ngcontent-%COMP%]{height:2px;background:linear-gradient(to right,transparent,var(--ion-color-primary),transparent);margin:16px 0;border-radius:2px}.total-section[_ngcontent-%COMP%]   .total-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:16px 0}.total-section[_ngcontent-%COMP%]   .total-row[_ngcontent-%COMP%]   .total-label[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:600;color:var(--ion-color-dark)}.total-section[_ngcontent-%COMP%]   .total-row[_ngcontent-%COMP%]   .total-amount[_ngcontent-%COMP%]{font-size:1.4rem;font-weight:700;color:var(--ion-color-primary)}.total-section[_ngcontent-%COMP%]   .savings[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:12px 16px;background:linear-gradient(135deg,rgba(var(--ion-color-success-rgb),.1),rgba(var(--ion-color-success-rgb),.05));border-radius:12px;margin-top:12px}.total-section[_ngcontent-%COMP%]   .savings[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:var(--ion-color-success);font-size:1.2rem}.total-section[_ngcontent-%COMP%]   .savings[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--ion-color-success);font-weight:600;font-size:.9rem}ion-footer[_ngcontent-%COMP%]{background:#fff;border-top:1px solid #f0f0f0}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background: transparent;--padding-start: 16px;--padding-end: 16px;--padding-top: 16px;--padding-bottom: 16px}.footer-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.selected-method[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:8px 16px;background:rgba(var(--ion-color-primary-rgb),.1);border-radius:8px;font-size:.9rem;color:var(--ion-color-primary);font-weight:600}.selected-method[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1rem}.continue-button[_ngcontent-%COMP%]{--border-radius: 16px;--padding-start: 24px;--padding-end: 24px;height:56px;font-size:1.1rem;font-weight:600;background:linear-gradient(135deg,var(--ion-color-primary) 0%,var(--ion-color-secondary) 100%);box-shadow:0 4px 16px rgba(var(--ion-color-primary-rgb),.4);transition:all .3s ease}.continue-button[_ngcontent-%COMP%]:not([disabled]):hover{transform:translateY(-2px);box-shadow:0 8px 24px rgba(var(--ion-color-primary-rgb),.5)}.continue-button[disabled][_ngcontent-%COMP%]{opacity:.5;background:var(--ion-color-medium);box-shadow:none}.continue-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1.2rem}@keyframes _ngcontent-%COMP%_slideInUp{0%{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}.delivery-option[_ngcontent-%COMP%], .summary-card[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideInUp .6s ease-out}.delivery-option[_ngcontent-%COMP%]:nth-child(1){animation-delay:.1s}.delivery-option[_ngcontent-%COMP%]:nth-child(2){animation-delay:.2s}.summary-card[_ngcontent-%COMP%]{animation-delay:.3s}@media (max-width: 480px){.container[_ngcontent-%COMP%]{padding:0 12px 100px}.hero-section[_ngcontent-%COMP%]{padding:30px 16px}.hero-section[_ngcontent-%COMP%]   .hero-title[_ngcontent-%COMP%]{font-size:1.5rem}.hero-section[_ngcontent-%COMP%]   .hero-icon[_ngcontent-%COMP%]{font-size:3rem}.delivery-option[_ngcontent-%COMP%]{padding:20px}.option-features[_ngcontent-%COMP%]{flex-direction:column;gap:8px}.summary-content[_ngcontent-%COMP%]{padding:20px}}']}),c})()}];let vt=(()=>{var n;class c{}return(n=c).\u0275fac=function(o){return new(o||n)},n.\u0275mod=t.$C({type:n}),n.\u0275inj=t.G2t({imports:[j.iI.forChild(_t),j.iI]}),c})();var ht=v(7383);let yt=(()=>{var n;class c{}return(n=c).\u0275fac=function(o){return new(o||n)},n.\u0275mod=t.$C({type:n}),n.\u0275inj=t.G2t({imports:[b.MD,T.YN,s.bv,vt,ht.G]}),c})()}}]);