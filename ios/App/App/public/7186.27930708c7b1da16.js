"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7186],{7186:(Pt,$,C)=>{C.r($),C.d($,{MetodoEntregaNegocioPageModule:()=>bt});var y=C(177),S=C(9417),s=C(5933),k=C(8265),v=C(467),t=C(4438),I=C(7517),j=C(2723),T=C(1876),w=C(8461);const O=n=>[n,"MXN","symbol-narrow","1.2-2","en-US"],A=()=>[0,"MXN","symbol-narrow","1.2-2","en-US"],G=()=>[5,"MXN","symbol-narrow","1.2-2","en-US"];function z(n,c){if(1&n&&(t.j41(0,"div",12)(1,"span"),t.EFF(2),t.k0s(),t.j41(3,"span"),t.EFF(4),t.nI1(5,"currency"),t.k0s()()),2&n){const i=c.$implicit;t.R7$(2),t.Lme("",(null==i.producto?null:i.producto.nombre)||""," x",i.cantidad,""),t.R7$(2),t.SpI("",t.iJd(5,3,t.eq3(9,O,i.subtotal))," MXN")}}function X(n,c){if(1&n&&(t.j41(0,"div",12)(1,"span",22),t.EFF(2,"Subtotal: "),t.k0s(),t.j41(3,"span",22),t.EFF(4),t.nI1(5,"currency"),t.k0s()()),2&n){const i=t.XpG();t.R7$(4),t.SpI("",t.iJd(5,1,t.eq3(7,O,null==i.cart?null:i.cart.total))," MXN")}}function Y(n,c){if(1&n&&(t.j41(0,"div",12)(1,"span",23),t.EFF(2,"Descuento: "),t.k0s(),t.j41(3,"span",23),t.EFF(4),t.nI1(5,"number"),t.k0s()()),2&n){const i=t.XpG();t.R7$(4),t.SpI("-",t.i5U(5,1,i.porcentaje,"1.0-0"),"%")}}function L(n,c){if(1&n&&(t.j41(0,"div",12)(1,"span",24),t.EFF(2,"Subtotal con descuento:"),t.k0s(),t.j41(3,"span",24),t.EFF(4),t.nI1(5,"currency"),t.k0s()()),2&n){const i=t.XpG();t.R7$(4),t.SpI("",t.iJd(5,1,t.eq3(7,O,(null==i.cart?null:i.cart.total)-(null==i.cart?null:i.cart.total)*(i.porcentaje/100)))," MXN")}}function H(n,c){if(1&n&&(t.j41(0,"div",12)(1,"span"),t.EFF(2,"Subtotal:"),t.k0s(),t.j41(3,"span"),t.EFF(4),t.nI1(5,"currency"),t.k0s()()),2&n){const i=t.XpG();t.R7$(4),t.SpI("",t.iJd(5,1,t.eq3(7,O,null==i.cart?null:i.cart.total))," MXN")}}function J(n,c){1&n&&(t.j41(0,"div",25),t.nrm(1,"ion-icon",26),t.j41(2,"span",27),t.EFF(3,"\xa1Tienes env\xedo gratis!"),t.k0s()())}function B(n,c){1&n&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"currency"),t.k0s()),2&n&&(t.R7$(),t.SpI("",t.iJd(2,1,t.lJ4(7,A))," MXN"))}function q(n,c){if(1&n&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"currency"),t.k0s()),2&n){const i=t.XpG();t.R7$(),t.SpI("",t.iJd(2,1,t.eq3(7,O,i.transportFee))," MXN")}}function U(n,c){1&n&&(t.j41(0,"div",12)(1,"span"),t.EFF(2,"Cargo de servicio:"),t.k0s(),t.j41(3,"span"),t.EFF(4),t.nI1(5,"currency"),t.k0s()()),2&n&&(t.R7$(4),t.SpI("",t.iJd(5,1,t.lJ4(7,G))," MXN"))}function V(n,c){if(1&n&&(t.j41(0,"div",28),t.nrm(1,"ion-icon",29),t.j41(2,"span",30),t.EFF(3),t.nI1(4,"currency"),t.k0s()()),2&n){const i=t.XpG();t.R7$(3),t.SpI("Agrega ",t.iJd(4,1,t.eq3(7,O,140-((null==i.cart?null:i.cart.total)-(null==i.cart?null:i.cart.total)*(i.porcentaje/100))))," MXN m\xe1s para env\xedo gratis")}}function W(n,c){if(1&n&&(t.j41(0,"span")(1,"strong"),t.EFF(2),t.nI1(3,"currency"),t.k0s()()),2&n){const i=t.XpG();t.R7$(2),t.SpI("",t.iJd(3,1,t.eq3(7,O,(null==i.cart?null:i.cart.total)-(null==i.cart?null:i.cart.total)*(i.porcentaje/100)))," MXN")}}function Q(n,c){if(1&n&&(t.j41(0,"span")(1,"strong"),t.EFF(2),t.nI1(3,"currency"),t.k0s()()),2&n){const i=t.XpG();t.R7$(2),t.SpI("",t.iJd(3,1,t.eq3(7,O,(null==i.cart?null:i.cart.total)-(null==i.cart?null:i.cart.total)*(i.porcentaje/100)+i.transportFee+5))," MXN")}}function Z(n,c){1&n&&(t.j41(0,"div",31),t.nrm(1,"div",32),t.k0s())}function K(n,c){1&n&&t.nrm(0,"ion-icon",36)}function tt(n,c){if(1&n){const i=t.RV6();t.j41(0,"div",33)(1,"ion-button",34),t.bIt("click",function(){t.eBV(i);const e=t.XpG();return t.Njj(e.confirmPayment())}),t.DNE(2,K,1,0,"ion-icon",35),t.EFF(3),t.k0s()()}if(2&n){const i=t.XpG();t.R7$(),t.AVh("animated",i.confirming),t.Y8G("disabled",i.confirming||i.paymentConfirmed),t.R7$(),t.Y8G("ngIf",i.paymentConfirmed),t.R7$(),t.SpI(" ",i.paymentConfirmed?"Pedido Confirmado":"Confirmar Pago"," ")}}let ot=(()=>{var n;class c{constructor(){this.selectedPayment=null,this.confirming=!1,this.paymentConfirmed=!1,this.utilsSvc=(0,t.WQX)(j.T),this.firebaseSvc=(0,t.WQX)(I.f),this.emailSvc=(0,t.WQX)(T._),this.discountAmount=0,this.porcentaje=0,this.distanciaKm=0,this.transportFee=0}ngOnInit(){this.getCartDetails(),this.applyStoredCoupon();const o=this.dir()[0];o&&this.firebaseSvc.getCollectionData("direccionNegocio").subscribe(e=>{if(e&&e.length>0){const a=e[0],r=this.calcularDistancia(parseFloat(o.geopoint._lat||o.geopoint.latitude),parseFloat(o.geopoint._long||o.geopoint.longitude),parseFloat(a.geopoint.latitude)||parseFloat(a.geopoint._lat),parseFloat(a.geopoint.longitude)||parseFloat(a.geopoint._long));this.distanciaKm=parseFloat(r.toFixed(2)),this.loadTransportFeeFromFirebase(this.distanciaKm)}})}loadTransportFeeFromFirebase(o){var e=this;return(0,v.A)(function*(){try{e.firebaseSvc.getCollectionData("tarifas_transporte").subscribe(a=>{if(a&&a.length>0){const r=a.find(l=>o>=l.distancia_min&&o<=l.distancia_max&&l.activo);if(r)return void(e.transportFee=r.tarifa)}e.firebaseSvc.getCollectionData("tarifa_fija").subscribe(r=>{e.transportFee=r&&r.length>0&&r[0].activo?r[0].precio:e.calculateTransportFee(o)})})}catch(a){console.error("Error loading transport fee from Firebase:",a),e.transportFee=e.calculateTransportFee(o)}})()}calculateTransportFee(o){return o<=.5?30:o<=1?35:o<=1.5?50:o<=2?65:o<=2.5?70:o<=3?80:o<=3.5?90:o<=4?115:o<=4.5?125:145}sendOrderConfirmationEmail(o,e){var a=this;return(0,v.A)(function*(){try{const r=a.utilsSvc.getFromLocalStorage("user"),l={orderId:o,customerEmail:r.email,customerName:r.name||r.email,fecha:new Date,estatus:"Pedido confirmado",tipo_pago:e,items:a.cart.detalle_carrito,subtotal:a.cart.total,discountAmount:a.cart.total*(a.porcentaje/100),discountPercent:a.porcentaje,transportFee:a.transportFee,total:a.cart.total-a.cart.total*(a.porcentaje/100)+a.transportFee};yield a.emailSvc.sendOrderConfirmationEmail(l),console.log("Email de confirmaci\xf3n enviado exitosamente")}catch(r){console.error("Error al enviar email de confirmaci\xf3n:",r)}})()}renderPayPalButton(){var a,o=this;document.getElementById("paypal-button-container")?window.paypal.Buttons({createOrder:(a,r)=>{const l=this.cart.total-this.cart.total*(this.porcentaje/100);return r.order.create({purchase_units:[{amount:{value:(l+(l>=140?0:this.transportFee)+(l<140?5:0)).toFixed(2)},shipping_address:{country_code:"MX"}}],shipping_preference:"SET_PROVIDED_ADDRESS"})},onApprove:(a=(0,v.A)(function*(r,l){return l.order.capture().then(function(){var d=(0,v.A)(function*(m){console.log("Pago completado:",m);const u=yield o.utilsSvc.loading();yield u.present(),o.confirming=!0,setTimeout(()=>{o.confirming=!1,o.paymentConfirmed=!0},3e3),setTimeout((0,v.A)(function*(){const p=document.querySelector(".confirm-button");p&&p.classList.add("complete");const M=o.utilsSvc.getFromLocalStorage("user").uid,x=o.dir()[0],b=o.cart.total-o.cart.total*(o.porcentaje/100),f=b+(b>=140?0:o.transportFee)+(b<140?5:0),P={estatus:"Pedido confirmado",fecha:new Date,fecha_entrega:new Date(o.cart.fecha_entrega),pago_confirmado:!0,tipo_pago:"Tarjeta",tipo_entrega:"Negocio",total:f,uid_cliente:M,geopoint_entrega:{latitude:x.geopoint._lat,longitude:x.geopoint._long}},D=o.cart.detalle_carrito.map(h=>({cantidad:h.cantidad,subtotal:h.subtotal,uid_producto:h.uid_producto,uid_opcion:h.uid_opcion,tamano_tortilla:h.tamano_tortilla}));o.utilsSvc.setElementInLocalstorage("pedido",P),o.utilsSvc.setElementInLocalstorage("detalle_pedido",D);const N=o.cart.id;if(N)try{for(let h of o.cart.detalle_carrito)yield o.firebaseSvc.deleteDocumet(`users/${M}/carrito_negocio/${N}/detalle_carrito/${h.id}`)}catch(h){console.error("Error deleting cart items:",h)}else console.warn("Cart ID is missing, skipping cart item deletion");const R=yield o.firebaseSvc.addDocument("pedidos",P);for(let h of o.cart.detalle_carrito)h.tamano_tortilla>10?yield o.firebaseSvc.addDocument(`pedidos/${R.id}/detalle_pedido`,{cantidad:h.cantidad,subtotal:h.subtotal,uid_producto:h.uid_producto,uid_opcion:h.uid_opcion,tamano_tortilla:h.tamano_tortilla}):yield o.firebaseSvc.addDocument(`pedidos/${R.id}/detalle_pedido`,{cantidad:h.cantidad,subtotal:h.subtotal,uid_producto:h.uid_producto,uid_opcion:h.uid_opcion});yield o.sendOrderConfirmationEmail(R.id,"Tarjeta"),yield o.firebaseSvc.updateDocumet(`users/${M}/carrito_negocio/${N}`,{total:0}),o.cart.detalle_carrito=[],o.cart.total=0,o.utilsSvc.setElementInLocalstorage("carrito",[o.cart]),localStorage.removeItem("selectedMethod"),u.dismiss(),o.utilsSvc.presentToast({message:"Pedido confirmado",duration:2500,color:"primary",position:"bottom",icon:"alert-circle-outline"}),o.paymentConfirmed=!1,o.utilsSvc.dismissModal(!0),o.utilsSvc.routerLink("/main/confirmacion-pago")}),3e3)});return function(m){return d.apply(this,arguments)}}())}),function(l,d){return a.apply(this,arguments)}),onError:a=>{console.error("Error en el pago:",a),alert("Hubo un problema con el pago. Por favor, int\xe9ntalo de nuevo.")}}).render("#paypal-button-container"):console.error("Contenedor #paypal-button-container no encontrado.")}onPaymentChange(o){var e=this;return(0,v.A)(function*(){if(e.selectedPayment=o,"paypal"===o){const a=yield e.utilsSvc.loading();yield a.present(),setTimeout(()=>{e.renderPayPalButton(),a.dismiss()},1500)}})()}confirmPayment(){var o=this;return(0,v.A)(function*(){const e=yield o.utilsSvc.loading();yield e.present(),o.confirming=!0,setTimeout(()=>{o.confirming=!1,o.paymentConfirmed=!0},3e3),setTimeout((0,v.A)(function*(){const a=document.querySelector(".confirm-button");a&&a.classList.add("complete");const r=o.utilsSvc.getFromLocalStorage("user").uid,l=o.dir()[0],d=o.cart.total-o.cart.total*(o.porcentaje/100),p=d+(d>=140?0:o.transportFee)+(d<140?5:0),M={estatus:"Pedido confirmado",fecha:new Date,fecha_entrega:new Date(o.cart.fecha_entrega),pago_confirmado:!1,tipo_pago:"Efectivo",tipo_entrega:"Negocio",total:p,uid_cliente:r,geopoint_entrega:{latitude:l.geopoint._lat,longitude:l.geopoint._long}},x=o.cart.detalle_carrito.map(g=>({cantidad:g.cantidad,subtotal:g.subtotal,uid_producto:g.uid_producto,uid_opcion:g.uid_opcion,tamano_tortilla:g.tamano_tortilla}));o.utilsSvc.setElementInLocalstorage("pedido",M),o.utilsSvc.setElementInLocalstorage("detalle_pedido",x);const b=o.cart.id;if(b)try{for(let g of o.cart.detalle_carrito)yield o.firebaseSvc.deleteDocumet(`users/${r}/carrito_negocio/${b}/detalle_carrito/${g.id}`)}catch(g){console.error("Error deleting cart items:",g)}else console.warn("Cart ID is missing, skipping cart item deletion");const _=yield o.firebaseSvc.addDocument("pedidos",M);for(let g of o.cart.detalle_carrito)g.tamano_tortilla?yield o.firebaseSvc.addDocument(`pedidos/${_.id}/detalle_pedido`,{cantidad:g.cantidad,subtotal:g.subtotal,uid_producto:g.uid_producto,uid_opcion:g.uid_opcion,tamano_tortilla:g.tamano_tortilla}):yield o.firebaseSvc.addDocument(`pedidos/${_.id}/detalle_pedido`,{cantidad:g.cantidad,subtotal:g.subtotal,uid_producto:g.uid_producto,uid_opcion:g.uid_opcion});yield o.sendOrderConfirmationEmail(_.id,"Efectivo"),b&&(yield o.firebaseSvc.updateDocumet(`users/${r}/carrito_negocio/${b}`,{total:0})),o.cart.detalle_carrito=[],o.cart.total=0,o.utilsSvc.setElementInLocalstorage("carrito_negocio",[o.cart]),localStorage.removeItem("selectedMethod"),e.dismiss(),o.utilsSvc.presentToast({message:"Pedido confirmado",duration:2500,color:"primary",position:"bottom",icon:"alert-circle-outline"}),o.paymentConfirmed=!1,o.utilsSvc.dismissModal(!0),o.utilsSvc.routerLink("/main/confirmacion-pago")}),3e3)})()}getCartDetails(){var o=this;return(0,v.A)(function*(){const e=yield o.utilsSvc.loading();yield e.present();const a=o.utilsSvc.getFromLocalStorage("carrito_negocio");o.cart=a[0];for(let r of o.cart.detalle_carrito){const l=yield o.firebaseSvc.getDocument(`productos/${r.uid_producto}`),d=yield o.firebaseSvc.getDocument(`productos/${r.uid_producto}/opciones/${r.uid_opcion}`);r.producto=l||{},r.opcion=d||{}}console.log("Carrito:",o.cart),e.dismiss()})()}applyStoredCoupon(){if(this.cart=this.utilsSvc.getFromLocalStorage("carrito_negocio")[0],this.cart){const o=this.utilsSvc.getFromLocalStorage("appliedCoupon");o&&(this.discountAmount=this.cart.total*o.porcentaje/100,this.porcentaje=o.porcentaje,this.cart.total-=this.discountAmount)}}calcularDistancia(o,e,a,r){const d=(a-o)*Math.PI/180,m=(r-e)*Math.PI/180,u=Math.sin(d/2)*Math.sin(d/2)+Math.cos(o*Math.PI/180)*Math.cos(a*Math.PI/180)*Math.sin(m/2)*Math.sin(m/2);return 2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u))*6371}dir(){return this.utilsSvc.getFromLocalStorage("direccion")||{}}}return(n=c).\u0275fac=function(o){return new(o||n)},n.\u0275cmp=t.VBU({type:n,selectors:[["app-entrega-domicilio-negocio"]],decls:54,vars:31,consts:[["title","Pago",3,"isModal"],[3,"fullscreen"],[1,"payment-card"],[1,"title"],[3,"ionChange"],["button","",1,"option-card",3,"click"],["name","cash-outline","slot","start",1,"option-icon"],["slot","end","value","efectivo"],["name","card-outline","slot","start",1,"option-icon"],["slot","end","value","tarjeta"],[1,"summary-card"],[1,"summary-title"],[1,"summary-item"],["class","summary-item",4,"ngFor","ngForOf"],[1,"divider"],["class","summary-item",4,"ngIf"],["class","free-shipping-message",4,"ngIf"],[4,"ngIf"],["class","motivational-message",4,"ngIf"],[1,"summary-item","total-item"],["class","confirm-button-container-paypal",4,"ngIf"],["class","confirm-button-container",4,"ngIf"],[1,"original-price"],[1,"descuento"],[1,"discounted-price"],[1,"free-shipping-message"],["name","gift-outline","color","success"],[1,"success-text"],[1,"motivational-message"],["name","information-circle-outline","color","primary"],[1,"info-text"],[1,"confirm-button-container-paypal"],["id","paypal-button-container"],[1,"confirm-button-container"],["expand","block","mode","ios",3,"click","disabled"],["name","checkmark-outline","slot","start",4,"ngIf"],["name","checkmark-outline","slot","start"]],template:function(o,e){1&o&&(t.nrm(0,"app-header",0),t.j41(1,"ion-content",1)(2,"ion-card",2)(3,"ion-card-header")(4,"h2",3),t.EFF(5,"M\xe9todo de Pago"),t.k0s()(),t.j41(6,"ion-card-content")(7,"ion-radio-group",4),t.bIt("ionChange",function(r){return e.onPaymentChange(r.detail.value)}),t.j41(8,"ion-card",5),t.bIt("click",function(){return e.onPaymentChange("efectivo")}),t.j41(9,"ion-item"),t.nrm(10,"ion-icon",6),t.j41(11,"ion-label"),t.EFF(12,"Efectivo en domicilio"),t.k0s(),t.nrm(13,"ion-radio",7),t.k0s()(),t.j41(14,"ion-card",5),t.bIt("click",function(){return e.onPaymentChange("paypal")}),t.j41(15,"ion-item"),t.nrm(16,"ion-icon",8),t.j41(17,"ion-label"),t.EFF(18,"Tarjeta"),t.k0s(),t.nrm(19,"ion-radio",9),t.k0s()()()()(),t.j41(20,"ion-card",10)(21,"ion-card-header")(22,"h3",11),t.EFF(23,"Resumen de compra"),t.k0s()(),t.j41(24,"ion-card-content")(25,"div",12)(26,"span"),t.EFF(27),t.k0s(),t.j41(28,"span"),t.EFF(29),t.nI1(30,"currency"),t.k0s()(),t.DNE(31,z,6,11,"div",13),t.nrm(32,"div",14),t.DNE(33,X,6,9,"div",15)(34,Y,6,4,"div",15)(35,L,6,9,"div",15)(36,H,6,9,"div",15)(37,J,4,0,"div",16),t.j41(38,"div",12)(39,"span"),t.EFF(40),t.k0s(),t.DNE(41,B,3,8,"span",17)(42,q,3,9,"span",17),t.k0s(),t.DNE(43,U,6,8,"div",15)(44,V,5,9,"div",18),t.nrm(45,"div",14),t.j41(46,"div",19)(47,"span")(48,"strong"),t.EFF(49,"Total a pagar:"),t.k0s()(),t.DNE(50,W,4,9,"span",17)(51,Q,4,9,"span",17),t.k0s()()(),t.DNE(52,Z,2,0,"div",20)(53,tt,4,5,"div",21),t.k0s()),2&o&&(t.Y8G("isModal",!0),t.R7$(),t.Y8G("fullscreen",!0),t.R7$(7),t.AVh("selected","efectivo"===e.selectedPayment),t.R7$(6),t.AVh("selected","paypal"===e.selectedPayment),t.R7$(13),t.SpI("Productos (",(null==e.cart||null==e.cart.detalle_carrito?null:e.cart.detalle_carrito.length)||0,")"),t.R7$(2),t.SpI("",t.iJd(30,23,t.eq3(29,O,null==e.cart?null:e.cart.total))," MXN"),t.R7$(2),t.Y8G("ngForOf",null==e.cart?null:e.cart.detalle_carrito),t.R7$(2),t.Y8G("ngIf",e.discountAmount>0),t.R7$(),t.Y8G("ngIf",e.discountAmount>0),t.R7$(),t.Y8G("ngIf",e.discountAmount>0),t.R7$(),t.Y8G("ngIf",0===e.discountAmount),t.R7$(),t.Y8G("ngIf",(null==e.cart?null:e.cart.total)-(null==e.cart?null:e.cart.total)*(e.porcentaje/100)>=140),t.R7$(3),t.SpI("Tarifa de transporte (",e.distanciaKm," km):"),t.R7$(),t.Y8G("ngIf",(null==e.cart?null:e.cart.total)-(null==e.cart?null:e.cart.total)*(e.porcentaje/100)>=140),t.R7$(),t.Y8G("ngIf",(null==e.cart?null:e.cart.total)-(null==e.cart?null:e.cart.total)*(e.porcentaje/100)<140),t.R7$(),t.Y8G("ngIf",(null==e.cart?null:e.cart.total)-(null==e.cart?null:e.cart.total)*(e.porcentaje/100)<140),t.R7$(),t.Y8G("ngIf",(null==e.cart?null:e.cart.total)-(null==e.cart?null:e.cart.total)*(e.porcentaje/100)<140),t.R7$(6),t.Y8G("ngIf",(null==e.cart?null:e.cart.total)-(null==e.cart?null:e.cart.total)*(e.porcentaje/100)>=140),t.R7$(),t.Y8G("ngIf",(null==e.cart?null:e.cart.total)-(null==e.cart?null:e.cart.total)*(e.porcentaje/100)<140),t.R7$(),t.Y8G("ngIf","tarjeta"===e.selectedPayment),t.R7$(),t.Y8G("ngIf","efectivo"===e.selectedPayment))},dependencies:[y.Sq,y.bT,s.Jm,s.b_,s.I9,s.ME,s.W9,s.iq,s.uz,s.he,s.KO,s.f0,s.uR,s.Je,w.l,y.QX,y.oe],styles:['@charset "UTF-8";.payment-card[_ngcontent-%COMP%], .summary-card[_ngcontent-%COMP%]{margin:16px;border-radius:16px;box-shadow:0 4px 8px #0000001a}.title[_ngcontent-%COMP%], .summary-title[_ngcontent-%COMP%]{font-size:1.2rem;font-weight:700;text-align:center;color:var(--ion-color-primary)}.option-card[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:16px;transition:transform .2s ease,background-color .3s ease}.option-card.selected[_ngcontent-%COMP%]{transform:scale(1.05);background-color:var(--ion-color-primary-tint)}.option-icon[_ngcontent-%COMP%]{font-size:2rem;color:var(--ion-color-primary);margin-right:8px}.summary-card[_ngcontent-%COMP%]{background-color:#f8f9fa;color:#343a40}.summary-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:12px 0;font-size:1rem}.divider[_ngcontent-%COMP%]{border-bottom:1px solid #dee2e6;margin:8px 0}.confirm-button-container[_ngcontent-%COMP%], .confirm-button-container-paypal[_ngcontent-%COMP%]{margin:16px}.confirm-button[_ngcontent-%COMP%]{--background: var(--ion-color-primary);color:#fff;font-weight:700;border-radius:24px;text-align:center;position:relative;overflow:hidden;transition:background-color .3s ease-in-out}.complete[_ngcontent-%COMP%]{--background: var(--ion-color-primary);color:#fff;font-weight:700;border-radius:24px;text-align:center;position:relative;overflow:hidden}.confirm-button.animated[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;height:100%;width:0%;background:linear-gradient(to right,var(--ion-color-primary),var(--ion-color-secondary),var(--ion-color-tertiary));z-index:1;animation:_ngcontent-%COMP%_slideIn 3s forwards}.confirm-button.animated[_ngcontent-%COMP%]{color:transparent}.confirm-button.animated[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#fff}.confirm-button.complete[_ngcontent-%COMP%]{--background: var(--ion-color-primary)}@keyframes _ngcontent-%COMP%_slideIn{0%{width:0%}50%{width:100%}to{width:0%}}.total-summary[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start}.total-summary[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin:4px 0}.discounted-price[_ngcontent-%COMP%]{color:green;font-weight:700}.original-price[_ngcontent-%COMP%]{color:gray;text-decoration:line-through;font-size:17px}.descuento[_ngcontent-%COMP%]{font-weight:700;font-size:17px}.free-shipping-message[_ngcontent-%COMP%], .motivational-message[_ngcontent-%COMP%]{display:flex;align-items:center;padding:8px 12px;margin:8px 0;border-radius:8px;font-size:.9rem}.free-shipping-message[_ngcontent-%COMP%]{background-color:#28a7451a;border:1px solid rgba(40,167,69,.3)}.motivational-message[_ngcontent-%COMP%]{background-color:#007bff1a;border:1px solid rgba(0,123,255,.3)}.success-text[_ngcontent-%COMP%]{color:var(--ion-color-success);font-weight:500;margin-left:8px}.info-text[_ngcontent-%COMP%]{color:var(--ion-color-primary);font-weight:500;margin-left:8px}.total-item[_ngcontent-%COMP%]{font-size:1.1rem;border-top:2px solid var(--ion-color-primary);padding-top:12px;margin-top:8px}']}),c})();const E=n=>[n,"MXN","symbol-narrow","1.2-2","en-US"];function et(n,c){if(1&n&&(t.j41(0,"div",12)(1,"span"),t.EFF(2),t.k0s(),t.j41(3,"span"),t.EFF(4),t.nI1(5,"currency"),t.k0s()()),2&n){const i=c.$implicit;t.R7$(2),t.Lme("",(null==i.producto?null:i.producto.nombre)||""," x",i.cantidad,""),t.R7$(2),t.SpI("",t.iJd(5,3,t.eq3(9,E,i.subtotal))," MXN")}}function nt(n,c){if(1&n&&(t.j41(0,"div",12)(1,"span",18),t.EFF(2,"Total: "),t.k0s(),t.j41(3,"span",18),t.EFF(4),t.nI1(5,"currency"),t.k0s()()),2&n){const i=t.XpG();t.R7$(4),t.SpI("",t.iJd(5,1,t.eq3(7,E,null==i.cart?null:i.cart.total))," MXN")}}function it(n,c){if(1&n&&(t.j41(0,"div",12)(1,"span",19),t.EFF(2,"Descuento: "),t.k0s(),t.j41(3,"span",19),t.EFF(4),t.nI1(5,"number"),t.k0s()()),2&n){const i=t.XpG();t.R7$(4),t.SpI("-",t.i5U(5,1,i.porcentaje,"1.0-0"),"%")}}function at(n,c){if(1&n&&(t.j41(0,"div",12)(1,"span",20),t.EFF(2,"Total con descuento:"),t.k0s(),t.j41(3,"span",20),t.EFF(4),t.nI1(5,"currency"),t.k0s()()),2&n){const i=t.XpG();t.R7$(4),t.SpI("",t.iJd(5,1,t.eq3(7,E,(null==i.cart?null:i.cart.total)-(null==i.cart?null:i.cart.total)*(i.porcentaje/100)))," MXN")}}function rt(n,c){if(1&n&&(t.j41(0,"div",12)(1,"span"),t.EFF(2,"Pagas"),t.k0s(),t.j41(3,"span"),t.EFF(4),t.nI1(5,"currency"),t.k0s()()),2&n){const i=t.XpG();t.R7$(4),t.SpI("",t.iJd(5,1,t.eq3(7,E,null==i.cart?null:i.cart.total))," MXN")}}function ct(n,c){1&n&&(t.j41(0,"div",21),t.nrm(1,"div",22),t.k0s())}function lt(n,c){1&n&&t.nrm(0,"ion-icon",26)}function st(n,c){if(1&n){const i=t.RV6();t.j41(0,"div",23)(1,"ion-button",24),t.bIt("click",function(){t.eBV(i);const e=t.XpG();return t.Njj(e.confirmPayment())}),t.DNE(2,lt,1,0,"ion-icon",25),t.EFF(3),t.k0s()()}if(2&n){const i=t.XpG();t.R7$(),t.AVh("animated",i.confirming),t.Y8G("disabled",i.confirming||i.paymentConfirmed),t.R7$(),t.Y8G("ngIf",i.paymentConfirmed),t.R7$(),t.SpI(" ",i.paymentConfirmed?"Pedido Confirmado":"Confirmar Pago"," ")}}let dt=(()=>{var n;class c{constructor(){this.selectedPayment=null,this.confirming=!1,this.paymentConfirmed=!1,this.utilsSvc=(0,t.WQX)(j.T),this.firebaseSvc=(0,t.WQX)(I.f),this.emailSvc=(0,t.WQX)(T._),this.discountAmount=0,this.porcentaje=0}ngOnInit(){this.getCartDetails(),console.log(this.cart)}sendOrderConfirmationEmail(o,e){var a=this;return(0,v.A)(function*(){try{const r=a.utilsSvc.getFromLocalStorage("user"),l={orderId:o,customerEmail:r.email,customerName:r.name||r.email,fecha:new Date,estatus:"Pedido confirmado",tipo_pago:e,items:a.cart.detalle_carrito,subtotal:a.cart.total,discountAmount:a.cart.total*(a.porcentaje/100),discountPercent:a.porcentaje,transportFee:0,total:a.cart.total-a.cart.total*(a.porcentaje/100)};yield a.emailSvc.sendOrderConfirmationEmail(l),console.log("Email de confirmaci\xf3n enviado exitosamente")}catch(r){console.error("Error al enviar email de confirmaci\xf3n:",r)}})()}renderPayPalButton(){var a,o=this;document.getElementById("paypal-button-container")?window.paypal.Buttons({createOrder:(a,r)=>r.order.create({purchase_units:[{amount:{value:this.cart.total-this.cart.total*(this.porcentaje/100)},shipping_address:{country_code:"MX"}}],shipping_preference:"SET_PROVIDED_ADDRESS"}),onApprove:(a=(0,v.A)(function*(r,l){return l.order.capture().then(function(){var d=(0,v.A)(function*(m){console.log("Pago completado:",m);const u=yield o.utilsSvc.loading();yield u.present(),o.confirming=!0,setTimeout(()=>{o.confirming=!1,o.paymentConfirmed=!0},3e3),setTimeout((0,v.A)(function*(){const p=document.querySelector(".confirm-button");p&&p.classList.add("complete");const M=o.utilsSvc.getFromLocalStorage("user").uid,x={estatus:"Pedido confirmado",fecha:new Date,fecha_entrega:new Date(o.cart.fecha_entrega),pago_confirmado:!0,tipo_pago:"Tarjeta",tipo_entrega:"Negocio",total:o.cart.total-o.cart.total*(o.porcentaje/100),uid_cliente:M},b=o.cart.detalle_carrito.map(f=>({cantidad:f.cantidad,subtotal:f.subtotal,uid_producto:f.uid_producto,uid_opcion:f.uid_opcion,tamano_tortilla:f.tamano_tortilla}));o.utilsSvc.setElementInLocalstorage("pedido",x),o.utilsSvc.setElementInLocalstorage("detalle_pedido",b);const _=o.cart.id;for(let f of o.cart.detalle_carrito)yield o.firebaseSvc.deleteDocumet(`users/${M}/carrito_negocio/${_}/detalle_carrito/${f.id}`);const g=yield o.firebaseSvc.addDocument("pedidos",x);for(let f of o.cart.detalle_carrito)f.tamano_tortilla?yield o.firebaseSvc.addDocument(`pedidos/${g.id}/detalle_pedido`,{cantidad:f.cantidad,subtotal:f.subtotal,uid_producto:f.uid_producto,uid_opcion:f.uid_opcion,tamano_tortilla:f.tamano_tortilla}):yield o.firebaseSvc.addDocument(`pedidos/${g.id}/detalle_pedido`,{cantidad:f.cantidad,subtotal:f.subtotal,uid_producto:f.uid_producto,uid_opcion:f.uid_opcion});yield o.sendOrderConfirmationEmail(g.id,"Tarjeta"),yield o.firebaseSvc.updateDocumet(`users/${M}/carrito_negocio/${_}`,{total:0}),o.cart.detalle_carrito=[],o.cart.total=0,o.utilsSvc.setElementInLocalstorage("carrito_negocio",[o.cart]),localStorage.removeItem("selectedMethod"),u.dismiss(),o.utilsSvc.presentToast({message:"Pedido confirmado",duration:2500,color:"primary",position:"bottom",icon:"alert-circle-outline"}),o.paymentConfirmed=!1,o.utilsSvc.dismissModal(!0),o.utilsSvc.routerLink("/main/confirmacion-pago")}),3e3)});return function(m){return d.apply(this,arguments)}}())}),function(l,d){return a.apply(this,arguments)}),onError:a=>{console.error("Error en el pago:",a),alert("Hubo un problema con el pago. Por favor, int\xe9ntalo de nuevo.")}}).render("#paypal-button-container"):console.error("Contenedor #paypal-button-container no encontrado.")}onPaymentChange(o){var e=this;return(0,v.A)(function*(){if(e.selectedPayment=o,"paypal"===o){const a=yield e.utilsSvc.loading();yield a.present(),setTimeout(()=>{e.renderPayPalButton(),a.dismiss()},1500)}})()}confirmPayment(){var o=this;return(0,v.A)(function*(){const e=yield o.utilsSvc.loading();yield e.present(),o.confirming=!0,setTimeout(()=>{o.confirming=!1,o.paymentConfirmed=!0},3e3),setTimeout((0,v.A)(function*(){const a=document.querySelector(".confirm-button");a&&a.classList.add("complete");const r=o.utilsSvc.getFromLocalStorage("user").uid,l={estatus:"Pedido confirmado",fecha:new Date,fecha_entrega:new Date(o.cart.fecha_entrega),pago_confirmado:!1,tipo_pago:"Efectivo",total:o.cart.total-o.cart.total*(o.porcentaje/100),uid_cliente:r},d=o.cart.detalle_carrito.map(p=>({cantidad:p.cantidad,subtotal:p.subtotal,uid_producto:p.uid_producto,uid_opcion:p.uid_opcion,tamano_tortilla:p.tamano_tortilla}));o.utilsSvc.setElementInLocalstorage("pedido",l),o.utilsSvc.setElementInLocalstorage("detalle_pedido",d);const m=o.cart.id;for(let p of o.cart.detalle_carrito)yield o.firebaseSvc.deleteDocumet(`users/${r}/carrito_negocio/${m}/detalle_carrito/${p.id}`);const u=yield o.firebaseSvc.addDocument("pedidos",l);for(let p of o.cart.detalle_carrito)p.tamano_tortilla?yield o.firebaseSvc.addDocument(`pedidos/${u.id}/detalle_pedido`,{cantidad:p.cantidad,subtotal:p.subtotal,uid_producto:p.uid_producto,uid_opcion:p.uid_opcion,tamano_tortilla:p.tamano_tortilla}):yield o.firebaseSvc.addDocument(`pedidos/${u.id}/detalle_pedido`,{cantidad:p.cantidad,subtotal:p.subtotal,uid_producto:p.uid_producto,uid_opcion:p.uid_opcion});yield o.sendOrderConfirmationEmail(u.id,"Efectivo"),yield o.firebaseSvc.updateDocumet(`users/${r}/carrito_negocio/${m}`,{total:0}),o.cart.detalle_carrito=[],o.cart.total=0,o.utilsSvc.setElementInLocalstorage("carrito_negocio",[o.cart]),localStorage.removeItem("selectedMethod"),e.dismiss(),o.utilsSvc.presentToast({message:"Pedido confirmado",duration:2500,color:"primary",position:"bottom",icon:"alert-circle-outline"}),o.paymentConfirmed=!1,o.utilsSvc.dismissModal(!0),o.utilsSvc.routerLink("/main/confirmacion-pago")}),3e3)})()}getCartDetails(){var o=this;return(0,v.A)(function*(){const e=yield o.utilsSvc.loading();yield e.present(),o.cart=o.utilsSvc.getFromLocalStorage("carrito_negocio")[0];for(let a of o.cart.detalle_carrito){const r=yield o.firebaseSvc.getDocument(`productos/${a.uid_producto}`),l=yield o.firebaseSvc.getDocument(`productos/${a.uid_producto}/opciones/${a.uid_opcion}`);a.producto=r||{},a.opcion=l||{}}e.dismiss()})()}applyStoredCoupon(){if(this.cart=this.utilsSvc.getFromLocalStorage("carrito_negocio")[0],this.cart){const o=this.utilsSvc.getFromLocalStorage("appliedCoupon");o&&(this.discountAmount=this.cart.total*o.porcentaje/100,this.porcentaje=o.porcentaje,this.cart.total-=this.discountAmount)}}}return(n=c).\u0275fac=function(o){return new(o||n)},n.\u0275cmp=t.VBU({type:n,selectors:[["app-entrega-negocio-negocio"]],decls:39,vars:23,consts:[["title","Pago",3,"isModal"],[3,"fullscreen"],[1,"payment-card"],[1,"title"],[3,"ionChange"],["button","",1,"option-card",3,"click"],["name","cash-outline","slot","start",1,"option-icon"],["slot","end","value","efectivo"],["name","card-outline","slot","start",1,"option-icon"],["slot","end","value","tarjeta"],[1,"summary-card"],[1,"summary-title"],[1,"summary-item"],["class","summary-item",4,"ngFor","ngForOf"],[1,"divider"],["class","summary-item",4,"ngIf"],["class","confirm-button-container-paypal",4,"ngIf"],["class","confirm-button-container",4,"ngIf"],[1,"original-price"],[1,"descuento"],[1,"discounted-price"],[1,"confirm-button-container-paypal"],["id","paypal-button-container"],[1,"confirm-button-container"],["expand","block","mode","ios",3,"click","disabled"],["name","checkmark-outline","slot","start",4,"ngIf"],["name","checkmark-outline","slot","start"]],template:function(o,e){1&o&&(t.nrm(0,"app-header",0),t.j41(1,"ion-content",1)(2,"ion-card",2)(3,"ion-card-header")(4,"h2",3),t.EFF(5,"M\xe9todo de Pago"),t.k0s()(),t.j41(6,"ion-card-content")(7,"ion-radio-group",4),t.bIt("ionChange",function(r){return e.onPaymentChange(r.detail.value)}),t.j41(8,"ion-card",5),t.bIt("click",function(){return e.onPaymentChange("efectivo")}),t.j41(9,"ion-item"),t.nrm(10,"ion-icon",6),t.j41(11,"ion-label"),t.EFF(12,"Efectivo en Negocio"),t.k0s(),t.nrm(13,"ion-radio",7),t.k0s()(),t.j41(14,"ion-card",5),t.bIt("click",function(){return e.onPaymentChange("paypal")}),t.j41(15,"ion-item"),t.nrm(16,"ion-icon",8),t.j41(17,"ion-label"),t.EFF(18,"Tarjeta"),t.k0s(),t.nrm(19,"ion-radio",9),t.k0s()()()()(),t.j41(20,"ion-card",10)(21,"ion-card-header")(22,"h3",11),t.EFF(23,"Resumen de compra"),t.k0s()(),t.j41(24,"ion-card-content")(25,"div",12)(26,"span"),t.EFF(27),t.k0s(),t.j41(28,"span"),t.EFF(29),t.nI1(30,"currency"),t.k0s()(),t.DNE(31,et,6,11,"div",13),t.nrm(32,"div",14),t.DNE(33,nt,6,9,"div",15)(34,it,6,4,"div",15)(35,at,6,9,"div",15)(36,rt,6,9,"div",15),t.k0s()(),t.DNE(37,ct,2,0,"div",16)(38,st,4,5,"div",17),t.k0s()),2&o&&(t.Y8G("isModal",!0),t.R7$(),t.Y8G("fullscreen",!0),t.R7$(7),t.AVh("selected","efectivo"===e.selectedPayment),t.R7$(6),t.AVh("selected","paypal"===e.selectedPayment),t.R7$(13),t.SpI("Productos (",(null==e.cart||null==e.cart.detalle_carrito?null:e.cart.detalle_carrito.length)||0,")"),t.R7$(2),t.SpI("",t.iJd(30,15,t.eq3(21,E,null==e.cart?null:e.cart.total))," MXN"),t.R7$(2),t.Y8G("ngForOf",null==e.cart?null:e.cart.detalle_carrito),t.R7$(2),t.Y8G("ngIf",e.discountAmount>0),t.R7$(),t.Y8G("ngIf",e.discountAmount>0),t.R7$(),t.Y8G("ngIf",e.discountAmount>0),t.R7$(),t.Y8G("ngIf",0===e.discountAmount),t.R7$(),t.Y8G("ngIf","tarjeta"===e.selectedPayment),t.R7$(),t.Y8G("ngIf","efectivo"===e.selectedPayment))},dependencies:[y.Sq,y.bT,s.Jm,s.b_,s.I9,s.ME,s.W9,s.iq,s.uz,s.he,s.KO,s.f0,s.uR,s.Je,w.l,y.QX,y.oe],styles:['@charset "UTF-8";.payment-card[_ngcontent-%COMP%], .summary-card[_ngcontent-%COMP%]{margin:16px;border-radius:16px;box-shadow:0 4px 8px #0000001a}.title[_ngcontent-%COMP%], .summary-title[_ngcontent-%COMP%]{font-size:1.2rem;font-weight:700;text-align:center;color:var(--ion-color-primary)}.option-card[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:16px;transition:transform .2s ease,background-color .3s ease}.option-card.selected[_ngcontent-%COMP%]{transform:scale(1.05);background-color:var(--ion-color-primary-tint)}.option-icon[_ngcontent-%COMP%]{font-size:2rem;color:var(--ion-color-primary);margin-right:8px}.summary-card[_ngcontent-%COMP%]{background-color:#f8f9fa;color:#343a40}.summary-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:12px 0;font-size:1rem}.divider[_ngcontent-%COMP%]{border-bottom:1px solid #dee2e6;margin:8px 0}.confirm-button-container[_ngcontent-%COMP%], .confirm-button-container-paypal[_ngcontent-%COMP%]{margin:16px}.confirm-button[_ngcontent-%COMP%]{--background: var(--ion-color-primary);color:#fff;font-weight:700;border-radius:24px;text-align:center;position:relative;overflow:hidden;transition:background-color .3s ease-in-out}.complete[_ngcontent-%COMP%]{--background: var(--ion-color-primary);color:#fff;font-weight:700;border-radius:24px;text-align:center;position:relative;overflow:hidden}.confirm-button.animated[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;height:100%;width:0%;background:linear-gradient(to right,var(--ion-color-primary),var(--ion-color-secondary),var(--ion-color-tertiary));z-index:1;animation:_ngcontent-%COMP%_slideIn 3s forwards}.confirm-button.animated[_ngcontent-%COMP%]{color:transparent}.confirm-button.animated[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#fff}.confirm-button.complete[_ngcontent-%COMP%]{--background: var(--ion-color-primary)}@keyframes _ngcontent-%COMP%_slideIn{0%{width:0%}50%{width:100%}to{width:0%}}.total-summary[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start}.total-summary[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin:4px 0}.discounted-price[_ngcontent-%COMP%]{color:green;font-weight:700}.original-price[_ngcontent-%COMP%]{color:gray;text-decoration:line-through;font-size:17px}.descuento[_ngcontent-%COMP%]{font-weight:700;font-size:17px}']}),c})();var pt=C(9365);const F=n=>[n,"MXN","symbol-narrow","1.2-2","en-US"];function gt(n,c){1&n&&(t.j41(0,"div",60),t.nrm(1,"ion-icon",61),t.k0s())}function mt(n,c){1&n&&(t.j41(0,"div",60),t.nrm(1,"ion-icon",61),t.k0s())}function ut(n,c){if(1&n&&(t.j41(0,"ion-select-option",62),t.EFF(1),t.k0s()),2&n){const i=c.$implicit;t.Y8G("value",i.value)("disabled",!i.enabled),t.R7$(),t.SpI(" ",i.label," ")}}function ft(n,c){if(1&n&&(t.j41(0,"div",63)(1,"div",64),t.nrm(2,"ion-icon",29),t.j41(3,"span"),t.EFF(4),t.k0s()()()),2&n){const i=t.XpG();t.R7$(4),t.JRh(i.getFormattedDateTime())}}function _t(n,c){if(1&n&&(t.j41(0,"div",45)(1,"span",65),t.nrm(2,"ion-icon",66),t.EFF(3),t.k0s(),t.j41(4,"span",67),t.EFF(5),t.nI1(6,"currency"),t.k0s()()),2&n){const i=t.XpG();t.R7$(3),t.SpI(" Descuento (",i.porcentaje,"%) "),t.R7$(2),t.SpI("-",t.iJd(6,2,t.eq3(8,F,i.discountAmount))," MXN")}}function ht(n,c){if(1&n&&(t.j41(0,"div",68),t.nrm(1,"ion-icon",69),t.j41(2,"span"),t.EFF(3),t.nI1(4,"currency"),t.k0s()()),2&n){const i=t.XpG();t.R7$(3),t.SpI("\xa1Ahorras ",t.iJd(4,1,t.eq3(7,F,i.discountAmount))," MXN!")}}function vt(n,c){if(1&n&&(t.j41(0,"div",70),t.nrm(1,"ion-icon",71),t.j41(2,"span"),t.EFF(3),t.k0s()()),2&n){const i=t.XpG();t.R7$(),t.Y8G("name","negocio"===i.selectedMethod?"storefront-outline":"bicycle-outline"),t.R7$(2),t.JRh("negocio"===i.selectedMethod?"Recoger en tienda":"Entrega a domicilio")}}const Mt=[{path:"",component:(()=>{var n;class c{constructor(o,e){this.router=o,this.utilsSvc=e,this.selectedMethod="",this.selectedDate="",this.selectedTime="",this.discountAmount=0,this.porcentaje=0,this.minDate="",this.fechaRecoleccion="",this.horaRecoleccion="",this.horaEntrada="09:00",this.horaSalida="20:00",this.horaMinimaInput="09:00",this.horaOpciones=[],this.firebaseSvc=(0,t.WQX)(I.f),this.selectedDate=(new Date).toISOString(),this.selectedTime=(new Date).toISOString()}ngOnInit(){this.getCartDetails(),this.applyStoredCoupon(),this.setDefaultDate(),this.getHorarioTrabajo().then(()=>{this.generarOpcionesHora()})}getHorarioTrabajo(){var o=this;return(0,v.A)(function*(){try{const e=yield o.firebaseSvc.getDocument("horario/waeYL5UAeC3YyZ8BW3KT");e&&(o.horaEntrada=e.hora_entrada||"09:00",o.horaSalida=e.hora_salida||"20:00")}catch{o.horaEntrada="09:00",o.horaSalida="20:00"}})()}setDefaultDate(){const o=new Date;o.setHours(0,0,0,0),this.minDate=o.toISOString().slice(0,10),this.fechaRecoleccion=this.minDate,this.horaRecoleccion=""}onMethodChange(o){this.selectedMethod=o}onDateOrTimeChange(){if(this.updateHoraMinimaInput(),this.generarOpcionesHora(),this.fechaRecoleccion&&this.horaRecoleccion&&!this.isHoraDentroHorario(this.horaRecoleccion))return this.utilsSvc.presentToast({message:`La hora debe estar entre ${this.horaMinimaInput} y ${this.horaSalida}`,duration:2500,color:"warning",position:"bottom",icon:"time-outline"}),void(this.horaRecoleccion="")}continue(){var o=this;return(0,v.A)(function*(){o.selectedMethod&&o.selectedDate&&o.selectedTime&&(o.utilsSvc.saveInLocalStorage("selectedMethod",o.selectedMethod),o.cart.fecha_entrega=o.selectedDate,o.cart.hora_entrega=o.selectedTime,o.utilsSvc.saveInLocalStorage("carrito_negocio",[o.cart]),console.log("M\xe9todo seleccionado:",o.selectedMethod),console.log("Fecha seleccionada:",o.selectedDate),console.log("Hora seleccionada:",o.selectedTime),console.log("Carrito:",o.cart),"negocio"===o.selectedMethod?(yield o.utilsSvc.presentModal({component:dt,componentProps:{}}))&&o.utilsSvc.dismissModal(!0):"domicilio"===o.selectedMethod&&(yield o.utilsSvc.presentModal({component:pt.H,componentProps:{}}))&&(yield o.utilsSvc.presentModal({component:ot,componentProps:{}}))&&o.utilsSvc.dismissModal(!0))})()}getCartDetails(){this.cart=this.utilsSvc.getFromLocalStorage("carrito_negocio")[0]}applyStoredCoupon(){if(this.cart){const o=this.utilsSvc.getFromLocalStorage("appliedCoupon");o&&(this.discountAmount=this.cart.total*o.porcentaje/100,this.porcentaje=o.porcentaje)}}getTotalAmount(){return this.cart?this.discountAmount>0?this.cart.total-this.discountAmount:this.cart.total:0}generarOpcionesHora(){let o=[];if(!this.horaEntrada||!this.horaSalida)return void(this.horaOpciones=[]);const[e,a]=this.horaEntrada.split(":").map(Number),[r,l]=this.horaSalida.split(":").map(Number);let d=new Date,m=null;this.fechaRecoleccion&&(m=new Date(this.fechaRecoleccion));let u=m&&m.getFullYear()===d.getFullYear()&&m.getMonth()===d.getMonth()&&m.getDate()+1===d.getDate();if(console.log("esHoy:",u),u&&60*d.getHours()+d.getMinutes()>=60*r+l)return this.horaOpciones=[],void this.utilsSvc.presentToast({message:"El horario de hoy ya termin\xf3. Por favor selecciona otro d\xeda.",duration:3500,color:"danger",position:"top",icon:"time-outline"});let p=e,M=a;if(u){const _=d.getHours(),g=d.getMinutes();let f=15*Math.ceil(g/15),P=_;60===f&&(P++,f=0),P<e||P===e&&f<a?(p=e,M=a):(p=P,M=f)}let x=60*p+M,b=60*r+l;for(let _=60*e+a;_<=b;_+=15){if(u&&_<x)continue;const f=_%60,P=`${Math.floor(_/60).toString().padStart(2,"0")}:${f.toString().padStart(2,"0")}`,D=this.formatHoraAMPM(P);o.push({value:P,label:D,enabled:!0})}this.horaOpciones=o,this.horaRecoleccion&&!o.find(_=>_.value===this.horaRecoleccion)&&(this.horaRecoleccion="")}updateHoraMinimaInput(){if(!this.fechaRecoleccion)return void(this.horaMinimaInput=this.horaEntrada);const o=new Date,e=new Date(this.fechaRecoleccion);if(e.getFullYear()===o.getFullYear()&&e.getMonth()===o.getMonth()&&e.getDate()===o.getDate()){const a=o.getHours(),r=o.getMinutes(),[l,d]=this.horaEntrada.split(":").map(Number);let m=Math.max(l,a),u=m===a?r:d;(a<l||a===l&&r<d)&&(m=l,u=d),this.horaMinimaInput=`${m.toString().padStart(2,"0")}:${u.toString().padStart(2,"0")}`}else this.horaMinimaInput=this.horaEntrada}isHoraDentroHorario(o){if(!o)return!1;const[e,a]=o.split(":").map(Number),[r,l]=this.horaEntrada.split(":").map(Number),[d,m]=this.horaSalida.split(":").map(Number),u=60*e+a;return u>=60*r+l&&u<=60*d+m}combineDateTime(){return this.fechaRecoleccion&&this.horaRecoleccion?`${this.fechaRecoleccion}T${this.horaRecoleccion}:00`:""}getFormattedDateTime(){if(!this.fechaRecoleccion||!this.horaRecoleccion)return"";const o=this.combineDateTime();return new Date(o).toLocaleDateString("es-ES",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}formatHoraAMPM(o){if(!o)return"";const[e,a]=o.split(":").map(Number),r=e>=12?"PM":"AM";return`${e%12||12}:${a.toString().padStart(2,"0")} ${r}`}}return(n=c).\u0275fac=function(o){return new(o||n)(t.rXU(k.Ix),t.rXU(j.T))},n.\u0275cmp=t.VBU({type:n,selectors:[["app-metodo-entrega-negocio"]],decls:116,vars:36,consts:[["title","M\xe9todo de entrega",3,"showMenu"],[3,"fullscreen"],[1,"container"],[1,"hero-section"],["name","fast-food-outline",1,"hero-icon"],[1,"hero-title"],[1,"hero-subtitle"],[1,"content-grid"],[1,"delivery-section"],[1,"delivery-options"],[1,"delivery-option",3,"click"],[1,"option-header"],[1,"option-icon-wrapper"],["name","storefront",1,"option-main-icon"],["class","option-badge",4,"ngIf"],[1,"option-content"],[1,"option-features"],[1,"feature"],["name","time-outline"],["name","cash-outline"],["name","bicycle",1,"option-main-icon"],["name","location-outline"],[1,"date-section"],[1,"date-card"],[1,"date-header"],["name","calendar-outline",1,"date-icon"],[1,"datetime-container"],[1,"datetime-field"],[1,"datetime-label"],["name","calendar-outline"],[1,"input-icon-wrapper"],["type","date","placeholder","Selecciona la fecha",1,"custom-datetime",3,"ngModelChange","ionChange","ngModel","min"],["name","calendar-outline",1,"input-suffix-icon"],[1,"datetime-hint"],["name","information-circle-outline"],["placeholder","Selecciona la hora","interface","popover",1,"custom-datetime",3,"ngModelChange","ionChange","ngModel"],[3,"value","disabled",4,"ngFor","ngForOf"],["name","time-outline",1,"input-suffix-icon"],["class","selected-datetime",4,"ngIf"],[1,"summary-section"],[1,"summary-card"],[1,"summary-header"],["name","receipt-outline",1,"summary-icon"],[1,"summary-content"],[1,"order-details"],[1,"detail-row"],[1,"detail-label"],["name","bag-outline"],[1,"detail-value"],["class","detail-row",4,"ngIf"],[1,"summary-divider"],[1,"total-section"],[1,"total-row"],[1,"total-label"],[1,"total-amount"],["class","savings",4,"ngIf"],[1,"footer-content"],["class","selected-method",4,"ngIf"],["expand","block","size","large",1,"continue-button",3,"click","disabled"],["name","arrow-forward-outline","slot","end"],[1,"option-badge"],["name","checkmark-circle"],[3,"value","disabled"],[1,"selected-datetime"],[1,"datetime-preview"],[1,"detail-label","discount-label"],["name","pricetag-outline"],[1,"detail-value","discount-value"],[1,"savings"],["name","happy-outline"],[1,"selected-method"],[3,"name"]],template:function(o,e){1&o&&(t.nrm(0,"app-header",0),t.j41(1,"ion-content",1)(2,"div",2)(3,"div",3),t.nrm(4,"ion-icon",4),t.j41(5,"h1",5),t.EFF(6,"\xbfC\xf3mo quieres recibir tu pedido?"),t.k0s(),t.j41(7,"p",6),t.EFF(8,"Elige la opci\xf3n que mejor se adapte a ti"),t.k0s()(),t.j41(9,"div",7)(10,"div",8)(11,"div",9)(12,"div",10),t.bIt("click",function(){return e.onMethodChange("negocio")}),t.j41(13,"div",11)(14,"div",12),t.nrm(15,"ion-icon",13),t.k0s(),t.DNE(16,gt,2,0,"div",14),t.k0s(),t.j41(17,"div",15)(18,"h3"),t.EFF(19,"Recoger en tienda"),t.k0s(),t.j41(20,"p"),t.EFF(21,"Retira tu pedido directamente en nuestro local"),t.k0s(),t.j41(22,"div",16)(23,"div",17),t.nrm(24,"ion-icon",18),t.j41(25,"span"),t.EFF(26,"15-20 min"),t.k0s()(),t.j41(27,"div",17),t.nrm(28,"ion-icon",19),t.j41(29,"span"),t.EFF(30,"Sin costo"),t.k0s()()()()(),t.j41(31,"div",10),t.bIt("click",function(){return e.onMethodChange("domicilio")}),t.j41(32,"div",11)(33,"div",12),t.nrm(34,"ion-icon",20),t.k0s(),t.DNE(35,mt,2,0,"div",14),t.k0s(),t.j41(36,"div",15)(37,"h3"),t.EFF(38,"Entrega a domicilio"),t.k0s(),t.j41(39,"p"),t.EFF(40,"Recibe tu pedido en la comodidad de tu hogar"),t.k0s(),t.j41(41,"div",16)(42,"div",17),t.nrm(43,"ion-icon",18),t.j41(44,"span"),t.EFF(45,"30-45 min"),t.k0s()(),t.j41(46,"div",17),t.nrm(47,"ion-icon",21),t.j41(48,"span"),t.EFF(49,"A tu puerta"),t.k0s()()()()()(),t.j41(50,"div",22)(51,"div",23)(52,"div",24),t.nrm(53,"ion-icon",25),t.j41(54,"h3"),t.EFF(55,"Fecha y hora de entrega"),t.k0s()(),t.j41(56,"div",26)(57,"div",27)(58,"label",28),t.nrm(59,"ion-icon",29),t.EFF(60," Fecha "),t.k0s(),t.j41(61,"div",30)(62,"ion-input",31),t.mxI("ngModelChange",function(r){return t.DH7(e.fechaRecoleccion,r)||(e.fechaRecoleccion=r),r}),t.bIt("ionChange",function(){return e.onDateOrTimeChange()}),t.k0s(),t.nrm(63,"ion-icon",32),t.k0s(),t.j41(64,"small",33),t.nrm(65,"ion-icon",34),t.EFF(66," Disponible desde hoy hasta 1 mes "),t.k0s()(),t.j41(67,"div",27)(68,"label",28),t.nrm(69,"ion-icon",18),t.EFF(70," Hora "),t.k0s(),t.j41(71,"div",30)(72,"ion-select",35),t.mxI("ngModelChange",function(r){return t.DH7(e.horaRecoleccion,r)||(e.horaRecoleccion=r),r}),t.bIt("ionChange",function(){return e.onDateOrTimeChange()}),t.DNE(73,ut,2,3,"ion-select-option",36),t.k0s(),t.nrm(74,"ion-icon",37),t.k0s(),t.j41(75,"small",33),t.nrm(76,"ion-icon",34),t.EFF(77," M\xednimo 2 horas de anticipaci\xf3n (9:00 AM - 8:00 PM) "),t.k0s()()(),t.DNE(78,ft,5,1,"div",38),t.k0s()()(),t.j41(79,"div",39)(80,"div",40)(81,"div",41),t.nrm(82,"ion-icon",42),t.j41(83,"h3"),t.EFF(84,"Resumen del pedido"),t.k0s()(),t.j41(85,"div",43)(86,"div",44)(87,"div",45)(88,"span",46),t.nrm(89,"ion-icon",47),t.EFF(90," Productos "),t.k0s(),t.j41(91,"span",48),t.EFF(92),t.k0s()(),t.j41(93,"div",45)(94,"span",46),t.EFF(95,"Subtotal"),t.k0s(),t.j41(96,"span",48),t.EFF(97),t.nI1(98,"currency"),t.k0s()(),t.DNE(99,_t,7,10,"div",49),t.k0s(),t.nrm(100,"div",50),t.j41(101,"div",51)(102,"div",52)(103,"span",53),t.EFF(104,"Total a pagar"),t.k0s(),t.j41(105,"span",54),t.EFF(106),t.nI1(107,"currency"),t.k0s()(),t.DNE(108,ht,5,9,"div",55),t.k0s()()()()()()(),t.j41(109,"ion-footer")(110,"ion-toolbar")(111,"div",56),t.DNE(112,vt,4,2,"div",57),t.j41(113,"ion-button",58),t.bIt("click",function(){return e.continue()}),t.nrm(114,"ion-icon",59),t.EFF(115," Continuar con el pedido "),t.k0s()()()()),2&o&&(t.Y8G("showMenu",!0),t.R7$(),t.Y8G("fullscreen",!0),t.R7$(11),t.AVh("selected","negocio"===e.selectedMethod),t.R7$(4),t.Y8G("ngIf","negocio"===e.selectedMethod),t.R7$(15),t.AVh("selected","domicilio"===e.selectedMethod),t.R7$(4),t.Y8G("ngIf","domicilio"===e.selectedMethod),t.R7$(27),t.R50("ngModel",e.fechaRecoleccion),t.Y8G("min",e.minDate),t.R7$(10),t.R50("ngModel",e.horaRecoleccion),t.R7$(),t.Y8G("ngForOf",e.horaOpciones),t.R7$(5),t.Y8G("ngIf",e.fechaRecoleccion&&e.horaRecoleccion),t.R7$(14),t.SpI("",(null==e.cart||null==e.cart.detalle_carrito?null:e.cart.detalle_carrito.length)||0," items"),t.R7$(5),t.SpI("",t.iJd(98,20,t.eq3(32,F,null==e.cart?null:e.cart.total))," MXN"),t.R7$(2),t.Y8G("ngIf",e.discountAmount>0),t.R7$(7),t.SpI("",t.iJd(107,26,t.eq3(34,F,e.getTotalAmount()))," MXN"),t.R7$(2),t.Y8G("ngIf",e.discountAmount>0),t.R7$(4),t.Y8G("ngIf",e.selectedMethod),t.R7$(),t.Y8G("disabled",!e.selectedMethod||!e.selectedDate||!e.selectedTime))},dependencies:[y.Sq,y.bT,S.BC,S.vS,s.Jm,s.W9,s.M0,s.iq,s.$w,s.Nm,s.Ip,s.ai,s.Je,s.Gw,w.l,y.oe],styles:['ion-content[_ngcontent-%COMP%]{--background: linear-gradient(135deg, #a3a3a3 0%, #e2e2e2 100%);--padding-start: 0;--padding-end: 0}.container[_ngcontent-%COMP%]{min-height:100vh;padding:0 16px 100px}.hero-section[_ngcontent-%COMP%]{text-align:center;padding:40px 20px;color:#fff}.hero-section[_ngcontent-%COMP%]   .hero-icon[_ngcontent-%COMP%]{font-size:4rem;margin-bottom:16px;opacity:.9}.hero-section[_ngcontent-%COMP%]   .hero-title[_ngcontent-%COMP%]{font-size:1.8rem;font-weight:700;margin:0 0 8px;text-shadow:0 2px 4px rgba(0,0,0,.3)}.hero-section[_ngcontent-%COMP%]   .hero-subtitle[_ngcontent-%COMP%]{font-size:1rem;opacity:.9;margin:0;font-weight:400}.content-grid[_ngcontent-%COMP%]{display:grid;gap:24px;max-width:1200px;margin:0 auto}@media (min-width: 768px){.content-grid[_ngcontent-%COMP%]{grid-template-columns:2fr 1fr;gap:32px}}.delivery-section[_ngcontent-%COMP%]   .delivery-options[_ngcontent-%COMP%]{display:grid;gap:20px;margin-bottom:24px}@media (min-width: 480px){.delivery-section[_ngcontent-%COMP%]   .delivery-options[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr;gap:16px}}@media (min-width: 768px){.delivery-section[_ngcontent-%COMP%]   .delivery-options[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:20px}}.delivery-option[_ngcontent-%COMP%]{background:#fff;border-radius:20px;padding:24px;cursor:pointer;transition:all .3s cubic-bezier(.4,0,.2,1);border:3px solid transparent;box-shadow:0 8px 32px #0000001a;position:relative;overflow:hidden}.delivery-option[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background:linear-gradient(135deg,#667eea0d,#764ba20d);opacity:0;transition:opacity .3s ease}.delivery-option[_ngcontent-%COMP%]:hover{transform:translateY(-4px);box-shadow:0 16px 48px #00000026}.delivery-option[_ngcontent-%COMP%]:hover:before{opacity:1}.delivery-option[_ngcontent-%COMP%]:hover   .option-main-icon[_ngcontent-%COMP%]{transform:scale(1.1)}.delivery-option.selected[_ngcontent-%COMP%]{border-color:var(--ion-color-primary);transform:translateY(-2px);box-shadow:0 12px 40px rgba(var(--ion-color-primary-rgb),.3)}.delivery-option.selected[_ngcontent-%COMP%]:before{opacity:1;background:linear-gradient(135deg,rgba(var(--ion-color-primary-rgb),.1),rgba(var(--ion-color-secondary-rgb),.1))}.delivery-option.selected[_ngcontent-%COMP%]   .option-main-icon[_ngcontent-%COMP%]{color:var(--ion-color-primary);transform:scale(1.05)}.delivery-option.selected[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:var(--ion-color-primary)}.option-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;position:relative;z-index:1}.option-icon-wrapper[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:50%;background:linear-gradient(135deg,#f8f9fa,#e9ecef);display:flex;align-items:center;justify-content:center;box-shadow:0 4px 12px #0000001a}.option-main-icon[_ngcontent-%COMP%]{font-size:1.8rem;color:var(--ion-color-medium);transition:all .3s ease}.option-badge[_ngcontent-%COMP%]{width:32px;height:32px;background:var(--ion-color-success);border-radius:50%;display:flex;align-items:center;justify-content:center}.option-badge[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#fff;font-size:1.2rem}.option-content[_ngcontent-%COMP%]{position:relative;z-index:1}.option-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.3rem;font-weight:700;margin:0 0 8px;color:var(--ion-color-dark);transition:color .3s ease}.option-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--ion-color-medium);font-size:.95rem;margin:0 0 16px;line-height:1.4}.option-features[_ngcontent-%COMP%]{display:flex;gap:16px}.option-features[_ngcontent-%COMP%]   .feature[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;font-size:.85rem;color:var(--ion-color-medium)}.option-features[_ngcontent-%COMP%]   .feature[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1rem;color:var(--ion-color-primary)}.date-section[_ngcontent-%COMP%]{margin-top:24px}.date-card[_ngcontent-%COMP%]{background:#fff;border-radius:20px;padding:24px;box-shadow:0 8px 32px #0000001a}.date-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin-bottom:20px}.date-header[_ngcontent-%COMP%]   .date-icon[_ngcontent-%COMP%]{font-size:1.5rem;color:var(--ion-color-primary)}.date-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.2rem;font-weight:600;color:var(--ion-color-dark)}.time-section[_ngcontent-%COMP%]{margin-top:24px}.time-card[_ngcontent-%COMP%]{background:#fff;border-radius:20px;padding:24px;box-shadow:0 8px 32px #0000001a}.time-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin-bottom:20px}.time-header[_ngcontent-%COMP%]   .time-icon[_ngcontent-%COMP%]{font-size:1.5rem;color:var(--ion-color-secondary)}.time-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.2rem;font-weight:600;color:var(--ion-color-dark)}.custom-datetime[_ngcontent-%COMP%]{width:100%;--background: var(--ion-color-light);color:#000;--border-radius: 12px;--padding: 16px;--box-shadow: 0px 4px 8px rgba(0, 0, 0, .1);border:2px solid #f0f0f0;transition:border-color .3s ease}@media (max-width: 767px){.summary-section[_ngcontent-%COMP%]{order:-1}}.summary-card[_ngcontent-%COMP%]{background:#fff;border-radius:20px;overflow:hidden;box-shadow:0 8px 32px #0000001a;position:sticky;top:20px}.summary-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--ion-color-primary) 0%,var(--ion-color-secondary) 100%);color:#fff;padding:20px 24px;display:flex;align-items:center;gap:12px}.summary-header[_ngcontent-%COMP%]   .summary-icon[_ngcontent-%COMP%]{font-size:1.5rem}.summary-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.2rem;font-weight:600}.summary-content[_ngcontent-%COMP%]{padding:24px}.order-details[_ngcontent-%COMP%]{margin-bottom:20px}.detail-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:12px 0;border-bottom:1px solid #f0f0f0}.detail-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.detail-row[_ngcontent-%COMP%]   .detail-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;color:var(--ion-color-medium);font-size:.95rem}.detail-row[_ngcontent-%COMP%]   .detail-label[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1rem;color:var(--ion-color-primary)}.detail-row[_ngcontent-%COMP%]   .detail-label.discount-label[_ngcontent-%COMP%]{color:var(--ion-color-warning);font-weight:600}.detail-row[_ngcontent-%COMP%]   .detail-value[_ngcontent-%COMP%]{font-weight:600;color:var(--ion-color-dark)}.detail-row[_ngcontent-%COMP%]   .detail-value.discount-value[_ngcontent-%COMP%]{color:var(--ion-color-warning)}.summary-divider[_ngcontent-%COMP%]{height:2px;background:linear-gradient(to right,transparent,var(--ion-color-primary),transparent);margin:16px 0;border-radius:2px}.total-section[_ngcontent-%COMP%]   .total-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:16px 0}.total-section[_ngcontent-%COMP%]   .total-row[_ngcontent-%COMP%]   .total-label[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:600;color:var(--ion-color-dark)}.total-section[_ngcontent-%COMP%]   .total-row[_ngcontent-%COMP%]   .total-amount[_ngcontent-%COMP%]{font-size:1.4rem;font-weight:700;color:var(--ion-color-primary)}.total-section[_ngcontent-%COMP%]   .savings[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:12px 16px;background:linear-gradient(135deg,rgba(var(--ion-color-success-rgb),.1),rgba(var(--ion-color-success-rgb),.05));border-radius:12px;margin-top:12px}.total-section[_ngcontent-%COMP%]   .savings[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:var(--ion-color-success);font-size:1.2rem}.total-section[_ngcontent-%COMP%]   .savings[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--ion-color-success);font-weight:600;font-size:.9rem}ion-footer[_ngcontent-%COMP%]{background:#fff;border-top:1px solid #f0f0f0}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background: transparent;--padding-start: 16px;--padding-end: 16px;--padding-top: 16px;--padding-bottom: 16px}.footer-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.selected-method[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:8px 16px;background:rgba(var(--ion-color-primary-rgb),.1);border-radius:8px;font-size:.9rem;color:var(--ion-color-primary);font-weight:600}.selected-method[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1rem}.continue-button[_ngcontent-%COMP%]{--border-radius: 16px;--padding-start: 24px;--padding-end: 24px;height:56px;font-size:1.1rem;font-weight:600;background:linear-gradient(135deg,var(--ion-color-primary) 0%,var(--ion-color-secondary) 100%);box-shadow:0 4px 16px rgba(var(--ion-color-primary-rgb),.4);transition:all .3s ease}.continue-button[_ngcontent-%COMP%]:not([disabled]):hover{transform:translateY(-2px);box-shadow:0 8px 24px rgba(var(--ion-color-primary-rgb),.5)}.continue-button[disabled][_ngcontent-%COMP%]{opacity:.5;background:var(--ion-color-medium);box-shadow:none}.continue-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1.2rem}@keyframes _ngcontent-%COMP%_slideInUp{0%{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}.delivery-option[_ngcontent-%COMP%], .date-card[_ngcontent-%COMP%], .summary-card[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideInUp .6s ease-out}.delivery-option[_ngcontent-%COMP%]:nth-child(1){animation-delay:.1s}.delivery-option[_ngcontent-%COMP%]:nth-child(2){animation-delay:.2s}.date-card[_ngcontent-%COMP%]{animation-delay:.3s}.time-card[_ngcontent-%COMP%]{animation-delay:.4s}@media (max-width: 480px){.container[_ngcontent-%COMP%]{padding:0 12px 100px}.hero-section[_ngcontent-%COMP%]{padding:30px 16px}.hero-section[_ngcontent-%COMP%]   .hero-title[_ngcontent-%COMP%]{font-size:1.5rem}.hero-section[_ngcontent-%COMP%]   .hero-icon[_ngcontent-%COMP%]{font-size:3rem}.delivery-option[_ngcontent-%COMP%], .date-card[_ngcontent-%COMP%], .time-card[_ngcontent-%COMP%]{padding:20px}.option-features[_ngcontent-%COMP%]{flex-direction:column;gap:8px}.summary-content[_ngcontent-%COMP%]{padding:20px}}.datetime-container[_ngcontent-%COMP%]{display:grid;gap:20px}@media (min-width: 480px){.datetime-container[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr;gap:16px}}.datetime-field[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.datetime-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:.9rem;font-weight:600;color:var(--ion-color-medium)}.datetime-label[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1rem;color:var(--ion-color-primary)}.datetime-label[_ngcontent-%COMP%]   ion-icon[name=calendar-outline][_ngcontent-%COMP%]{color:var(--ion-color-primary)!important}.custom-datetime[_ngcontent-%COMP%]{width:100%;--background: var(--ion-color-light);--color: var(--ion-color-primary);--border-radius: 12px;--padding: 16px;--box-shadow: 0px 4px 8px rgba(0, 0, 0, .1);border:2px solid #f0f0f0;transition:border-color .3s ease}.custom-datetime[_ngcontent-%COMP%]:focus-within{border-color:var(--ion-color-primary)}.datetime-hint[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;font-size:.8rem;color:var(--ion-color-medium);margin-top:4px}.datetime-hint[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:.9rem;color:var(--ion-color-primary)}.selected-datetime[_ngcontent-%COMP%]{margin-top:20px;padding:16px;background:linear-gradient(135deg,rgba(var(--ion-color-primary-rgb),.1),rgba(var(--ion-color-secondary-rgb),.05));border-radius:12px;border:2px solid rgba(var(--ion-color-primary-rgb),.2)}.datetime-preview[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;font-weight:600;color:var(--ion-color-primary)}.datetime-preview[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1.2rem}.datetime-preview[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.95rem;text-transform:capitalize}ion-item.date-time-item[_ngcontent-%COMP%], ion-item[_ngcontent-%COMP%]:has(ion-input[type=date]), ion-item[_ngcontent-%COMP%]:has(ion-select){background:linear-gradient(90deg,#f8fafc 0%,var(--ion-color-primary-tint) 100%);border-radius:14px;margin-bottom:18px;box-shadow:0 4px 16px #28a74517;border:1.5px solid var(--ion-color-primary-tint);position:relative;transition:box-shadow .2s,border-color .2s}ion-item.date-time-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%], ion-item[_ngcontent-%COMP%]:has(ion-input[type=date])   ion-label[_ngcontent-%COMP%], ion-item[_ngcontent-%COMP%]:has(ion-select)   ion-label[_ngcontent-%COMP%]{font-weight:700;color:var(--ion-color-primary);font-size:1.08rem;letter-spacing:.5px;margin-bottom:4px;display:flex;align-items:center;gap:6px}ion-item.date-time-item[_ngcontent-%COMP%]   ion-input[type=date][_ngcontent-%COMP%], ion-item[_ngcontent-%COMP%]:has(ion-input[type=date])   ion-input[type=date][_ngcontent-%COMP%], ion-item[_ngcontent-%COMP%]:has(ion-select)   ion-input[type=date][_ngcontent-%COMP%]{border:2px solid var(--ion-color-primary-tint);border-radius:8px;padding:12px 16px;font-size:1.15rem;background:#fff;color:var(--ion-color-dark);font-weight:600;box-shadow:0 2px 8px #28a74512;transition:border-color .2s,box-shadow .2s,background .2s;outline:none;margin-top:6px}ion-item.date-time-item[_ngcontent-%COMP%]   ion-input[type=date][_ngcontent-%COMP%]:focus, ion-item[_ngcontent-%COMP%]:has(ion-input[type=date])   ion-input[type=date][_ngcontent-%COMP%]:focus, ion-item[_ngcontent-%COMP%]:has(ion-select)   ion-input[type=date][_ngcontent-%COMP%]:focus{border-color:var(--ion-color-primary);background:linear-gradient(90deg,#e9f5e1,#fff);box-shadow:0 0 0 3px #28a74526;animation:inputFocusPulse .3s}ion-item.date-time-item[_ngcontent-%COMP%]   ion-input[type=date][_ngcontent-%COMP%]:hover, ion-item[_ngcontent-%COMP%]:has(ion-input[type=date])   ion-input[type=date][_ngcontent-%COMP%]:hover, ion-item[_ngcontent-%COMP%]:has(ion-select)   ion-input[type=date][_ngcontent-%COMP%]:hover{border-color:var(--ion-color-primary-shade);background:#f4fff4}ion-item.date-time-item[_ngcontent-%COMP%]   ion-input[type=date][_ngcontent-%COMP%]::placeholder, ion-item[_ngcontent-%COMP%]:has(ion-input[type=date])   ion-input[type=date][_ngcontent-%COMP%]::placeholder, ion-item[_ngcontent-%COMP%]:has(ion-select)   ion-input[type=date][_ngcontent-%COMP%]::placeholder{color:var(--ion-color-medium);font-weight:400;opacity:.8}ion-item.date-time-item[_ngcontent-%COMP%]   ion-select[_ngcontent-%COMP%], ion-item[_ngcontent-%COMP%]:has(ion-input[type=date])   ion-select[_ngcontent-%COMP%], ion-item[_ngcontent-%COMP%]:has(ion-select)   ion-select[_ngcontent-%COMP%]{border:2px solid var(--ion-color-primary-tint);border-radius:8px;padding:12px 16px;font-size:1.15rem;background:#fff;color:var(--ion-color-dark);font-weight:600;box-shadow:0 2px 8px #28a74512;transition:border-color .2s,box-shadow .2s,background .2s;outline:none;margin-top:6px}ion-item.date-time-item[_ngcontent-%COMP%]   ion-select[_ngcontent-%COMP%]:focus, ion-item[_ngcontent-%COMP%]:has(ion-input[type=date])   ion-select[_ngcontent-%COMP%]:focus, ion-item[_ngcontent-%COMP%]:has(ion-select)   ion-select[_ngcontent-%COMP%]:focus{border-color:var(--ion-color-primary);background:linear-gradient(90deg,#e9f5e1,#fff);box-shadow:0 0 0 3px #28a74526;animation:inputFocusPulse .3s}ion-item.date-time-item[_ngcontent-%COMP%]   ion-select[_ngcontent-%COMP%]:hover, ion-item[_ngcontent-%COMP%]:has(ion-input[type=date])   ion-select[_ngcontent-%COMP%]:hover, ion-item[_ngcontent-%COMP%]:has(ion-select)   ion-select[_ngcontent-%COMP%]:hover{border-color:var(--ion-color-primary-shade);background:#f4fff4}ion-item.date-time-item[_ngcontent-%COMP%]   ion-select[_ngcontent-%COMP%]::placeholder, ion-item[_ngcontent-%COMP%]:has(ion-input[type=date])   ion-select[_ngcontent-%COMP%]::placeholder, ion-item[_ngcontent-%COMP%]:has(ion-select)   ion-select[_ngcontent-%COMP%]::placeholder{color:var(--ion-color-medium);font-weight:400;opacity:.8}ion-item.date-time-item[_ngcontent-%COMP%]   ion-select-option[disabled][_ngcontent-%COMP%], ion-item[_ngcontent-%COMP%]:has(ion-input[type=date])   ion-select-option[disabled][_ngcontent-%COMP%], ion-item[_ngcontent-%COMP%]:has(ion-select)   ion-select-option[disabled][_ngcontent-%COMP%]{color:var(--ion-color-medium);background:#f5f5f5;opacity:.7;cursor:not-allowed}.input-icon-wrapper[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center}.input-icon-wrapper[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%], .input-icon-wrapper[_ngcontent-%COMP%]   ion-select[_ngcontent-%COMP%]{flex:1 1 auto}.input-suffix-icon[_ngcontent-%COMP%]{position:absolute;right:12px;font-size:1.3rem;color:var(--ion-color-primary);pointer-events:none;opacity:.8;z-index:2}']}),c})()}];let Ct=(()=>{var n;class c{}return(n=c).\u0275fac=function(o){return new(o||n)},n.\u0275mod=t.$C({type:n}),n.\u0275inj=t.G2t({imports:[k.iI.forChild(Mt),k.iI]}),c})();var yt=C(7383);let bt=(()=>{var n;class c{}return(n=c).\u0275fac=function(o){return new(o||n)},n.\u0275mod=t.$C({type:n}),n.\u0275inj=t.G2t({imports:[y.MD,S.YN,s.bv,Ct,yt.G]}),c})()}}]);